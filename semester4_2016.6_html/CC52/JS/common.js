T.i18n.currentLocale="zh-CN";T.i18n.number.formatNumber=function(a){if(a==null){return""}if(a=="--"){return a}if(isNaN(parseFloat(a))){return a}return T.i18n.number.format(a,T.i18n.currentLocale)};T.i18n.number.formatRatio=function(a){if(a==null){return""}if(a=="--"){return a}if(isNaN(parseFloat(a))){if(!isNaN(parseFloat(a.val))){a.val=T.i18n.number.format(a.val,T.i18n.currentLocale)+"%"}else{if(!isNaN(parseFloat(a.value))){a.value=T.i18n.number.format(a.value,T.i18n.currentLocale)+"%"}}return a}return T.i18n.number.format(a,T.i18n.currentLocale)+"%"};T.i18n.number.formatTime=function(d,g){var b,f,h,e,a;if(d=="--"){return d}if(g==2){h=d/60|0;e=Math.round(d)-h*60;var c="";if(h){c+=h+"&#039;"}c+=e+"&quot;";return c}b=d/(24*3600)|0;d=Math.round(d)-b*24*3600;f=d/3600|0;d=Math.round(d)-f*3600;h=d/60|0;e=Math.round(d)-h*60;if(Math.round(b)<10){b=b>0?"0"+b:""}if(Math.round(f)<10){f="0"+f}if(Math.round(h)<10){h="0"+h}if(Math.round(e)<10){e="0"+e}if(b){a=b+" "+f+":"+h+":"+e}else{a=f+":"+h+":"+e}return a};T.config=T.config||{};T.config.holidays={"元旦节":/(^2011\/01\/0[1-3]$)|(^2012\/01\/0[1-3]$)|(^2013\/01\/0[1-3]$)|(^2014\/01\/01$)|(^201[5-6]\/01\/0[1-3]$)/,"春节":/(^2011\/02\/0[2-8]$)|(^2012\/01\/2[2-8]$)|(^2013\/02\/(09|1[0-5])$)|(^2014\/((01\/31)|(02\/0[1-6]))$)|(^2015\/(02\/(1[8-9]|2[0-4]))$)|(^2016\/(02\/(0[7-9]|1[0-3]))$)/,"情人节":/02\/14$/,"愚人节":/04\/01$/,"清明节":/(^2011\/04\/0[3-5]$)|(^2012\/04\/0[2-4]$)|(^2013\/04\/0[4-6]$)|(^2014\/04\/0[5-7]$)|(^2015\/04\/0[4-6]$)|(^2016\/04\/0[2-4]$)/,"劳动节":/(^2011\/(04\/30|05\/0[12])$)|(^201[2-3]\/(04\/(29|30)|05\/01)$)|(^201[4-5]\/05\/0[1-3]$)|(^2016\/(04\/30|05\/0[1-2])$)/,"儿童节":/06\/01$/,"端午节":/(^2011\/06\/0[4-6]$)|(^2012\/06\/2[2-4]$)|(^2013\/06\/1[0-2]$)|(^2014\/((05\/31)|(06\/0[1-2]))$)|(^2015\/06\/2[0-2]$)|(^2016\/06\/(09|1[0-1])$)/,"建军节":/08\/01$/,"中秋节":/(^2011\/09\/1[0-2]$)|(^2012\/09\/30$)|(^2013\/09\/(19|2[0-1])$)|(^2014\/09\/0[6-8]$)|(^2015\/09\/2[6-7]$)|(^2016\/09\/1[5-7]$)/,"国庆节":/10\/0[1-7]$/,"圣诞节":/12\/25$/};T.config.lineChartDayTimeMap={"0":"00:00 - 00:59","1":"01:00 - 01:59","2":"02:00 - 02:59","3":"03:00 - 03:59","4":"04:00 - 04:59","5":"05:00 - 05:59","6":"06:00 - 06:59","7":"07:00 - 07:59","8":"08:00 - 08:59","9":"09:00 - 09:59","10":"10:00 - 10:59","11":"11:00 - 11:59","12":"12:00 - 12:59","13":"13:00 - 13:59","14":"14:00 - 14:59","15":"15:00 - 15:59","16":"16:00 - 16:59","17":"17:00 - 17:59","18":"18:00 - 18:59","19":"19:00 - 19:59","20":"20:00 - 20:59","21":"21:00 - 21:59","22":"22:00 - 22:59","23":"23:00 - 23:59"};baidu.lang.Class.create=function(b,a){return new b(a)};baidu.form.getValues=function(c,q){c=T.g(c);q=q||{};var b=c.elements,j=b.length,e=q.replacer||function(r,i){return r},g=q.data||[],h,o,p,k,d,a,n,m,l;function f(i,r){g.push({name:i,value:r})}for(h=0;h<j;h++){o=b[h];p=o.name;if(!o.disabled&&p){k=o.type;d=o.value;switch(k){case"radio":case"checkbox":if(!o.checked){break}case"number":case"textarea":case"text":case"password":case"hidden":case"select-one":f(p,e(d,p));break;case"select-multiple":a=o.options;m=a.length;for(n=0;n<m;n++){l=a[n];if(l.selected){f(p,e(l.value,p))}}break}}}return g};T.splat=function(a){if(a==null){return[]}if(Object.prototype.toString.call(a)=="[object Array]"){return a}return[a]};T.createClass=function(a){return T.lang.createClass(function(b){this.options=T.extend(T.object.clone(this.options),T.object.clone(b));this._init&&this._init()}).extend(a)};T.createUI=function(a){return T.ui.createUI(function(b){this.uiType=this._type;this.classPrefix=this._type;this.options=T.extend(T.object.clone(this.options),T.object.clone(b));this._init&&this._init()}).extend(a)};T.inlineTip=function(b){var a=T.g(b);if(a){if(T.trim(a.value)==a.defaultValue){T.dom.addClass(a,"gray")}T.on(a,"focus",function(){if(T.trim(this.value)==this.defaultValue){T.dom.removeClass(this,"gray");this.value=""}});T.on(a,"blur",function(){if(T.trim(this.value)==""){T.dom.addClass(this,"gray");this.value=this.defaultValue}})}};T.getInlineTipInputValue=function(b){var a=T.g(b);if(a){if(a.defaultValue==T.g(b).value){return""}else{return T.g(b).value}}return""};T.clearInlineTipInputValue=function(b){var a=T.g(b);if(a&&a.defaultValue!=null){T.dom.addClass(a,"gray");a.value=a.defaultValue}};T.getCornerPosition=function(c,b,d){var c=T.g(c);var a=T.dom.getPosition(c);switch(b){case"br":a.left+=c.offsetWidth;a.top+=c.offsetHeight;break;case"tr":a.left+=c.offsetWidth;break;case"bl":a.top+=c.offsetHeight;break}if(d){if(d.left){a.left+=d.left}if(d.top){a.top+=d.top}}return a};T.setRelatedPosition=function(b,c,a,d){T.dom.setPosition(b,T.getCornerPosition(c,a,d))};T.expose=function(a){T.setRelatedPosition(a,a,"tl");T.dom.addClass(a,"expose")};T.unexpose=function(a){T.dom.removeClass(a,"expose")};baidu.event.ons=function(d,b,a,c){baidu.each(d,function(e){baidu.on(e,b,a,c)})};baidu.event.uns=function(c,b,a){baidu.each(c,function(d){baidu.un(d,b,a)})};baidu.truncat=function(b,a){if(b==null){return b}if(b.length>a){return b.substr(0,a-2)+"..."}else{return b}};baidu.param=function(b){var a=[];baidu.object.each(b,function(d,c){if(d==null){return}if(baidu.lang.isArray(d)){baidu.each(d,function(e){a.push(encodeURIComponent(c+"[]")+"="+encodeURIComponent(e))})}else{a.push(encodeURIComponent(c)+"="+encodeURIComponent(d))}});return a.join("&").replace(/%20/g,"+")};baidu.dragable=function(b,a){var c=baidu.G(a.handler)||baidu.G(b);a.onbeforestart=a.onbeforestart||function(){};a.onstart=a.onafterstart||function(){};delete a.onafterstart;c.onmousedown=function(f){a.onbeforestart();baidu.dragable.orgUpHandler=document.onmouseup;var d=baidu.dom.drag(b,window.event||f,a);document.onmouseup=function(g){d.stop();document.onmouseup=baidu.dragable.orgUpHandler};return false};c.onselectstart=function(d){return false}};baidu.ajax.jsonPost=function(b,c,a,d){baidu.ajax.request(b,{data:baidu.param(c),onsuccess:function(g){var e=null;try{e=baidu.json.decode(g.responseText);if(e.status===0||e.status>2){a(e.data,e.status)}else{if(e.status===1){if(d){d(e.msg)}}else{if(e.status===2){window.location=e.data}}}}catch(f){if(d){d("系统错误，请稍候再试…")}}},onfailure:function(e){if(e.status===0){return}if(d){d("系统错误，请稍候再试…")}},method:"POST",noCache:true})};baidu.ajax.jsonGet=function(b,c,a,d){baidu.ajax.request(b,{data:baidu.param(c),onsuccess:function(g){var e=null;try{e=baidu.json.decode(g.responseText);if(e.status===0||e.status>2){a(e.data,e.status)}else{if(e.status===1){if(d){d(e.msg)}}else{if(e.status===2){window.location=e.data}}}}catch(f){if(d){d("系统错误，请稍候再试…")}}},onfailure:function(e){if(e.status===0){return}if(d){d("系统错误，请稍候再试…")}},method:"GET",noCache:true})};baidu.dateSpan=function(a,b){if(a.getTime()!=b.getTime()&&b!=null){return baidu.date.format(a,"（yyyy-MM-dd")+baidu.date.format(b," ~ yyyy-MM-dd）")}else{return baidu.date.format(a,"（yyyy-MM-dd）")}};var EventRouter={_events:{},_owner:null,register:function(a,b){if(this._events[a]){this._events[a].push(b)}else{this._events[a]=[b]}},dispatch:function(a){var d=[].slice.call(arguments,1);var c=this._events[a];if(c){for(var b=0;b<c.length;b++){c[b].apply(this._owner,d)}}if(this._owner&&T.lang.isFunction(this._owner[a])){this._owner[a].apply(this._owner,d)}},setOwner:function(a){this._owner=a}};(function(){var b={};this.tmpl=function a(e,d){var c=!/\W/.test(e)?b[e]=b[e]||a(document.getElementById(e).innerHTML):new Function("obj","var p=[],print=function(){p.push.apply(p,arguments);};with(obj){p.push('"+e.replace(/[\r\t\n]/g," ").split("<%").join("\t").replace(/((^|%>)[^\t]*)'/g,"$1\r").replace(/\t=(.*?)%>/g,"',$1,'").split("\t").join("');").split("%>").join("p.push('").split("\r").join("\\'")+"');}return p.join('');");return d?c(d):c}})();(function(){var a={};getUniqueId=function(c){var d=c||8;var e="";while(d--){e+=b()}if(!a[e]){a[e]=1;return e}else{return getUniqueId(d)}};var b=function(){var d="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";var c=d.length;return d.charAt(Math.floor(Math.random()*c))}})();var AceTemplate=AceTemplate||{};(function(){var d={log:function(h){window.console&&console.log(h)}};var f={"#39":"'",quot:'"',lt:"<",gt:">",amp:"&",nbsp:" "};var c={"'":"#39",'"':"quot","<":"lt",">":"gt","&":"amp"," ":"nbsp"};var g={g:function(h){if(typeof h!="string"){return h}return document.getElementById(h)},decodeHTML:function(h){return String(h).replace(/&(#39|quot|lt|gt|amp|nbsp);/ig,function(j,i){return f[i]}).replace(/&#u([a-f\d]{4});/ig,function(i,j){return String.fromCharCode(parseInt("0x"+j))}).replace(/&#(\d+);/ig,function(i,j){return String.fromCharCode(+j)})},encodeHTML:function(h){return String(h).replace(/['"<>& ]/g,function(i){return"&"+c[i]+";"})},encodeAttr:function(h){return String(h).replace(/['"]/g,function(i){return"&"+c[i]+";"})},elementText:function(h){if(!h||!h.tagName){return""}if(/^(input|textarea)$/i.test(h.tagName)){return h.value}return g.decodeHTML(h.innerHTML)}};var a={};var e=false;function b(j){var i=[],k=[];i.push("with(this){");i.push(j.replace(/[\r\n]+/g,"\n").replace(/^\n+|\s+$/mg,"").replace(/((^\s*[<>!#^&\u0000-\u0008\u007F-\uffff].*$|^.*[<>]\s*$|^(?!\s*(else|do|try|finally)\s*$)[^'":;,\[\]{}()\n\/]+$|^(\s*(([\w-]+\s*=\s*"[^"]*")|([\w-]+\s*=\s*'[^']*')))+\s*$|^\s*([.#][\w-.]+(:\w+)?(\s*|,))*(?!(else|do|while|try|return)\b)[.#]?[\w-.*]+(:\w+)?\s*\{.*$)\s?)+/mg,function(l){l=['"',l.replace(/&none;/g,"").replace(/["'\\]/g,"\\$&").replace(/\n/g,"\\n").replace(/(!?(#|@))\{(.*?)\}/g,function(q,n,m,p){p=p.replace(/\\n/g,"\n").replace(/\\([\\'"])/g,"$1");var o=/^[a-z$][\w+$]+$/i.test(p)&&!(/^(true|false|NaN|null|this)$/.test(p));return['",',o?["typeof ",p,'=="undefined"?"":'].join(""):"",(n=="#"?"_encode_":""),(m=="@"?"_encodeAttr_":""),"(",p,'),"'].join("")}),'"'].join("").replace(/^"",|,""$/g,"");if(l){return["_output_.push(",l,");"].join("")}else{return""}}));i.push("}");var h=new Function("_output_","_encode_","_encodeAttr_","helper",i.join(""));return h}AceTemplate.format=function(m,l,k){if(!m){return""}var h,j;if(typeof m=="object"&&m.tagName){j=m;m=j.getAttribute("id")}k=k||this;h=a[m];if(!h){if(!/[^\w-]/.test(m)){if(!j){j=g.g(m)}h=this.register(m,j)}else{h=b(m)}}var i=[];h.call(l||"",i,g.encodeHTML,g.encodeAttr,k);return i.join("")};AceTemplate.register=function(m,l){if(!arguments.length&&!e){e=true;var h=document.getElementsByTagName("script");for(var k=0;k<h.length;k++){var j=h[k];if(/^(text\/template)$/i.test(j.getAttribute("type"))){var m=j.getAttribute("id");m&&arguments.callee.call(this,m,j)}}}if(!m){return}if(a[m]){return a[m]}if(typeof l!="string"){if(typeof l=="undefined"){l=g.g(m)}l=g.elementText(l)}return a[m]=b(l)};AceTemplate.unregister=function(h){delete a[h]}})();function loadedCallback(a){EventRouter.dispatch("onflashLoaded",a)}function createImageSuccess(a){EventRouter.dispatch("onflashCreateImageSuccess",a)}function hasParent(d,e){var c=arguments;if(typeof e==="string"){var b=T.dom.query(e);var a=false;T.element(e).each(function(f){a=a||c.callee(d,f)});return a}else{if(d===e&&d===document.body){return true}else{do{if(d===e){return true}else{if(d===document.body){return false}}}while(d=d.parentNode)}return false}}T.lang.isUrl=T.lang.isUrl||function(a){return/^((https|http|ftp|rtsp|mms)?:\/\/)?(([\w-]+\.)+[a-z]{2,6}|((25[0-5]|2[0-4]\d|1\d{2}|[1-9]\d|\d)\.){3}(25[0-5]|2[0-4]\d|1\d{2}|[1-9]\d|\d))(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?/i.test(a)};T.dom.one=function(c,b){if(T.isString(b)){b=T.g(b)}var a=T.dom.query(c,b);if(a.length>0){return a[0]}else{return null}};T.initShowLine=function(f,b){if(!f){return}var d=f.value.replace(/\r/gi,"");var e=d.split("\n").length;if(e>b){T.dom.next(f).innerHTML="您最多可输入"+b+"个";f.pass=false}else{f.pass=true;T.dom.next(f).innerHTML=""}var a="";for(var c=1;c<=e;c++){if(document.all){a+=c+"\r\n"}else{a+=c+"\n"}}T.dom.prev(f).value=a;T.dom.prev(f).scrollTop=f.scrollTop;f.onscroll=function(){T.dom.prev(f).scrollTop=f.scrollTop}};T.getTipElement=function(a){var b=T.dom.create("div",{style:"position: absolute;"});b.className="tip-container";b.innerHTML='<div style="position: relative;top:8px; left:-10px;" class="tip-div tip-theme title-theme"><div class="tip-arrow"></div><div class="tip-wrap">'+a+"</div></div>";return b};T.beforeUnloadAlert=function(){window.onbeforeunload=function(){return'您还没有保存刚才的设置。如需要保存设置，请点击"留在此页"，然后点击当前页面的"确定"'}};T.postBtnBind=function(d,b){var c=T.g(d);var a=function(){setTimeout(function(){T.dom.removeClass(c,"disabled")},1000)};T.on(c,"click",function(f){if(T.dom.hasClass(c,"disabled")){T.event.stop(f)}else{T.dom.addClass(c,"disabled");b(f,a)}})};T.isInputsChanged=(function(){return function(b){var c=false;var g=b;for(var e=0;e<g.length;e++){var d=g[e];var f=d.type;if(f=="text"||f=="hidden"||f=="button"){if(!T.dom.hasAttr(d,"dyna-value")){if(d.value!=d.defaultValue){c=true;break}}else{if(d.value!=T.dom.getAttr(d,"dyna-value")){c=true;break}}}else{if(f=="radio"||f=="checkbox"){if(!T.dom.hasAttr(d,"dyna-checked")){if(d.checked!=d.defaultChecked){c=true;break}}else{var a=T.dom.getAttr(d,"dyna-checked")=="true"?true:false;if(d.checked!=a){c=true;break}}}}}return c}})();T.setDynaValue=function(a){var e=a;for(var c=0;c<e.length;c++){var b=e[c];var d=b.type;if(d=="text"||d=="hidden"||d=="textarea"||d=="button"){T.dom.setAttr(b,"dyna-value",b.value)}else{if(d=="radio"||d=="checkbox"){T.dom.setAttr(b,"dyna-checked",b.checked)}}}};T.resetForm=function(b){var f=b;for(var d=0;d<f.length;d++){var c=f[d];var e=c.type;var a=T.dom.hasAttr(c,"defaultText");if(e=="text"||e=="hidden"||e=="textarea"||e=="button"){if(!a){c.value=c.defaultValue}else{c.value=T.dom.getAttr(c,"defaultText");T.dom.addClass(c,"gray")}}else{if(e=="radio"||e=="checkbox"){c.checked=c.defaultChecked}}}};T.getAncestorOrSelfByClass=function(a,c){var b=T.dom.getAncestorByClass(a,c);if(b){return b}else{if(T.dom.hasClass(a,c)){return a}else{return null}}};T.settingTableHover=function(){T.element(T.q("setting-table")).mouseover(function(c){var b=T.event.getTarget(c);var a=T.getAncestorOrSelfByClass(b,"setting-table-tr");if(a){T.dom.addClass(a,"tr-highlight")}});T.element(T.q("setting-table")).mouseout(function(c){var b=T.event.getTarget(c);var a=T.getAncestorOrSelfByClass(b,"setting-table-tr");if(a){T.dom.removeClass(a,"tr-highlight")}})};T.isIco=function(){return T.config.userInfo.roles.ico};T.isUnion=function(){return T.config.userInfo.roles.webmaster};T.isCustomer=function(){var a=/.*customer$/i,b;T.object.each(T.config.userInfo.roles,function(d,c){if(a.test(c)&&d){b=true}});return b};T.auth=function(a){return T.config.userInfo.auths[a]};T.lang.isEmail=T.lang.isEmail||(function(a){return/^\w+([-\.]\w+)*@\w+([-\.]\w+)*\.\w+([-\.]\w+)*$/i.test(a)});(function(){var b=null;var a=null;T.on(document.body,"click",function(e){var g=T.event.get(e).target;var f=null;var d=null;do{if(g!=document){if(T.dom.hasClass(g,"layer")){d=g}if(T.dom.hasAttr(g,"layer")){f=g}}}while(g=g.parentNode);var c=function(j,i){if(i){T.dom.addClass(j,"selected")}else{T.dom.removeClass(j,"selected")}T.each(T.q("arrow",j),function(k){if(i){T.dom.addClass(k,"selected")}else{T.dom.removeClass(k,"selected")}})};if(f==null){if(a!=null&&d!=a){T.hide(a);c(b,false);EventRouter.dispatch("onchangeToggleTarget",b);a=null;b=null}}else{var h=T.dom.one(T.dom.getAttr(f,"layer"));if(h!=null){if(a!=null&&h!=a){T.hide(a);c(b,false)}a=null;b=null;if(h.style.display=="none"||T.dom.hasClass(h,"shared-layer")){T.show(h);c(f,true);if(!T.dom.hasClass(h,"non-excludable")){a=h}b=f}else{T.hide(h);c(f,false)}}}})})();baidu.string.format=function(c,a){c=String(c);var b=Array.prototype.slice.call(arguments,1),d=Object.prototype.toString;if(b.length){b=b.length==1?(a!==null&&(/\[object Array\]|\[object Object\]/.test(d.call(a)))?a:b):b;return c.replace(/(#|!)\{(.+?)(?:\s*,\s*(\d+?))*?\}/g,function(e,h,g,i){var f=b[g];if("[object Function]"==d.call(f)){f=f(g)}if(i){f=T.truncat(f,i)}if(h=="!"){f=T.string.encodeHTML(f)}return("undefined"==typeof f?"":f)})}return c};baidu.format=baidu.string.format;T.swf.createClipBoard=function(a){var c={id:"id"+(+new Date()),flashId:"head",flashContainer:"HeadCodeCopyBtn",width:62,height:22,clip:function(d){},success:function(d){},fail:function(d){}},b=T.object.extend(c,a);T.swf.create({id:b.id,width:b.width,height:b.height,ver:"9.0.28",errorMessage:"请下载最新的Flash播放器！",url:T.config.systemConfig.webRoot+"/flash/clipboard.swf",bgcolor:"#000",wmode:"transparent",vars:{flashId:b.flashId}},b.flashContainer);if(!window.onClip){window.onClip=b.clip}if(!window.onFail){window.onFail=b.fail}if(!window.onSuccess){window.onSuccess=b.success}};(function(a){a.fn.bgiframe=(a.browser.ie&&/msie 6.0/i.test(navigator.userAgent)?function(e,d){d=a.extend({top:"auto",left:"auto",width:"auto",height:"auto",opacity:true,src:"javascript:false;"},d);var c='<iframe class="bgiframe" frameborder="0" tabindex="-1" src="'+d.src+'"style="display:block;position:absolute;z-index:-1;'+(d.opacity!==false?"filter:Alpha(Opacity='0');":"")+"top:"+(d.top=="auto"?"expression(((parseInt(this.parentNode.currentStyle.borderTopWidth)||0)*-1)+'px')":b(d.top))+";left:"+(d.left=="auto"?"expression(((parseInt(this.parentNode.currentStyle.borderLeftWidth)||0)*-1)+'px')":b(d.left))+";width:"+(d.width=="auto"?"expression(this.parentNode.offsetWidth+'px')":b(d.width))+";height:"+(d.height=="auto"?"expression(this.parentNode.offsetHeight+'px')":b(d.height))+';"/>';return T.array.each(e,function(f){if(T.dom.query("iframe.bgiframe",f).length==0){f.insertBefore(T.dom.create(c),f.firstChild)}})}:function(){return this});a.fn.bgIframe=a.fn.bgiframe;function b(c){return c&&c.constructor===Number?c+"px":c}})(T);T.ui.CheckGroup=T.createUI({options:{containerId:"CheckGroup",onchange:function(a,b){},limit:Number.MAX_VALUE,label:"",items:[],tip:false,selectedItems:[],template:'<label title="!{3}" for="!{0}"><input id="!{0}" value="!{1}" type="#{2}" title="!{3}" #{4} name="#{5}" />#{6}</label>',groupTemplate:'<div class="group wrapped clearfix">#{1}#{0}</div>',separatorTemplate:'<div class="separator"></div>',tipTemplate:'<a class="help" data="#{0}" href="javascript:void(0)">&nbsp;</a>',groupWrapTemplate:'<div class="group-wrapper">#{0}</div>'},_type:"checkGroup",_items:null,_selectedItems:null,_init:function(){if(!T.lang.isArray(this.options.items[0])){this._items=[this.options.items]}else{this._items=this.options.items}this._selectedItems=T.object.clone(this.options.selectedItems);this._type=(this.options.limit==1?"radio":"checkbox")},_renderHtml:function(){var a=[];T.array.each(this._items,function(e,c){var b=[],d;if(e.length!=0){if(c!=0){a.push(this.options.separatorTemplate)}T.array.each(e,function(h,g){if(this.options.tip){var f=T.encodeHTML(h.label)+T.format(this.options.tipTemplate,h.id)}else{f=T.encodeHTML(h.label)}b.push(T.format(this.options.template,this.getId(h.id),h.id,this._type,h.label,(T.array.contains(this._selectedItems,h.id)?' checked="checked"':""),this.getId(this.options.containerId),f))},this);d=this.options.groupWrapTemplate?T.format(this.options.groupWrapTemplate,b.join("")):b.join("");a.push(T.format(this.options.groupTemplate,d,this.options.label?'<label class="label">'+this.options.label+"</label>":""))}},this);return a.join("")},_bind:function(){T.array.each(T.dom.query(":input",T.g(this.options.containerId)),function(a,b){var c=this;this.on(a,"click",function(f){if(c._type=="checkbox"){var d=c._selectedItems;if(this.checked){d.push(this.value)}else{if(d.length==1){this.checked=true;return false}T.array.remove(d,this.value)}if(d.length>c.options.limit){var e=T.array.removeAt(d,0);T.g(c.getId(e)).checked=false}}else{if(c._selectedItems&&c._selectedItems.length==1&&c._selectedItems[0]==this.value){return}c._selectedItems=[this.value]}var g=[];T.array.each(c._selectedItems,function(h){g.push(T.getAttr(c.getId(h),"title"))});c.options.onchange(c._selectedItems,g)})},this)},reset:function(){var a=T.g(this.options.containerId),c=this.getId(this.options.items[0].id),b=this;if(a){T.array.each(T.dom.query("input",a),function(d){var e=d.id;if(c==e){d.checked=true}else{d.checked=false}})}this._selectedItems=[this.options.items[0].id];this.options.onchange(this._selectedItems,[])},render:function(){var a=T.g(this.options.containerId);if(a){T.dom.empty(a);T.insertHTML(a,"beforeEnd",this._renderHtml());this._bind()}},click:function(b){var a=T.g(this.getId(b));if(a){a.click()}},getSelectedLabels:function(){var b=[],a=this;T.array.each(this._selectedItems,function(c){b.push(T.getAttr(a.getId(c),"title"))});return b}});baidu.ui.Combobox=T.createUI({_type:"combobox",options:{containerId:null,items:null,selectedId:null,defaultText:"请选择",width:200,onrender:T.fn.blank,onchange:function(a){},comboboxTemplate:'<a class="combobox" href="javascript:void(0)" id="#{1}" layer="##{2}"><span title="!{0}" class="text ellipsis">!{0,20}</span><span class="arrow"></span></a>',itemTemplate:'<li><a title="!{0}" href="javascript:void(0)" data="#{1}" class="#{2}">!{0}</a></li>',wrapperTemplate:'<ul class="options layer" style="display:none;position:absolute;width:#{2}px" id="#{1}">#{0}</ul>'},_init:function(){this._selectedId=this.options.selectedId;this._items=this.options.items;this._defaultText=this.options.defaultText;if(this.options.searchable){this._originalItems=this.options.items;this.options=T.extend(this.options,{defaultText:"未选择",nodataText:"没有数据",itemTemplate:'<li><a title="!{0}" href="javascript:void(0)" data="#{1}" class="#{2}"><span>!{0}</span></a></li>',wrapperTemplate:'<div class="options layer srhcom" style="display:none;position:absolute;width:#{2}px" id="#{1}"><ul id="#{1}-ul" class="">#{0}</ul><div id="#{1}-srhbar" style="display:none;" class="srhbar"><form action="javascript:void 0" id="#{1}-srhform"><input type="text" id="#{1}-keyword" class="srhword"/><a href="javascript:void(0)" class="srhbtn" id="#{1}-srhbtn"></a><a href="javascript:void(0);" style="display:none;" id="#{1}-close" class="dialog-close">×</a></form></div></div>',onrender:function(){var g=this,d=g.getId("List-ul"),i=g.getId("List-keyword"),e=g.getId("List-srhform"),a=g.getId("List-srhbtn"),b=g.getId("List-close"),h=function(j){g._items=j;T.dom.empty(d);T.dom.insertHTML(d,"beforeend",g.genItems(!(j&&j.length>0)));g._bindEvents()},f=function(){var l=T.g(i),k=l.value,j=T.array.filter(g._originalItems,function(m){if(String(m.label).toLowerCase().indexOf(String(k).toLowerCase())===-1){return false}return true});h(j)},c=function(){T.g(i).value="";f();T.hide(b);T.show(a)};g.reset=function(){c();g.select()};if(!g._originalItems||g._originalItems.length<=12){return}T.show(g.getId("List-srhbar"));T.on(e,"submit",function(j){T.event.stop(j);f()});T.on(a,"click",function(j){T.event.stop(j);f()});T.on(b,"click",function(j){c();T.g(i).focus()});T.on(i,"keyup",function(k){var j=T.g(i).value;if(j&&T.trim(j)!=""){T.hide(a);T.show(b);f()}else{c()}});if(this.options.searchTip){T.g(i).value=this.options.searchTip;T.dom.addClass(i,"gray");T.on(i,"focus",function(j){T.dom.removeClass(i,"gray");if(this.value&&this.value==g.options.searchTip){this.value=""}});T.on(i,"blur",function(j){if(this.value&&T.trim(this.value)!=""){return}T.dom.addClass(i,"gray");this.value=g.options.searchTip})}T.fn.bgIframe([T.g(g.getId("List"))])}});T.dom.addClass(this.options.containerId,"srhcom");this.render(this.options.items)}},_selectedId:null,_items:null,_defaultText:null,_bindEvents:function(){var a=this;T.event.ons(T.dom.query("#"+this.getId("List")+" li a"),"click",function(){var d=T.dom.getAttr(this,"data");var b=T.array.find(a._items,function(e){if(e.id==d){return true}});if(!b){return}var c=T.dom.one(".text",a.getId());if(c){c.innerHTML=T.format("!{0,20}",b.label);c.title=b.label}a._hide();if(d!=a._selectedId){a._selectedId=d;a.options.onchange(d,b.label)}T.dom.removeClass(a.getId(),"selected")});T.on(this.getId(),"click",function(){if(T.dom.hasClass(this,"combobox-disabled")){return}var b=T.dom.one(".arrow",this);if(!T.dom.hasClass(b,"selected")){a._show()}})},_show:function(){var b=T.getCornerPosition(this.getId(),"bl");b.top--;T.dom.setPosition(this.getId("List"),b);if(this.options.searchable){var a=T.g(this.getId("List")).offsetHeight;var c=document.body.offsetHeight-b.top-400;if(c<0){T.dom.setStyles(this.getId("List-ul"),{"max-height":370+c})}else{T.dom.setStyles(this.getId("List-ul"),{"max-height":""})}}},_hide:function(){var a=T.dom.one(".arrow",this.getId());if(T.dom.hasClass(a,"selected")){T.dom.removeClass(a,"selected")}T.hide(this.getId("List"))},_render:function(){var d=this._defaultText;if(this._items&&this._items.length>0){d=this._items[0].label;if(this._selectedId){for(var b=0,a=this._items.length;b<a;b++){var c=this._items[b];if(c.id==this._selectedId){d=c.label;break}}}else{if(!this.options.selectfirst){this._selectedId=this._items[0].id}}}T.dom.insertHTML(this.options.containerId,"beforeend",T.format(this.options.comboboxTemplate,d,this.getId(),this.getId("List")));if(this._items&&this._items.length>0){T.dom.removeClass(this.getId(),"combobox-disabled");T.dom.insertHTML(document.body,"beforeend",T.format(this.options.wrapperTemplate,this.genItems(),this.getId("List"),this.options.width))}else{if(this.options.nodataText){T.dom.removeClass(this.getId(),"combobox-disabled");T.dom.insertHTML(document.body,"beforeend",T.format(this.options.wrapperTemplate,this.genItems(true),this.getId("List"),this.options.width))}else{T.dom.addClass(this.getId(),"combobox-disabled")}}},genItems:function(c){if(!c){var f=[];for(var d=0,a=this._items.length;d<a;d++){var e=this._items[d],b="";b+=e.disabled?"disabled ":"";b+=d==0?"top ":"";b+=d==a-1?"last ":"";b+=e.cls?e.cls:"";f.push(T.format(this.options.itemTemplate,e.label,e.id,b))}return f.join("")}else{var b="top last ";b+=this.options.nodataCls?this.options.nodataCls:"";return T.format(this.options.itemTemplate,this.options.nodataText,"",b)}},setDefaultText:function(a){this._defaultText=a},render:function(b,a){if(!T.g(this.options.containerId)){return}if(!!b||b===null){this._items=b}if(a!==undefined){this._selectedId=a}T.dom.empty(this.options.containerId);if(T.g(this.getId("List"))){T.dom.remove(this.getId("List"))}this._render();this._bindEvents();this.options.selectfirst&&this.select(a);this.options.onrender.call(this)},select:function(a){var b=true,c;if(a){c=T.dom.query("#"+this.getId("List")+" li a[data="+a+"]");if(c&&c.length>0){b=false;T.event.fire(c[0],"click")}}if(b&&this._items&&this._items.length>0){c=T.dom.query("#"+this.getId("List")+" li a:first");T.event.fire(c[0],"click")}}});T.CreateFlash=T.createClass({options:{ids:[],containerId:"FlashContainer",data:null,by:[],type:[],indicator:null},_init:function(){EventRouter.register("onflashLoaded",T.fn.bind(this._flashLoadedCallback,this));this.dataAdapter=new T.DataAdapter();this.flashFormatConverter=new T.FlashFormatConverter();var b=this,a=T.g(this.options.containerId);T.array.each(this.options.data,function(f,d){var c="Flash_"+d,e="FlashContainerId_"+d,g=T.dom.create("div",{id:e});a.appendChild(g);b._initFlash({id:c,type:b.options.type[d],flashContainerId:e,flashBaseUrl:"flash/"})})},_initFlash:function(b){var a=b.flashBaseUrl+b.type+".swf";T.swf.create({id:b.id,url:a,width:b.width||"100%",height:b.height||"320",bgColor:"#FFFFFF",wmode:"transparent",errorMessage:"载入FLASH出错",ver:"9.0.0",allowscriptaccess:"always",vars:{flashId:b.id,baseUrl:b.flashBaseUrl+"fla"}},b.flashContainerId)},_flashLoadedCallback:function(e){var a=e.split("_"),d=a[1],f=this.options.data[d];var h=f.msg,b=f.status,c=f.data;c.flashId=e;c.by=this.options.by[d];c.type=this.options.type[d];c.indicator=this.options.indicator;if(c.type=="bar"){c.tipLabel="SmallTip"}var g=this.dataAdapter.convertFlashDataFormat(c);this.flashFormatConverter.setFlash(g)}});T.DataAdapter=T.createClass({options:{onflashError:function(a){}},ConvertTableData:function(K){var v=T.config.indexInfo.indexes;var f=T.array.map(v,function(i){return i.id});var h=[];T.each(K.fields,function(j){var i=T.array.indexOf(f,j);if(i>-1){h.push(v[i])}});var n=h[0];var H=T.config.indexInfo.indicators;var y=T.array.map(H,function(i){return i.id});var a=[];var u=[];var B=null;var w=null;T.each(K.fields,function(l,i){if("ratio_"+B==l){u.push(w-u.length-1)}B=l;w=i;var j=T.array.indexOf(y,l);if(j>-1){a.push(H[j])}});var F=[];var b=[];var x=[];var J=false;var G=false;var r=1;if(K.items[2]&&K.items[2].length>0){J=true;r=3}if(K.items[3]&&K.items[3].length>0){G=true;r=4}if(r>1&&K.mergeIndex){r=r-1}T.array.each(h,function(i){var j={id:i.id,label:i.label,sortable:i.sortable,tip:i.tip,className:"table-index"};if(J&&K.mergeIndex){j.colspan=2}F.push(j)});for(var D=0;D<a.length;D++){var t=a[D];F.push({id:t.id,label:t.label,sortable:t.sortable,tip:t.tip,className:t.type})}for(var D=0,A=K.items[0].length;D<A;D++){var e=K.items[0][D];var s=K.items[1][D];var g=J?K.items[2][D]:null;var m=G?K.items[3][D]:null;if(!J){var k=[];T.array.each(h,function(l,L){if(T.lang.isObject(e[L])){var j={id:l.id,label:e[L].label,className:"table-index"};if(e[L].expandable!=null){j.expandable=e[L].expandable}if(e[L].hasOperation!=null){j.hasOperation=e[L].hasOperation}if(e[L].data!=null){j.data=e[L].data}k.push(j)}else{k.push({id:l.id,label:e[L],className:"table-index"})}});for(var C=0;C<a.length;C++){var t=a[C];var q=this._formatTableText(s[C],t.type);var d=T.array.indexOf(u,C);if(d>-1){q=q+"("+this._formatTableText(s[C+1],"ratio")+")";s.splice(C,1)}k.push({id:t.id,label:q,className:t.type})}b.push(k)}else{var c=[];var I=[];var o=[];var p={label:e[0],className:"table-index"};if(T.lang.isObject(e[0])){p={id:n.id,label:e[0].label,className:"table-index"};if(e[0].expandable!=null){p.expandable=e[0].expandable}if(e[0].hasOperation!=null){p.hasOperation=e[0].hasOperation}if(e[0].data!=null){p.data=e[0].data}}if(K.mergeIndex){p.rowspan=2;c.push(p)}else{b.push([p,{label:"&nbsp;",className:"",colspan:a.length}])}c.push({id:n.id,label:s[0]});I.push({id:n.id,label:g[0]});G&&o.push({id:n.id,label:m[0]});for(var C=0;C<a.length;C++){var t=a[C];var z=this._formatTableText(s[C+1],t.type);var E=this._formatTableText(g[C+1],t.type);var d=T.array.indexOf(u,C+1);if(d>-1){z=z+"("+this._formatTableText(s[C+2],"ratio")+")";E=E+"("+this._formatTableText(g[C+2],"ratio")+")";if(G){o.push({id:t.id,label:this._formatTableText(m[C+2],"ratio"),className:t.type});m.splice(C+1,1)}s.splice(C+1,1);g.splice(C+1,1)}else{G&&o.push({id:t.id,label:this._formatTableText(m[C+1],"ratio"),className:t.type})}c.push({id:t.id,label:z,className:t.type});I.push({id:t.id,label:E,className:t.type})}b.push(c);b.push(I);G&&b.push(o)}}if(K.pageSum&&K.pageSum.length>0){var s=K.pageSum[0];var g=J?K.pageSum[1]:null;var m=G?K.pageSum[2]:null;if(!J){var k=[];if(n){k.push({id:n.id,label:"当页汇总"})}if(a[0]){for(var D=0;D<K.fields.length;D++){if(K.fields[D]==a[0].id){for(var C=(n?1:0);C<D;C++){k.push({id:K.fields[D],label:""})}break}}}for(var C=0;C<a.length;C++){var t=a[C];var q=this._formatTableText(s[C],t.type);var d=T.array.indexOf(u,C);if(d>-1){q=q+"("+this._formatTableText(s[C+1],"ratio")+")";s.splice(C,1)}k.push({id:t.id,label:q,className:t.type})}x.push(k)}else{var c=[];var I=[];var o=[];if(n){x.push([{id:n.id,label:"当页汇总",colspan:a.length+1}])}c.push({id:n.id,label:s[0]});I.push({id:n.id,label:g[0]});G&&o.push({id:n.id,label:m[0]});for(var C=0;C<a.length;C++){var t=a[C];var z=this._formatTableText(s[C+1],t.type);var E=this._formatTableText(g[C+1],t.type);var d=T.array.indexOf(u,C);if(d>-1){z=z+"("+this._formatTableText(s[C+2],"ratio")+")";E=E+"("+this._formatTableText(g[C+2],"ratio")+")";if(G){o.push({id:t.id,label:this._formatTableText(m[C+2],"ratio"),className:t.type});m.splice(C+1,1)}s.splice(C+1,1);g.splice(C+1,1)}else{G&&o.push({id:t.id,label:this._formatTableText(m[C+1],"ratio"),className:t.type})}c.push({id:t.id,label:z,className:t.type});I.push({id:t.id,label:E,className:t.type})}x.push(c);J&&x.push(I);G&&x.push(o)}}if(K.sum&&K.sum.length>0){for(var C=0;C<a.length;C++){var t=a[C];var d=T.array.indexOf(u,J?C+1:C);if(d>-1){K.sum[0][C]=this._formatTableText(K.sum[0][C],t.type)+"("+this._formatTableText(K.sum[0][C+1],"ratio")+")";K.sum[0].splice(C+1,1);if(J){K.sum[1][C]=this._formatTableText(K.sum[1][C],t.type)+"("+this._formatTableText(K.sum[1][C+1],"ratio")+")";K.sum[1].splice(C+1,1)}}else{K.sum[0][C]=this._formatTableText(K.sum[0][C],t.type);if(J){K.sum[1][C]=this._formatTableText(K.sum[1][C],t.type)}}}}K.thead=F;K.tbody=b;K.tfoot=x;K.group=r;K.isCompare=J;K.indicators=a;return K},ConvertSimpleTableData:function(v){var k=T.config.indexInfo.indexes;var d=T.array.map(k,function(i){return i.id});var f=null;T.each(v.fields,function(j){var i=T.array.indexOf(d,j);if(i>-1){f=k[i]}});var u=T.config.indexInfo.indicators;var p=T.array.map(u,function(i){return i.id});var a=[];T.each(v.fields,function(j){var i=T.array.indexOf(p,j);if(i>-1){a.push(u[i])}});var t=[];var b=[];var n=[];var g=1;var c={id:f.id,label:f.label,sortable:f.sortable,tip:f.tip,className:"table-index"};t.push(c);for(var s=0;s<a.length;s++){var h=a[s];t.push({id:h.id,label:h.label,sortable:h.sortable,tip:h.tip,className:h.type})}for(var s=0,q=v.items.length;s<q;s++){var m=v.items[s];var e=[];var o=0;if(f){e.push({id:f.id,label:m[0],className:"table-index"});o=1}for(var r=0;r<a.length;r++){var h=a[r];e.push({id:h.id,label:this._formatTableText(m[r+o],h.type),className:h.type})}b.push(e)}v.thead=t;v.tbody=b;v.tfoot=n;v.group=g;v.isCompare=false;v.indicators=a;return v},ConvertSubTableData:function(c){var o=T.config.subTableIndicators;var h=T.array.map(o,function(i){return i.id});var k=[];T.each(c.fields,function(j){var i=T.array.indexOf(h,j);if(i>-1){k.push(o[i])}});var g=[];var e=[];for(var d=0;d<k.length;d++){var m=k[d];g.push({id:m.id,label:m.label,sortable:m.sortable,className:m.type})}for(var d=0,a=c.items.length;d<a;d++){var f=c.items[d];var n=[];for(var b=0;b<k.length;b++){var m=k[b];n.push({id:m.id,label:this._formatTableText(f[b],m.type),className:m.type})}e.push(n)}c.thead=g;c.tbody=e;c.indicators=k;return c},_formatTableText:function(b,a){if(b==null){return""}if(b=="--"){return b}if(T.lang.isString(a)){switch(a){case"number":return T.i18n.number.formatNumber(b);case"ratio":return T.i18n.number.formatRatio(b);case"time":return T.i18n.number.formatTime(b);case"time2":return T.i18n.number.formatTime(b,2)}}return b},ConvertFlowData:function(g){var h={};for(var e=0,a=g.length;e<a;e++){var b=g[e].items;var c=b[0],f=b[1];var d=[];T.array.each(c,function(k,j){d.push(k.concat(f[j]))});h[e]=d}return h},convertFlashDataFormat:function(a){if(a.by==null){a.by="day"}var c,b=a.type;switch(b){case"line":if(a.duplicated){this.hanldeDuplicatedLabels(a)}c=this.convertFlashLineDataFormat(a);break;case"linepie":c=this.convertFlashLinePieDataFormat(a);break;case"area":c=this.convertFlashAreaDataFormat(a);break;case"pie":c=this.convertFlashPieDataFormat(a);break;case"areapie":c=this.convertFlashAreaPieDataFormat(a);break;case"circle":c=this.convertFlashCircleDataFormat(a);break;case"circlegraph":c=this.convertFlashCircleGraphDataFormat(a);break;case"bar":c=this.convertFlashBarDataFormat(a);break;default:break}return c},convertLineChartDataFormat:function(f){var b=this.initLineChartDataConfig(f);var s=this.detectLineChartDataFeature(f);if(f.duplicated){this.hanldeDuplicatedLabels(f)}var n=hmcharts.util.format.format;if(!s.noData){var o=["#3291fc","#ccc"];var q=[{background:"#3291fc",opacity:0.1},{background:"#ccc",opacity:0.1}];switch(true){case !s.dateCompared&&s.singleIndicator&&!s.indicatorSubdivided:var p=this.getLineChartIndicatorMetaData(f.fields[1]);var h={name:p.label,type:"line",legendIcon:"circle",yAxis:1,data:[],dataType:this.getDataType(p.unit)};T.each(f.items[1],function(i){h.data.push(isNaN(i[0])?0:i[0])});b.series.push(h);b.yAxis.push(this.getYAxisConfig(p.unit));break;case !s.dateCompared&&s.singleIndicator&&s.indicatorSubdivided&&!s.withRatio:var g=f.fields;var j=f.items[1];var p=this.getLineChartIndicatorMetaData(f.indicator);for(var e=1,c=g.length;e<c;e++){var h={name:T.encodeHTML(g[e]),type:"line",legendIcon:"circle",yAxis:1,data:[],dataType:this.getDataType(p.unit)};T.each(j,function(i){h.data.push(isNaN(i[e-1])?0:i[e-1])});b.series.push(h)}b.yAxis.push(this.getYAxisConfig(p.unit));break;case !s.dateCompared&&s.singleIndicator&&s.withRatio:var g=f.fields;var j=f.items[1];var p=this.getLineChartIndicatorMetaData(f.indicator);var d=this.getDataType(p.unit);for(var e=1,c=g.length;e<c;e=e+2){var h={name:T.encodeHTML(g[e]),type:"line",legendIcon:"circle",yAxis:1,data:[],dataType:d,tooltipData:[],tooltipTitle:p.label+" / 占比",needSubtitle:true};T.each(j,function(i){h.data.push(isNaN(i[e-1])?0:i[e-1]);h.tooltipData.push([isNaN(i[e-1])?i[e-1]:n(i[e-1],d),i[e]+(isNaN(i[e])?"":"%")])});b.series.push(h)}b.yAxis.push(this.getYAxisConfig(p.unit));break;case !s.dateCompared&&!s.singleIndicator:var g=f.fields;var j=f.items[1];var m=[];for(var e=1,c=g.length;e<c;e++){m.push(this.getLineChartIndicatorMetaData(g[e]));var h={name:m[e-1].label,type:"line",legendIcon:"circle",yAxis:e,data:[],dataType:this.getDataType(m[e-1].unit)};if(e>1&&m[e-1].unit===m[e-2].unit){h.yAxis=e-1}else{b.yAxis.push(this.getYAxisConfig({position:e===1?"left":"right",axisLabel:{format:"{value}"+m[e-1].unit,dataType:m[e-1].unit==="时长"?"time":undefined,shareSuffix:true}}))}T.each(j,function(i){h.data.push(isNaN(i[e-1])?0:i[e-1])});b.series.push(h)}break;case s.dateCompared&&!s.indicatorSubdivided:var a=f.timeSpan;var g=f.fields;var r=f.items;var p=this.getLineChartIndicatorMetaData(g[2]);var k=this;T.each(a,function(l,i){b.series.push({name:l,isArea:1,type:"line",legendIcon:"circle",color:o[i],areaStyle:q[i],yAxis:1,data:[],dataType:k.getDataType(p.unit),tooltipTitle:p.label+"对比",needSubtitle:true});T.each(r[i+1],function(t){b.series[i].data.push(isNaN(t[1])?0:t[1])})});b.yAxis.push(this.getYAxisConfig(p.unit));if(f.by!=="hour"){b.xAxis[0].data=[];T.each(r[1],function(i){b.xAxis[0].data.push(i[0])})}break;case s.dateCompared&&s.indicatorSubdivided:var a=f.timeSpan;var r=f.items;var p=this.getLineChartIndicatorMetaData(f.indicator);var d=this.getDataType(p.unit);T.each(a,function(l,i){b.series.push({name:l,isArea:1,type:"line",legendIcon:"circle",color:o[i],areaStyle:q[i],yAxis:1,data:[],dataType:d,tooltipTitle:p.label+"对比",needSubtitle:true});T.each(r[i+1],function(t){b.series[i].data.push(isNaN(t[1])?0:t[1])});if(s.withRatio){b.series[i].tooltipData=[];T.each(r[i+1],function(t){b.series[i].tooltipData.push([(isNaN(t[1])?t[1]:n(t[1],d)),t[2]+(isNaN(t[2])?"":"%")])})}});b.yAxis.push(this.getYAxisConfig(p.unit));if(f.by!=="hour"){b.xAxis[0].data=[];T.each(r[1],function(i){b.xAxis[0].data.push(i[0])})}break;default:break}}return b},initLineChartDataConfig:function(a){var b={isArea:0,xAxis:[{type:"category",position:"bottom",axisTick:{interval:0,lineStyle:{color:"#ccc"}},axisLine:{style:{color:"#ccc"}},axisLabel:{margin:14,maxDisplayLength:13},data:[]}],yAxis:[],series:[],legend:{position:"top-right",floating:true},tooltip:{style:{width:"auto",borderColor:"#ccc"},formatter:this.lineChartTooltipFormatter}};T.each(a.items[0],function(c){b.xAxis[0].data.push(c[0])});b.chartConfig={containerId:a.containerId||"FlashContainer",itemStyle:{normal:{dotStyle:{borderWidth:2,radius:2,hasHollow:true}},emphasis:{dotStyle:{borderWidth:2,radius:2,color:"#f6716f",hasHollow:true}}}};return b},detectLineChartDataFeature:function(b){var a={};if(b.fields[b.fields.length-1].indexOf("ratio_")===0){a.withRatio=true;a.indicatorSubdivided=true}else{a.indicatorSubdivided=this.getLineChartIndicatorMetaData(b.fields[b.fields.length-1])?false:true}if(b.timeSpan.length>1){a.dateCompared=true;a.singleIndicator=true}else{a.dateCompared=false;if(b.fields.length===3&&!a.indicatorSubdivided){a.singleIndicator=false}else{a.singleIndicator=true}}if(b.items[0].length===0){a.noData=true}return a},getLineChartIndicatorMetaData:function(b){var a=null;T.array.some(T.config.indexInfo.flashIndicators,function(c){if(c.id===b){a=c;return true}});return a},lineChartTooltipFormatter:function(k,b,g,f){var d=[];var h=b[0].tooltipTitle||g[f];d.push('<p style="margin: 5px;font-weight: 600;">');if(b[0].needSubtitle){h+=": "+g[f]}d.push(h);d.push("</p>");d.push('<table style="margin: 5px">');for(var c=0;c<b.length;c++){if(!k[c].isHidden){var e=b[c];var a=k[c]&&k[c].color||"#000";var j;d.push('<tr><td style="color:'+a+'">'+e.name+":</td>");if(e.tooltipData){j=e.tooltipData[f];d.push('<td style="padding-left: 16px; text-align: right">'+j[0]+'</td><td style="padding-left: 10px; padding-right: 10px; color: #ccc; text-align: center">|</td><td>'+j[1]+"</td>")}else{j=hmcharts.util.format.format(e.data[f],e.dataType);d.push('<td style="padding-left: 16px;">'+j+"</td>")}d.push("</tr>")}}d.push("</table>");return d.join("")},getYAxisConfig:function(b){var a={type:"value",position:"left",axisLine:false,axisTick:false,axisLabel:{format:"{value}",dynamicAdjust:true,shareSuffix:true}};if(typeof b==="object"){a=T.extend(a,b)}else{a.axisLabel.dataType=b==="时长"?"time":undefined;a.axisLabel.format="{value}"+(b==="时长"?"":b)}return a},getDataType:function(a){switch(a){case"%":return"ratio";case"时长":return"time";default:return"number"}},hanldeDuplicatedLabels:function(f){var d=f.labelSuffixes;var b=f.fields;for(var g=1,c=b.length;g<c-2;g=g+2){var a=0;for(var e=g+2;e<c;e=e+2){var h=d[(e-1)/2].split("-")[0];if(b[g]===b[e]){b[e]+="("+h+")";b[e+1]+="("+h+")";a++}}if(a){h=d[(g-1)/2].split("-")[0];b[g]+="("+h+")";b[g+1]+="("+h+")"}}},convertFlashPieDataFormat:function(n){var j=n.flashId,f=n.fields,h=n.items;var a=["label","value","ratio"],m=[],b=[];var d=h[0],k=h[1];if((d==null||d.length==0)||(k==null||k.length==0)){this._showErrorTip(j);return}for(var e=1,c=f.length;e<c;e++){if(/^ratio/i.test(f[e])){b.push(e-1)}}for(var e=0,c=b.length;e<c;e++){var g=b[e];T.array.each(k,function(i){i[g]=i[g]+"%"})}T.array.each(d,function(o,l){m.push(o.concat(k[l]))});return{flashId:j,type:n.type,units:this._getUnits([n.indicator]),indicator:this._getIndicatorLabel(n.indicator),fields:a,items:m}},convertFlashLinePieDataFormat:function(c){var s=c.flashId,h=c.line,f=h.fields,t=h.items,k=c.pie,a=k.fields,e=k.items,g=[];var n=["label"],d=[];var m=t[0],r=t[1];if((m==null||m.length==0)||(r==null||r.length==0)){this._showErrorTip(s);return}for(var p=1,o=f.length;p<o;p++){n.push(f[p])}T.array.each(m,function(u,l){d.push(u.concat(r[l]))});this._addLineTip(c,n,d,"SmallTip",g);var b=["label","value"],q=[];var j=e[0],r=e[1];T.array.each(j,function(u,l){q.push(u.concat(r[l]))});return{flashId:s,type:c.type,units:this._getUnits([c.indicator]),highlightIndexs:g,indicator:this._getIndicatorLabel(c.indicator),bar:c.bar,line:{fields:n,items:d},pie:{fields:b,items:q}}},convertFlashCircleGraphDataFormat:function(d){var e=d.flashId,a=d.fields,b=d.items;var f=["label","dataB","dataL","dataR"],h=[];var c=b[0],g=b[1];if((c==null||c.length==0)||(g==null||g.length==0)){this._showErrorTip(e);return}T.array.each(c,function(k,j){h.push(k.concat(g[j]))});return{flashId:e,fields:f,items:h,type:d.type}},convertFlashBarDataFormat:function(a){var b=a.flashId,e=[];var f=this._convertFlashDataFormat(a);var c=f.flashFields,d=f.flashItems;return{flashId:b,fields:c,units:this._getUnits(a.fields),items:d,type:a.type,highlightIndexs:e,indicator:this._getIndicatorLabel(a.indicator)}},convertFlashCircleDataFormat:function(n){var j=n.flashId,f=n.fields,h=n.items;var a=["label","value","ratio"],m=[],b=[];var d=h[0],k=h[1];if((d==null||d.length==0)||(k==null||k.length==0)){this._showErrorTip(j);return}for(var e=1,c=f.length;e<c;e++){if(/^ratio/i.test(f[e])){b.push(e-1)}}for(var e=0,c=b.length;e<c;e++){var g=b[e];T.array.each(k,function(i){i[g]=i[g]+"%"})}T.array.each(d,function(o,l){m.push(o.concat(k[l]))});return{flashId:j,fields:a,units:this._getUnits(f),items:m,type:n.type,indicator:this._getIndicatorLabel(n.indicator)}},convertFlashAreaPieDataFormat:function(a){return this.convertFlashAreaDataFormat(a)},convertFlashWorldMapDataFormat:function(a){return this.convertFlashAreaDataFormat(a)},convertFlashAreaDataFormat:function(s){var p=s.flashId,h=s.fields,n=s.items;var a=["label","value","ratio","color"],q=[];var c=n[0],r=n[1],o=n[2];if((c==null||c.length==0)||(r==null||r.length==0)){this._showErrorTip(p);return}T.array.each(c,function(t,l){q.push(t.concat(r[l]))});var e=0,j=1;for(var f=0,b=q.length;f<b;f++){var r=q[f],m=r[r.length-1];e=Math.max(e,m);j=Math.min(j,m)}var k=(e-j)/5,g=[e,e-k,e-k*2,e-k*3,e-k*4,j];for(var f=0,b=q.length;f<b;f++){var r=q[f],m=r[r.length-1],d;r[r.length-1]=r[r.length-1]+"%";if(m<=g[0]&&m>g[1]){d="0x1556a1"}else{if(m<=g[1]&&m>g[2]){d="0x136bd4"}else{if(m<=g[2]&&m>g[3]){d="0x6c98d5"}else{if(m<=g[3]&&m>g[4]){d="0x9fccff"}else{d="0xdcecff"}}}}r.push(d)}return{flashId:p,fields:a,units:this._getUnits(h),items:q,type:s.type,indicator:this._getIndicatorLabel(s.indicator)}},convertFlashLineDataFormat:function(a){var b=a.flashId,g=a.timeSpan,e=[],h=a.tipLabel||"BigTip";var f=this._convertFlashDataFormat(a);var c=f.flashFields,d=f.flashItems;this._addLineTip(a,c,d,h,e);return{flashId:b,fields:c,units:this._getUnits(a.fields,a.items[2]?a.items[2].length:0),items:d,type:a.type,highlightIndexs:e,indicator:this._getIndicatorLabel(a.indicator)}},_addLineTip:function(a,b,d,e,c){if(a.by=="hour"){b.push(b[0]+e);T.array.each(d,function(f){var g=T.config.lineChartDayTimeMap[f[0]];if(g){f.push(g)}else{f.push(f[0])}});T.array.each(d,function(g,f){if(f==d.length-1){g[0]=f+"/点"}else{g[0]=f}})}else{if(a.by=="day"){b.push(b[0]+e);T.array.each(d,function(g,f){T.array.each(g,function(n,l){if(l>0){return}var o=false,h;var k=T.config.holidays;for(var m in k){if(k.hasOwnProperty(m)){h=k[m];if(h.test(n)){this.push(n+" ("+m+")");c.push(f);o=true;break}}}if(!o){var h=new RegExp("^\\d+(\\-|\\/)\\d+(\\-|\\/)\\d+\x24");if(h.test(n)){var i=new Date(n),p=i.getDay(),q;switch(p){case 0:q=n+" (星期日) ";break;case 6:q=n+" (星期六) ";break;default:q=n;break}this.push(q);if(p==0||p==6){c.push(f);o=true}}}})})}}},_filterFlashData:function(d){var a=d.fields,c=d.items;var f=c[1],g=c[2];var b=new T.Indicator({indicators:T.config.indexInfo.flashIndicators});var e=b.map(a);T.array.each(e,function(j,h){if(j){T.array.each(f,function(k,i){k[h-1]=j.format(k[h-1])});T.array.each(g,function(k,i){k[h-1]=j.format(k[h-1])})}})},_convertFlashDataFormat:function(c){var t=c.flashId,r=c.timeSpan,k=c.fields,j=c.items,g=c.tipLabel||"BigTip";var m=j[0],s=j[1],a=j[2];var d=[],p=[],n=[];if((m==null||m.length==0)||(s==null||s.length==0)){this._showErrorTip(t,c);return{flashFields:[],flashItems:[]}}d.push("label");var e=new T.Indicator({indicators:T.config.indexInfo.flashIndicators});var h=e.map(k);if(!a||a.length==0){for(var q=1,o=h.length;q<o;q++){if(h[q]){d.push(h[q].label)}else{if(/^ratio/i.test(k[q])){d.push(d[d.length-1]+g);n.push(q-1)}else{d.push(k[q])}}}T.array.each(s,function(i){T.array.each(i,function(v,l){if(T.array.contains(n,l)){if(h[l]){i[l]=h[l].format(i[l-1])+" | 占比: "+T.i18n.number.formatRatio(i[l])}else{i[l]=T.i18n.number.formatNumber(i[l-1])+" | 占比: "+T.i18n.number.formatRatio(i[l])}}else{var u=h[l+1];if(u&&!T.array.contains(k,"ratio_"+u.id)){if(!T.array.contains(d,d[l+1]+g)){d.push(d[l+1]+g)}i.push(u.format(i[l]))}}})});T.array.each(m,function(u,l){p.push(u.concat(s[l]))})}else{T.array.each(k,function(u,l){if(/^ratio/i.test(u)){n.push(l-1)}});T.array.each(r,function(i){d.push(i);d.push(i+g)});T.array.each(s,function(i){T.array.each(i,function(v,l){if(l==0){return}if(T.array.contains(n,l)){if(h[l]){i[l]=h[l].format(i[l-1])+" | 占比: "+T.i18n.number.formatRatio(i[l])}else{i[l]=T.i18n.number.formatNumber(i[l-1])+" | 占比: "+T.i18n.number.formatRatio(i[l])}}else{var u=h[l+1];if(u&&!T.array.contains(k,"ratio_"+u.id)){i.push(u.format(i[l]))}}})});T.array.each(a,function(i){T.array.each(i,function(v,l){if(l==0){return}if(T.array.contains(n,l)){if(h[l]){i[l]=h[l].format(i[l-1])+" | 占比: "+T.i18n.number.formatRatio(i[l])}else{i[l]=T.i18n.number.formatNumber(i[l-1])+" | 占比: "+T.i18n.number.formatRatio(i[l])}}else{var u=h[l+1];if(u&&!T.array.contains(k,"ratio_"+u.id)){i.push(u.format(i[l]))}}})});if(c.by=="hour"){var b=T.array.map(T.object.clone(s),function(i){T.array.removeAt(i,0);return i});var f=T.array.map(T.object.clone(a),function(i){T.array.removeAt(i,0);return i});T.array.each(m,function(u,l){p.push(u.concat(b[l],f[l]))})}else{var f=T.array.map(T.object.clone(a),function(i){T.array.removeAt(i,0);return i});T.array.each(s,function(u,l){p.push(s[l].concat(f[l]))})}}T.each(d,function(l,i){d[i]=this._encodeHTML(l)},this);return{flashFields:d,flashItems:p}},_showErrorTip:function(b,a){var c=T.swf.getMovie(b);c.showErrorTip("暂无数据");this.options.onflashError(b,a)},_getIndicatorLabel:function(b){if(!b){return}var a=b.split(","),c=[];T.array.each(a,function(e){var d=T.array.find(T.config.indexInfo.flashIndicators,function(f,g){return e==f.id});if(d){c.push(d.label)}});return c.join()},_getUnits:function(a,d){var c=T.array.map(a,function(e){return T.array.find(T.config.indexInfo.flashIndicators,function(f){return e==f.id})});var b=[];T.array.each(c,function(e){if(e){var f=e.unit;if(!T.array.contains(b,f)){b.push(f)}}});if(d&&d!=0){b=b.concat(b)}return b},_encodeHTML:function(a){return String(a).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}});T.DateCompare=T.createClass({options:{containerId:"FlashTimeCompare",onchange:function(){},isComparable:0,checkedId:null,date:null},_checkedId:null,params:{},_init:function(){this._checkedId=this.options.checkedId;var j=T.g(this._checkedId);if(j){j.checked=true}var a=T.g(this.options.containerId);if(a){var f=a.getElementsByTagName("input");T.event.ons(f,"click",this._onchange())}var k=T.g("DateSelectBar");if(k){var h=k.getElementsByTagName("a");for(var d=0,b=h.length;d<b;d++){var c=h[d];if(c.className.indexOf("cur")!=-1){var g=c.href.indexOf("#");if(g!=-1){var e=parseInt(c.href.substring(g+1,c.href.length));if(e==0||e==-1){this.params.st=this.params.et=parseInt(T.config.systemConfig.now)+e*3600*24*1000;this.show(this.params.st)}else{this.hide()}break}}if(T.config.pageInfo&&T.config.pageInfo.st&&T.config.pageInfo.st!=T.config.pageInfo.et){this.hide()}}}},_onchange:function(){var a=this;return function(){var d=this.id,b=a._checkedId;if(!b){a._checkedId=d}else{var c=T.g(b);if(b!=d){c.checked=false;a._checkedId=d}else{a._checkedId=null}}a._handleParams();a.options.onchange(a.params,a.options.isComparable)}},checkComparation:function(a){var c=T.g(this.options.containerId);if(c){switch(a){case 0:this._checkedId="LastDay";break;case 1:this._checkedId="LastWeek";break;case 2:this._checkedId="LastMonth";break;default:this._checkedId=null}var b=c.getElementsByTagName("input");for(var d=0,e=b.length;d<e;d++){b[d].checked=(d==a)}}},hide:function(){var a=T.g(this.options.containerId);if(a){a.style.display="none";this.params.st2=null;this.params.et2=null;this.options.isComparable=0}},show:function(c,b){var a=T.g(this.options.containerId);if(a){var f=T.date.format(new Date(c),"yyyy-MM-dd");c=T.date.parse(f);this.options.date=c.getTime();if(!b){this._handleParams()}else{var e=baidu.G("DateSelectBar").getElementsByTagName("A");if(this.params.st2+1000*3600*24==this.params.st){this.checkComparation(0)}else{if(this.params.st2+1000*3600*24*7==this.params.st){this.checkComparation(1)}else{if(this.params.st2+1000*3600*24*30==this.params.st){this.checkComparation(2)}else{this.checkComparation()}}}}a.style.display="block"}},_handleParams:function(){var a=this.options.date;var d=T.g("LastDay");var c=T.g("LastWeek");var b=T.g("LastMonth");if(d&&d.checked){this.params.et2=this.params.st2=a-3600*24*1000;this.options.isComparable=1}else{if(c&&c.checked){this.params.et2=this.params.st2=a-7*3600*24*1000;this.options.isComparable=1}else{if(b&&b.checked){this.params.et2=this.params.st2=a-30*3600*24*1000;this.options.isComparable=1}else{this.options.isComparable=0;this.params.st2=null;this.params.et2=null}}}},setDate:function(a){var b=T.date.format;this.params.st=new Date(b(new Date(a.st),"yyyy/MM/dd")).getTime();this.params.et=new Date(b(new Date(a.et),"yyyy/MM/dd")).getTime();if(a.st2){this.params.st2=new Date(b(new Date(a.st2),"yyyy/MM/dd")).getTime()}else{this.params.st2=null}if(a.et2){this.params.et2=new Date(b(new Date(a.et2),"yyyy/MM/dd")).getTime()}else{this.params.et2=null}},checked:function(){return T.g("LastDay").checked||T.g("LastWeek").checked||T.g("LastMonth").checked}});function DateController(a){this.prefix=a.prefix||"";this.dateSelectBar=a.container||this.prefix+"ControlBar";this.singleSelection=a.singleSelection||false;this.alwaysCompare=a.alwaysCompare||false;this.calendarCount=a.calendarCount||3;var b=getUniqueId();this.calendarContainerId="calendarContainer"+b;this.maskIframeId="Iframe"+b;this.calendarContainerClass=a.calendarContainerClass||"calendar-box";this.toolTipClass=a.toolTipClass||"date-select-tip";this.btnBarClass=a.toolTipClass||"button-bar";this.onchange=a.onchange||{};this.compareChange=a.compareChange||{};this.startDate=a.startDate||new Date(1970,1,1);this.endDate=a.endDate||new Date();this.otherStartDate=a.otherStartDate||null;this.otherEndDate=a.otherEndDate||null;this.todayDate=a.todayDate||new Date();this.firstDate=a.firstDate||new Date(1970,1,1);this.dateCompare=false;this.msg="";this.dateSelector=null;this.diff;this.selected={};this.init()}DateController.prototype={tpl:'<iframe src="about:blank" frameborder="0" scrolling="no" id="#{maskIframeId}"></iframe><div></div><div class="#{toolTipClass}"></div><div class="#{btnBarClass}"><input type="hidden"><a class="button" href="javascript:void(0)">确定</a><a href="javascript:void(0)">取消</a></div>',init:function(){var a=baidu.G(this.prefix+"DateSelectBar").getElementsByTagName("A");T.event.ons(a,"click",this.selectHandle());this.createCalendarContainer();this.createCalendar();this.initInputDate();this.initShortcutDate();this.bindHandle();this.showDateTip();this.hideDateBoxFn=this.hideDateBoxHandle()},bindHandle:function(){var a=T.g(this.dateSelectBar);var f=T.g(this.calendarContainerId);T.on(this.prefix+"DateSelect","click",this.showDateBox(0));T.g(this.prefix+"CompareDate")&&T.on(this.prefix+"CompareDate","click",this.showDustDateInput());T.g(this.prefix+"CompareDateSelect")&&T.on(this.prefix+"CompareDateSelect","click",this.showDateBox(2));baidu.on(f,"click",function(g){T.event.stopPropagation(g)});var c=f.getElementsByTagName("INPUT");var b=T.dom.next(c[0]);var e=T.dom.next(b);T.on(b,"click",this.submitDateSelect());T.on(e,"click",this.hideDateBoxHandle());var d=this;if(T.g(this.prefix+"Scroll")){T.on(this.prefix+"Scroll","click",function(g){T.dom.toggleClass(this,"open");T.dom.toggleClass(this,"close");if(!T.dom.hasClass(this,"open")){T.removeClass(d.prefix+"ControlBar","date-controll-bar-scroll");T.setStyle(d.prefix+"ControlBar","width","100%")}});T.on(window,"scroll",T.fn.bind(this.dateScrollHandler,this));T.on(window,"resize",T.fn.bind(this.dateScrollHandler,this))}},dateScrollHandler:function(){var b=T.dom.getPosition(this.prefix+"ControlBarWrapper");var a=T.g(this.prefix+"Scroll");if(a&&!T.dom.hasClass(a,"open")){return}var d=document.documentElement.scrollTop+document.body.scrollTop,e=document.documentElement.scrollLeft+document.body.scrollLeft;var c=T.g(this.prefix+"ControlBar");if(d>b.top){T.addClass(c,"date-controll-bar-scroll");T.setStyles(c,{top:d-b.top,width:T.q("main")[0].offsetWidth+"px"})}else{T.removeClass(c,"date-controll-bar-scroll");T.setStyle(c,"width","100%")}T.hide(this.calendarContainerId)},showDustDateInput:function(){var a=this;return function(b){T.event.stopPropagation(b);if(this.checked){a.showInput();a.showDateBox(2).call(this,b)}else{a.hideInput();a.otherStartDate=null;a.otherEndDate=null;a.msg="";a.initInputDate();a.onchange(this.id)}}},submitDateSelect:function(){var a=this;return function(){var c=a.selected.from;var b=a.selected.to;if(a.dateCompare){a.otherStartDate=c;a.otherEndDate=b}else{a.startDate=c;a.endDate=b}a.currentSubmit=true;a.showDateTip();a.initShortcutDate();a.hideDateBoxFn();a.onchange("submitDateSelect")}},hideDateBoxHandle:function(){var a=this;return function(){baidu.un(document,"click",a.hideDateBoxFn);baidu.hide(a.calendarContainerId);a.initInputDate()}},showDateBox:function(a){var b=this;return function(l){T.event.stop(l);b.msg="";b.currentIndex=a;var s=baidu.date.format;var j=baidu.date.parse;var d=T.g(b.calendarContainerId);var t=baidu.dom.getPosition;b.dateCompare=(a==2)?true:false;b.diff=(a==2)?b.dateDiff(b.startDate,b.endDate):0;d.style.display="block";b.dateSelector.clickState="from";var q=(a==2)?b.otherStartDate:b.startDate;var r=(a==2)?b.otherEndDate:b.endDate;b.selected.from=q;b.selected.to=r;if(q){q=new Date(s(q,"yyyy/MM/dd")).getTime();r=new Date(s(r,"yyyy/MM/dd")).getTime();b.dateSelector.setSelected({from:q,to:r})}else{b.dateSelector.setSelected({})}var m=T.g(b.prefix+"DateSelect");var c=T.g(b.prefix+"CompareDateSelect");if(b.dateCompare){m=c;c=T.g(b.prefix+"DateSelect")}T.dom.addClass(m,"selected");T.dom.removeClass(m,"combobox-disabled");c&&T.dom.removeClass(c,"selected");var i=(a==2&&b.calendarCount==3)?-150:0;var g=20;var o=t(m).left+i;var n=t(m).top+g;d.style.top=n+"px";d.style.left=o+"px";baidu.on(document,"click",b.hideDateBoxFn);if(baidu.ie==6){var f=T.g(b.maskIframeId);f.style.display="block";var k=d.offsetHeight;var p=d.offsetWidth;f.style.height=(k-5)+"px";f.style.width=p+"px"}}},initInputDate:function(){var c=baidu.G(this.dateSelectBar);var h=c.getElementsByTagName("INPUT");var a=T.g(this.prefix+"DateSelect");var k=baidu.date.format;var l=k(this.startDate,"yyyy/MM/dd");var j=k(this.endDate,"yyyy/MM/dd");var d=(l==j)?j:l+" - "+j;T.dom.one(".text",a).innerHTML=d;T.dom.removeClass(a,"selected");if(this.otherStartDate&&this.otherStartDate.constructor==Date){var g=Math.abs(this.dateDiff(this.startDate,this.endDate));var f=Math.abs(this.dateDiff(this.otherStartDate,this.otherEndDate));if(f!=g){this.otherEndDate=new Date(this.otherStartDate.getTime()+g*3600*24*1000)}this.showInput();var e=k(this.otherStartDate,"yyyy/MM/dd");var b=k(this.otherEndDate,"yyyy/MM/dd");var i=T.g(this.prefix+"CompareDateSelect");i&&(T.dom.one(".text",i).innerHTML=(e==b)?b:e+" - "+b);i&&T.dom.removeClass(i,"selected")}else{this.hideInput()}this.showDateTip()},initShortcutDate:function(){var a=baidu.G(this.dateSelectBar);var o=a.getElementsByTagName("A");var d=o.length;var g=this.endDate;var b=this.startDate;var p=this.todayDate;var c=new Date(+T.config.systemConfig.now);this.removeClass();var m=this.dateDiff;var k=m(g,p);var e=m(b,g);var f=e;var f=Number.MAX_VALUE;if(k==-1&&e==0){f=-1}if(k==0&&e!=-1){f=e}for(var h=0,d=o.length;h<d;h++){var l=o[h].href.indexOf("#");if(l!=-1){var j=parseInt(o[h].href.substr(l+1));if(j==f){T.dom.addClass(o[h],"cur");break}}}},showInput:function(){var a=T.g(this.prefix+"CompareDateSelect");if(a&&this.alwaysCompare){if(this.currentIndex==2&&this.currentSubmit){T.g(this.prefix+"CompareDate")&&(T.g(this.prefix+"CompareDate").checked=true);a&&(a.style.display="");a&&T.dom.addClass(a,"cur");a&&T.dom.removeClass(a,"combobox-disabled")}}else{T.g(this.prefix+"CompareDate")&&(T.g(this.prefix+"CompareDate").checked=true);a&&(a.style.display="");a&&T.dom.addClass(a,"cur");a&&T.dom.removeClass(a,"combobox-disabled")}this.currentIndex=null;this.currentSubmit=null},hideInput:function(){var a=T.g(this.prefix+"CompareDateSelect");T.g(this.prefix+"CompareDate")&&(T.g(this.prefix+"CompareDate").checked=false);a&&T.dom.removeClass(a,"cur");a&&T.dom.addClass(a,"combobox-disabled");a&&(T.dom.one(".text",a).innerHTML="与其他时间段对比")},disableInput:function(){T.g(this.prefix+"CompareDate").checked=false;T.g(this.prefix+"CompareDate").style.display="none";var a=T.g(this.prefix+"CompareDateSelect");T.dom.removeClass(a,"cur");T.dom.addClass(a,"combobox-disabled");a.style.display="none"},enableInput:function(){T.g(this.prefix+"CompareDate").style.display="inline";T.g(this.prefix+"CompareDateSelect").style.display="inline"},createCalendar:function(){var c=baidu.G(this.calendarContainerId);var b=c.getElementsByTagName("DIV");var e=b[1];var h=this.todayDate;var d=this.firstDate;var f=this.todayDate.getTime();var a=3600*24*1000;var i=baidu.date.format;var g=this;this.dateSelector=new DateSelector({calendarCount:this.calendarCount,singleSelection:this.singleSelection,autoFill:0,onviewchange:function(k){var j=new Date(f+a*31);j.setDate(1);if(k.to-j>0){return false}},dateStyle:function(j){if(g.dateCompare){var k=g.diff?Math.abs(Math.floor(g.diff))+1:1;if(this.clickState=="to"&&Math.abs(this.selected.from-j)<a*k){return"background:#fbeaa7"}}if(j-h>0||j-d<0){return"color:#999;cursor:default;background:#fff"}if(i(j,"yyyy/MM/dd")==i(h,"yyyy/MM/dd")){return"font-weight:bold; border:1px solid #a7aebc"}},sideButtonClass:function(j){var k=h;if(j.type=="nextmonth"&&j.to>=new Date(k.getFullYear(),k.getMonth(),1)){return"ds-nextmonth-ed"}}});this.dateSelector.viewDate=new Date(f-a*1);this.dateSelector.onselect=function(j){var m=j.from;var l=j.to;if(h-l<0){e.style.display="block";e.innerHTML="您所选日期内暂无数据，请重新选择。";return false}if((l-d)<0||(m-d)<0){return false}var k=(l-m)/a;if(k>366){e.style.display="block";e.innerHTML="非常抱歉，时间范围查询不能超出366天!";myDateSelector.clickState="from";return false}e.innerHTML="";g.selected=j;g.onSelect()};T.dom.empty(b[0]);this.dateSelector.appendTo(b[0])},onSelect:function(){var d=baidu.date.format;var b=this.selected;var e=this.dateCompare?T.g(this.prefix+"CompareDateSelect"):T.g(this.prefix+"DateSelect");var c=d(b.from,"yyyy/MM/dd");var a=d(b.to,"yyyy/MM/dd");T.dom.one(".text",e).innerHTML=(c==a)?a:c+" - "+a;T.dom.addClass(e,"cur");T.dom.removeClass(e,"combobox-disabled");if(!T.g(this.prefix+"CompareDateSelect")){T.dom.addClass(this.prefix+"DateSelect","mt")}},createCalendarContainer:function(){var a=document.createElement("DIV");a.id=this.calendarContainerId;a.className=this.calendarContainerClass;a.innerHTML=baidu.format(this.tpl,{maskIframeId:this.maskIframeId,toolTipClass:this.toolTipClass,btnBarClass:this.btnBarClass});document.body.appendChild(a)},selectHandle:function(){var a=this;return function(g){T.event.preventDefault(g);a.msg="";var h=this.href.lastIndexOf("#")+1;var d=parseInt(this.href.substring(h),10);if(d!=0){var b=(b==-1)?-1:d;a.startDate=new Date(a.recentDate(b));var f=(d==-1)?d:0;a.endDate=new Date(a.recentDate(f))}else{var c=a.todayDate;a.startDate=c;a.endDate=c}if(!a.alwaysCompare){a.otherStartDate=null;a.otherEndDate=null;if(T.g(a.prefix+"CompareDateSelect")){T.removeClass(a.prefix+"CompareDateSelect","cur");T.addClass(a.prefix+"CompareDateSelect","combobox-disabled")}}a.initInputDate();a.removeClass();T.dom.addClass(this,"cur");T.removeClass(a.prefix+"DateSelect","cur");T.dom.removeClass(a.prefix+"DateSelect","mt");a.showDateTip();a.onchange()}},removeClass:function(){var b=baidu.G(this.dateSelectBar).getElementsByTagName("A");for(var a=0,c=b.length;a<c;a++){T.removeClass(b[a],"cur")}},dateDiff:function(b,a){b.setHours(0);b.setMinutes(0);b.setSeconds(0);b.setMilliseconds(0);a.setHours(0);a.setMinutes(0);a.setSeconds(0);a.setMilliseconds(0);return parseInt((b-a)/1000/60/60/24,10)},recentDate:function(a){return this.todayDate.getTime()+a*3600*24*1000},showDateTip:function(){var e=baidu.G(this.prefix+"Date");var h=baidu.date.format;var f=baidu.dom.next;var c=this.otherStartDate&&this.otherStartDate.constructor==Date?true:false;var b=h(this.startDate,"yyyy/MM/dd");var g=h(this.endDate,"yyyy/MM/dd");var d=(b==g)?b:(b+"~"+g);if(c){var a=h(this.otherStartDate,"yyyy/MM/dd");var i=h(this.otherEndDate,"yyyy/MM/dd");var j=(a==i)?a:(a+"~"+i);if(e){e.innerHTML="("+d+"与"+j+")"}}else{if(e){e.innerHTML="("+d+")"}}T.dom.one(".report-help")&&(T.dom.setStyle(T.dom.one(".tip-arrow"),"left",(T.dom.one(".report-help").offsetLeft+2)+"px"))},setDate:function(a,b){this.startDate=a;this.endDate=b;this.initInputDate();this.onchange("submitDateSelect");this.initShortcutDate()},setCompareDate:function(a,b){this.showInput();this.otherStartDate=new Date(a);this.otherEndDate=new Date(b);this.initInputDate()},hideCompareDate:function(){this.hideInput();this.otherStartDate=null;this.otherEndDate=null},disableCompareDate:function(){this.disableInput();this.otherStartDate=null;this.otherEndDate=null},enableCompareDate:function(){this.enableInput()}};T.ui.DatePicker=T.createUI({_type:"datepicker",options:{containerId:null,calendarContainerId:null,defaultText:"自定义时间段",singleSelection:false,maxSelectDays:null,calendarCount:2,toolTipClass:"date-select-tip",btnBarClass:"button-bar",calendarContainerClass:"calendar-box",onchange:T.fn.blank,onshow:T.fn.blank,onhide:T.fn.blank,onselect:T.fn.blank,oninit:T.fn.blank,setDateText:function(c,b){var a=T.g(this.options.containerId);T.dom.one(".text",a).innerHTML=(c==b)?c:c+" - "+b},startDate:null,endDate:null,todayDate:new Date(),firstDate:new Date(1970,1,1),lastDate:new Date()},calendarContainerId:"calendarContainer",tpl:'<iframe src="about:blank" frameborder="0" scrolling="no" id="#{maskIframeId}"></iframe><div class="date-calendar-body"></div><div class="#{toolTipClass}"></div><div class="#{btnBarClass}"><a class="button" href="javascript:void(0)">确定</a><a href="javascript:void(0)">取消</a></div>',_init:function(){var a=this;this.selected={};if(this.options.calendarContainerId){this.dateBox=T.g(this.options.calendarContainerId);T.dom.addClass(this.dateBox,this.options.calendarContainerClass)}if(this.dateBox){this.eventHandle=this.showDateBox2()}else{this.eventHandle=this.showDateBox()}this.hideDateBoxFn=this.hideDateBoxHandle();this.submitDateSFn=this.submitDateSelect();this.initInputDate();T.event.on(this.options.containerId,"click",this.eventHandle);this.options.oninit.call(this)},setDate:function(a,b){this.options.startDate=a;this.options.endDate=b;this.initInputDate();this.options.onchange.call(this,"submitDateSelect")},set:function(a,b){if(!a){return}if(typeof a=="string"){this.options[a]=b}else{if(typeof a=="object"){T.extend(this.options,a)}}},_create:function(d){if(!this.options.calendarContainerId){T.event.fire(document.body,"click")}this._createCalendar(d);if(d){this.hideDateBoxFn&&this.hideDateBoxFn()}else{d=T.g(this.calendarContainerId);T.on(document,"click",this.hideDateBoxFn)}var c=T.dom.one("."+this.options.btnBarClass,d);if(c){var a=T.dom.one(".button",c);var b=T.dom.next(a);T.on(a,"click",this.submitDateSFn);T.on(b,"click",this.hideDateBoxFn)}},_destroy:function(){T.un(document,"click",this.hideDateBoxFn);var d=this.dateBox||T.g(this.calendarContainerId);if(d){var c=T.dom.one("."+this.options.btnBarClass,d);if(c){var a=T.dom.one(".button",c);var b=T.dom.next(a);T.un(a,"click",this.submitDateSFn);T.un(b,"click",this.hideDateBoxFn)}this.dateBox||T.hide(d)}},_createCalendarContainer:function(){var b=this,a=b.options;var c=document.createElement("DIV");c.id=this.calendarContainerId;c.className=a.calendarContainerClass;c.innerHTML=baidu.format(this.tpl,{maskIframeId:"mask-iframe",toolTipClass:a.toolTipClass,btnBarClass:a.btnBarClass});document.body.appendChild(c);T.event.on(c,"click",function(d){T.event.stopPropagation(d)});return c},_createCalendar:function(d){if(!d){d=T.g(this.calendarContainerId)||this._createCalendarContainer()}var c=T.dom.query(".date-calendar-body",d);this.showMessage();var g=this,b=this.options;var h=b.todayDate;var e=b.firstDate;var j=b.lastDate;var f=b.todayDate.getTime();var a=3600*24*1000;var i=baidu.date.format;this.dateSelector=new DateSelector({calendarCount:b.calendarCount,singleSelection:b.singleSelection,autoFill:0,onviewchange:function(l){var k=new Date(f+a*31);k.setDate(1);if(l.to-k>0){return false}},dateStyle:function(k){if((j&&(k-j>0))||k-e<0){return"color:#999;cursor:default;background:#fff"}if(i(k,"yyyy/MM/dd")==i(h,"yyyy/MM/dd")){return"font-weight:bold; border:1px solid #a7aebc"}},byWeekStyle:function(l){var k=new Date(l.getFullYear(),l.getMonth(),l.getDate()-6);if(k-e<0||(j&&(l-j)>0)){return"color:#999;cursor:default;background:#fff"}},byMonthStyle:function(k){if((k-e<0)||(j&&(k-j)>0)){return"color:#bcbcbc;cursor:default;background:#e9e9e9"}},sideButtonClass:function(k){var l=j;if(k.type=="nextmonth"&&k.to>=new Date(l.getFullYear(),l.getMonth(),1)){return"ds-nextmonth-ed"}}});this.dateSelector.viewDate=new Date(f-a*1);this.dateSelector.onselect=function(l,k){var o=l.from;var n=l.to;if(j&&(j-n<0)){g.showMessage("超出时间范围，请重新选择。");return false}if((n-h)>0||(n-e)<0||((o-e)<0&&k!==3)){g.showMessage("您所选日期内暂无数据，请重新选择。");return false}var m=(n-o)/a;if(m>366){g.showMessage("查询范围不能超出366天!");return false}else{if(typeof b.maxSelectDays=="number"&&m>b.maxSelectDays-1){g.showMessage("非常抱歉，时间范围查询不能超出"+b.maxSelectDays+"天!");return false}}g.showMessage();g.selected=l;g.onSelect()};T.dom.empty(c[0]);this.dateSelector.appendTo(c[0])},showMessage:function(c){var b=this.dateBox;if(!this.dateBox){b=T.g(this.calendarContainerId)}var a=T.dom.query("."+this.options.toolTipClass,b)[0];if(a){a.style.display="block";a.innerHTML=c||""}},showDateBox:function(){var b=this,a=b.options;return function(h){T.event.stop(h);b._create();b.msg="";var n=baidu.date.format;var g=baidu.date.parse;var c=T.g(b.calendarContainerId);var o=baidu.dom.getPosition;c.style.display="block";b.dateSelector.clickState="from";var l=a.startDate;var m=a.endDate;b.selected.from=l;b.selected.to=m;if(l){l=new Date(n(l,"yyyy/MM/dd")).getTime();m=new Date(n(m,"yyyy/MM/dd")).getTime();b.dateSelector.setSelected({from:l,to:m})}else{b.dateSelector.setSelected({})}var i=this;T.dom.addClass(i,"selected");var f=0;var d=20;var k=o(i).left+f;var j=o(i).top+d;c.style.top=j+"px";c.style.left=k+"px";a.onshow.call(b,b.dateSelector)}},showDateBox2:function(){var b=this,a=b.options;return function(d){if(T.dom.hasClass(this,"selected")){return}b._create(b.dateBox);b.msg="";var c=baidu.date.format;b.dateSelector.clickState="from";var h=a.startDate;var g=a.endDate;b.selected.from=h;b.selected.to=g;if(h){h=new Date(c(h,"yyyy/MM/dd")).getTime();g=new Date(c(g,"yyyy/MM/dd")).getTime();b.dateSelector.setSelected({from:h,to:g})}else{b.dateSelector.setSelected({})}var f=this;T.dom.addClass(f,"selected");a.onshow.call(b,b.dateSelector)}},hideDateBoxHandle:function(){var a=this;return function(){a._destroy();a.initInputDate();a.options.onhide.call(a)}},disable:function(){},enable:function(){},initInputDate:function(){var d=this,c=d.options;var b=T.g(c.containerId);var e=baidu.date.format;T.dom.removeClass(b,"selected");if(c.startDate&&c.startDate!=""){var a=e(c.startDate,"yyyy/MM/dd");var f=e(c.endDate,"yyyy/MM/dd");c.setDateText.call(d,a,f)}else{c.setDateText.call(d,c.defaultText,c.defaultText)}},onSelect:function(){var e=this,d=e.options;var b=baidu.G(d.containerId);var c=e.selected;var g=baidu.date.format;var f=g(c.from,"yyyy/MM/dd");var a=g(c.to,"yyyy/MM/dd");d.setDateText.call(e,f,a);d.onselect.call(e,c)},submitDateSelect:function(){var b=this,a=b.options;return function(){var d=b.selected.from;var c=b.selected.to;a.startDate=d;a.endDate=c;b.currentSubmit=true;b.hideDateBoxFn();b.options.onchange.call(b,"submitDateSelect")}},recentDate:function(a){return this.options.todayDate.getTime()+a*3600*24*1000},setDateFormat:function(a){this.dateSelector.setDateFormat(parseInt(a,10))}});function DateSelector(b){this.uniqueId=getUniqueId();b=b||{};this.onselect=b.onselect||new Function();this.singleSelection=b.singleSelection||false;this.onviewchange=b.onviewchange;this.autoFill=b.autoFill;this.byWhat=b.byWhat||5;if(undefined===typeof this.autoFill||this.autoFill===null){this.autoFill=true}this.dateStyle=b.dateStyle||"";this.weekStyle=b.weekStyle||"";this.byWeekStyle=b.byWeekStyle||"";this.byMonthStyle=b.byMonthStyle||"";this.sideButtonStyle=b.sideButtonStyle;this.sideButtonClass=b.sideButtonClass;this.calendarCount=b.calendarCount||2;this.selected=b.selected||null;var a=this.selected?this.selected.to:(new Date());this.viewDate=new Date(a.getFullYear(),a.getMonth(),1);this.clickState="from";this.calWrapIdPrefix=this.uniqueId+"DSCalendarWrap";this.wrapClass="ds-wrap";this.prevClass="ds-prev";this.nextClass="ds-next";this.prevYearClass="ds-prevyear";this.prevMonthClass="ds-prevmonth";this.nextYearClass="ds-nextyear";this.nextMonthClass="ds-nextmonth";this.prevYearId="DSPrevYear";this.prevMonthId="DSPrevMonth";this.nextYearId="DSNextYear";this.nextMonthId="DSNextMonth";this.calWrapClass="ds-cal-wrap";this.calBlankClass="ds-cal-blank";this.calHeadClass="ds-cal-head";this.calHeadSelClass="ds-cal-head-selected";this.dateClass="ds-date-thismonth";this.dateSelectedClass="ds-date-selected";this.dateOtherClass="ds-date-othermonth";this.weekClass="ds-week"}DateSelector.getDateCountByMonth=function(a){var b=new Date(a.getFullYear(),a.getMonth()+1,0);return b.getDate()};DateSelector.prototype={setSelected:function(a){this.selected=(a&&a.from&&a.to)?a:{};this.renderCalendars();this.clickState="from";return this},getSelected:function(){return this.selected},appendTo:function(c){var d=document.createElement("table");var a=document.createElement("tbody");var e=document.createElement("tr");d.className=this.wrapClass;a.appendChild(e);d.appendChild(a);c.appendChild(d);d.onclick=this.getClickHandler();this.renderSide("prev",e);for(var b=0;b<this.calendarCount;b++){var f=document.createElement("td");f.style.verticalAlign="top";f.id=this.calWrapIdPrefix+b;f.className=this.calWrapClass;e.appendChild(f);if(b<this.calendarCount-1){f=document.createElement("td");f.className=this.calBlankClass;e.appendChild(f)}}this.renderSide("next",e);this.renderCalendars();this.appendTo=new Function()},renderSide:function(l,k){var a='<div class="#{yearclass}" id="#{yearId}" sign="#{type}year" style="#{yearstyle}"></div><div class="#{monthclass}" id="#{monthId}" sign="#{type}month" style="#{monthstyle}"></div>';var p=["year","month"],b=["class","style"];var q={styleFn:this.sideButtonStyle||new Function(),classFn:this.sideButtonClass||new Function()};var h={from:new Date(this.viewDate.getFullYear(),this.viewDate.getMonth()-this.calendarCount+1,1),to:this.viewDate};var f={monthstyle:this[l+"MonthStyle"],yearstyle:this[l+"YearStyle"],monthclass:this[l+"MonthClass"],yearclass:this[l+"YearClass"],yearId:this[l+"YearId"],monthId:this[l+"MonthId"]};var o,d,n;for(var g=0;g<p.length;g++){o=p[g];for(var e=0;e<b.length;e++){n=q[b[e]+"Fn"];switch(typeof n){case"function":h.type=l+o;d=n(h);if(d){f[o+b[e]]=d}break;case"string":f[o+b[e]]=n;break}}}var m=this.uniqueId+l+"Side";var c=baidu.G(m);if(!c){if(!k){return}c=document.createElement("td");c.id=m;l=l.toLowerCase();c.style.verticalAlign="top";c.className=this[l+"Class"];k.appendChild(c)}c.innerHTML=baidu.format(a,{type:l,yearclass:f.yearclass,monthclass:f.monthclass,yearstyle:f.yearstyle,monthstyle:f.monthstyle,yearId:f.yearId,monthId:f.monthId})},renderCalendars:function(){for(var b=0;b<this.calendarCount;b++){var a=new Date(this.viewDate.getFullYear(),this.viewDate.getMonth()-this.calendarCount+1+b,1);baidu.G(this.calWrapIdPrefix+b).innerHTML=this.getCalendarHtml(a.getFullYear(),a.getMonth(),b)}},getCalendarHtml:function(k,h,d){var f='<div id="Calendar#{year}#{month}" class="#{clazz}" sign="month" y="#{year}" m="#{month}">#{year}年#{nextmonth}月</div>';var c='<td sign="date" style="#{4}" class="#{3}" y="#{2}" m="#{1}" d="#{0}">#{0}</td>';var l='<table cellpadding="0" cellspacing="0" border="0" class="#{className}"><thead>#{thead}</thead><tbody>#{tbody}</tbody></table>';var e=[];var j=this.byWhat;var g=this.calHeadClass;var b=new Date(k,h,1);var a=new Date(b);a.setMonth(a.getMonth()+1);a.setDate(0);if(this.selected&&b-this.selected.from>=0&&a-this.selected.to<=0){g=this.calHeadSelClass}if(j!==3){e.push(baidu.format(f,{clazz:g,year:k,month:h,nextmonth:(h+1)}),baidu.format(l,{thead:j===5?this.getCalHeadHtml():"",className:this.singleSelection?"single":"",tbody:j===5?this.getCalBodyHtmlByDay(k,h):this.getCalBodyHtmlByWeek(k,h)}))}else{e.push(this.getCalBodyHtmlByMonth(this.viewDate.getFullYear(),d))}return e.join("")},getCalHeadHtml:function(){var d=["日","一","二","三","四","五","六"];var c=[baidu.format('<tr><td style="background:#fff;" class="#{0}"></td>',this.weekClass)];var a="<td>#{0}</td>";for(var b=0;b<7;b++){c.push(baidu.format(a,d[b]))}c.push("</tr>");return c.join("")},getCalBodyHtmlByDay:function(j,u){var s='<td sign="#{3}" style="#{5}" class="#{4}" y="#{2}" m="#{1}" d="#{0}">#{6}</td>';var o='<td class="#{0}" sign="week" style="#{1}"></td>';var h=[];function k(){var i=Array.apply(i,arguments);i.unshift(s);h.push(baidu.format.apply(null,i))}var m=new Date(j,u,1);var x=new Date(j,(u-1),1);var l=DateSelector.getDateCountByMonth(x);var c=DateSelector.getDateCountByMonth(m);var d=0-new Date(j,u,1).getDay();var e,f,v,w,a,b;if(this.dateStyle.constructor==String){a=this.dateStyle}if("function"===typeof this.weekStyle){b=this.weekStyle(new Date(x.getFullYear(),x.getMonth(),l+d+1))||""}var g=T.dom.query(".ds-wrap")[0];if(T.dom.hasClass(g,"ds-wrap-month")){T.dom.removeClass(g,"ds-wrap-month")}h.push("<tr>",baidu.format(o,this.weekClass,b));for(var t=0;d<c;d++,t++){var r="date";if(t>0&&t%7===0){if("function"==typeof this.weekStyle){b=this.weekStyle(new Date(j,u,d+1))||""}h.push("</tr><tr>",baidu.format(o,this.weekClass,b))}if(d<0){e=l+d+1;f=x.getMonth();v=x.getFullYear();w=this.dateOtherClass;if(!this.autoFill){r=""}}else{e=d+1;f=u;v=j;w=this.dateClass;if(this.selected){var n=new Date(v,f,e);if(n-this.selected.from>=0&&n-this.selected.to<=0){w=this.dateSelectedClass}}}if("function"===typeof this.dateStyle&&r){a=this.dateStyle(new Date(v,f,e))||""}k(e,f,v,r,w,(w===this.dateSelectedClass?"":a),(r?e:""))}f=u+1;v=j;if(f>11){f=0;v++}w=this.dateOtherClass;a="";for(var p=t%7,q=p;p>0&&p<7;p++){if(this.autoFill){r="date";e=p-q+1;if("function"===typeof this.dateStyle){a=this.dateStyle(new Date(v,f,e))||""}}else{e="&nbsp;";r=""}k(e,f,v,r,w,a,e)}h.push("</tr>");return h.join("")},getCalBodyHtmlByWeek:function(n,z){var w='<td sign="#{3}" style="#{6}" class="#{4}" y="#{2}" d1="#{0}" d2="#{1}">#{5}</td>';var u='<td class="#{0}" sign="week" style="#{1}"></td>';var q="第#{0}周   #{1}.#{2}-#{3}.#{4}";var m=[];var k=7;function o(){var D=Array.apply(D,arguments);D.unshift(w);m.push(baidu.format.apply(null,D))}var p=new Date(n,z,1);var a=new Date(n,(z+1),1);var g=new Date(n,z,1).getDay();var e=DateSelector.getDateCountByMonth(p);var l=g===0?g+2:(g!==1?k-g+2:g);var h=g===0?Math.ceil((e-1)/k):(g!==1?Math.ceil((e-l+1)/k):Math.ceil(e/k));var b,c,i,B,C,d;var t,y;var a;var j=T.dom.query(".ds-wrap")[0];if(T.dom.hasClass(j,"ds-wrap-month")){T.dom.removeClass(j,"ds-wrap-month")}m.push("<tr>",baidu.format(u,this.weekClass,d));for(var x=1;x<=h;x++){var v="byWeek";i=z+1;a=i+1;B=n;C="";t=x===1?l:y+1;y=t+6;var A=y<=e?i:a;var f=y<=e?y:y%e;b=baidu.format(q,x,i,t,((A<=12)?A:A%12),f);var s=i+"."+t;var r=((A<=12)?A:A%12)+"."+f;if(this.selected){if(+(new Date(B,i-1,t)-this.selected.from)===0&&+(new Date(B,i-1,y)-this.selected.to)===0){C=this.dateSelectedClass}}C+=" byWeek";if("function"===typeof this.byWeekStyle&&v){c=this.byWeekStyle(new Date(B,A-1,f))||""}o(s,r,B,v,C,b,c);if(x<h){m.push("</tr><tr>",baidu.format(u,this.weekClass,d))}}m.push("</tr>");return m.join("")},getCalBodyHtmlByMonth:function(j,c){var e='<div id="Calendar#{year}#{month}" class="#{clazz}" style="#{style}" sign="month" y="#{year}" m="#{month}">#{year}年#{nextmonth}月</div>';var d=[];var f=this.calHeadClass;var g,h;T.dom.addClass(T.dom.query(".ds-wrap")[0],"ds-wrap-month");for(g=(c*6);g<(c*6+6);g++){var b=new Date(j,g,1);var a=new Date(b);a.setMonth(a.getMonth()+1);a.setDate(0);if(this.selected&&+(b-this.selected.from)===0&&+(a-this.selected.to)===0){f=this.calHeadSelClass}if("function"===typeof this.byWeekStyle){h=this.byMonthStyle(a)||""}d.push(baidu.format(e,{clazz:f,style:h,year:j,month:g,nextmonth:g+1}));f=this.calHeadClass}return d.join("")},getClickHandler:function(){var a=this;return function(l){l=l||window.event;var k=l.srcElement||l.target;var c=k.getAttribute("sign");var n=new Date(a.viewDate);var g,o,m,j;switch(c){case"prevmonth":n.setMonth(a.viewDate.getMonth()-1);break;case"prevyear":n.setFullYear(a.viewDate.getFullYear()-1);break;case"nextmonth":n.setMonth(a.viewDate.getMonth()+1);break;case"nextyear":n.setFullYear(a.viewDate.getFullYear()+1);break;case"date":var b=new Date(k.getAttribute("y"),k.getAttribute("m"),k.getAttribute("d"));if(a.clickState+""==="from"){g={from:b,to:b}}else{g={from:a.selected.from,to:b};if(g.to-g.from<0){var h=g.to;g.to=g.from;g.from=h}}break;case"week":if(a.singleSelection){return}var f=0;var d=k.nextSibling;while(d.style.cursor==="default"){d=d.nextSibling;f++}m=new Date(d.getAttribute("y"),d.getAttribute("m"),d.getAttribute("d"));j=new Date(m);j.setDate(j.getDate()+6-f);g={from:m,to:j};break;case"month":m=new Date(k.getAttribute("y"),k.getAttribute("m"),1);j=new Date(m);j.setMonth(j.getMonth()+1);j.setDate(0);g={from:m,to:j};break;case"byWeek":m=new Date(k.getAttribute("y"),k.getAttribute("d1").split(".")[0]-1,k.getAttribute("d1").split(".")[1]);j=new Date(m);j.setDate(j.getDate()+6);g={from:m,to:j};break;default:return}switch(c){case"prevmonth":case"prevyear":case"nextmonth":case"nextyear":if(a.onviewchange){var i=new Date(n);i.setMonth(i.getMonth()-a.calendarCount+1);o=a.onviewchange.call(a,{from:i,to:n});if(o===false){return}}a.viewDate=n;a.renderSide("prev");a.renderSide("next");break;case"date":case"week":case"byWeek":case"month":o=a.onselect.call(a,g,3);if(o===false){return}a.selected=g;a.clickState=(c==="date"&&a.clickState==="from")?"to":"from";if(a.singleSelection){a.clickState="from"}break}a.renderCalendars()}},setDateFormat:function(a){this.byWhat=a;this.renderCalendars()}};T.ui.Dialog=T.createUI({options:{id:"",titleText:"默认标题",content:"默认内容",position:{left:360,top:100},isSingle:false,isModal:false,hasClose:true,className:"dialog",zIndex:99999,bgiframe:true,needCloseConfirm:false},_type:"dialog",_init:function(){var a=this;a.options.id=a.id=a.getId();a.render()},_getInnerString:function(){var b=document;var a=this;var c=['<div class="dialog-title">'];c.push('<div class="dialog-title-text">');c.push(a.options.titleText);c.push("</div>");if(this.options.hasClose){c.push('<a href="javascript:void(0);" class="dialog-close">×');c.push("</a>")}c.push("</div>");c.push('<div class="dialog-content">');c.push(a._getContentHTML());c.push("</div>");return c.join("")},_update:function(){var e=this;var a=e.getContainer();if(a){var f="#"+e.id+" .dialog-title-text";var d=T.dom.query(f)[0];if(d){d.innerHTML=e.options.titleText}var c="#"+e.id+" .dialog-content";var b=T.dom.query(c)[0];if(b){b.innerHTML=e._getContentHTML()}T.dom.setPosition(a,e.options.position)}else{return}},_setIFrame:function(d,c,a){var b='<iframe class="bgiframe"frameborder="0"tabindex="-1"src="javascript:false;"style="display:block;position:absolute;z-index:-1;background-color:transparent;filter:Alpha(Opacity=\'0\');top:'+(0)+"px;left:"+(0)+"px;width:"+(c)+"px;height:"+(a)+'px;"/>';if(T.q("bgiframe",d).length===0){T.dom.insertHTML(d,"beforeBegin",b)}},_getContentHTML:function(){var b=this;var c=document;if(T.lang.isString(b.options.content)){return b.options.content}else{if(T.lang.isElement(b.options.content)){T.show(b.options.content);var a=c.createElement("div");a.appendChild(b.options.content);return a.innerHTML}else{return""}}},setTitleText:function(b){var a=this;if(T.lang.isString(b)){a.options.titleText=b}a._update()},setContent:function(c){var b=this;var a=c;if(T.lang.isString(a)||T.lang.isElement(a)){b.options.content=a}b._update()},render:function(){var h=document;var e=this;var a=h.createElement("div");a.id=e.id;a.className="dialog-container "+e.options.className;var d="";if(e.options.isModal){var c=e.options.zIndex-1;var g=h.createElement("div");g.className=e.options.className+" modal";g.id=e.id+"modal";T.dom.setStyles(g,{position:"absolute",top:0,left:0,"background-color":"black",width:T.page.getWidth(),height:T.page.getHeight(),opacity:0.6,"z-index":c});h.body.appendChild(g);if(T.browser.ie>9){g.style.cssText+="opacity: 0.6;"}if(e.options.bgiframe&&T.browser.ie&&(T.browser.ie<7)){var b=h.createElement("div");g.appendChild(b);e._setIFrame(g.firstChild,T.page.getWidth(),T.page.getHeight())}T.un(window,"resize",e._modalResizeHandler);T.on(window,"resize",e._modalResizeHandler)}a.innerHTML=e._getInnerString();h.body.appendChild(a);if(e.options.bgiframe&&T.browser.ie&&(T.browser.ie<7)){e._setIFrame(a.firstChild,a.offsetWidth,a.offsetHeight)}T.dom.setStyles(e.getContainer(),{position:"absolute","z-index":e.options.zIndex});if(e.options.width){T.dom.setStyle(e.getContainer(),"width",e.options.width);e.options.position.left=T.page.getScrollLeft()+(T.page.getViewWidth()-e.options.width)/2;e.options.position.top=Math.max(T.page.getScrollTop()+(T.page.getViewHeight()-e.getContainer().offsetHeight)/2,0)}T.dom.setPosition(e.getContainer(),{left:e.options.position.left,top:e.options.position.top});if(this.options.hasClose){var f="#"+e.id+" .dialog-close";T.dom.query(f)[0].onclick=function(){if(!e.needCloseConfirm){e.close()}else{e.dispatchEvent("onclose")}}}e.hide()},getContainer:function(){return T.g(this.id)},setPosition:function(a){var b=this;b.options.position.left=a.left;b.options.position.top=a.top;b._update()},show:function(){var a=this;T.dom.show(a.getContainer());if(a.options.width){T.dom.setStyle(a.getContainer(),"width",a.options.width);a.options.position.left=T.page.getScrollLeft()+(T.page.getViewWidth()-a.options.width)/2;a.options.position.top=Math.max(T.page.getScrollTop()+(T.page.getViewHeight()-a.getContainer().offsetHeight)/2,0)}T.dom.setPosition(a.getContainer(),{left:a.options.position.left,top:a.options.position.top});if(a.getModalContainer()){T.dom.show(a.getModalContainer());a._modalResizeHandler()}},hide:function(){var a=this;T.dom.hide(a.getContainer());if(a.getModalContainer()){T.dom.hide(a.getModalContainer())}},close:function(){if(!this.options.isSingle){if(this.getContainer()){T.dom.remove(this.getContainer())}if(this.getModalContainer()){T.dom.remove(this.getModalContainer())}T.un(window,"resize",this._modalResizeHandler)}else{this.hide()}if(!this.needCloseConfirm){this.dispatchEvent("onclose")}},getModalContainer:function(){return T.g(this.id+"modal")},_modalResizeHandler:function(){var b=T.q("modal");for(var a=0;a<b.length;a++){T.dom.setStyles(b[a],{width:T.page.getWidth(),height:T.page.getHeight()})}}});T.ui.Dialog.close=function(){T.element(".dialog-container, .modal").each(function(a){T.dom.remove(a)})};T.dom.ready(function(){T.lang.Class.create(T.ToggleTarget,{memo:T.config.memo,onchange:function(F){EventRouter.dispatch("onchangeToggleTarget",F)}});T.lang.Class.create(T.RecordTarget,{onchange:function(F){EventRouter.dispatch("onchangeRecordTarget",F)}});T.event.ons(T.dom.query("ul.nav a.open,ul.nav a.close"),"click",function(F){T.event.preventDefault(F);if(T.dom.hasClass(this,"close")){T.show(T.dom.next(this))}else{T.hide(T.dom.next(this))}T.dom.toggleClass(this,"close");T.dom.toggleClass(this,"open")});var o=new T.ui.Layer({containerId:"notImpLayer",handlerSelector:"ul.nav li.disabled",type:"mouseover",relatedPosition:"tr",className:"notImp-layer",offset:{left:0},autoRender:true,onchange:function(F){o.content("没有权限",F)}});var a=T.g("SetCurrentDefaultSite");var b=T.dom.query("#SiteList>li");T.array.each(b,function(G,F){if(F%2===1){T.dom.addClass(G,"even")}});if(T.g("MoreNav")){T.on("MoreNav","mouseover",function(){T.dom.addClass(this,"more-hover")});T.on("MoreNav","mouseout",function(){T.dom.removeClass(this,"more-hover")})}T.event.ons(b,"mouseover",function(){T.dom.addClass(this,"hover")});T.event.ons(b,"mouseout",function(){T.dom.removeClass(this,"hover")});if(T.g("ReportTipIco")){T.event.on("ReportTipIco","click",function(F){T.event.preventDefault(F);if(T.dom.hasClass(this,"close")){T.fx.expand("ReportTip")}else{T.fx.collapse("ReportTip")}T.dom.toggleClass(this,"close");T.dom.toggleClass(this,"open")})}T.fn.bgIframe(T.dom.q("bg-iframe"));var g=T.g("Feedback");var r=T.g("feedback-form");if(g){var t={imageIds:[],iframeInput:null,iframeForm:null,uploadError:true,submitButtonDisabled:false};if(T.browser.ie>10||(!T.browser.ie&&sessionStorage)){l();T.on(window,"beforeunload",f)}var h=T.on;if(!T.browser.ie&&window.FormData){h("feedback-form-image","onchange",k)}h(g,"click",x);h(r,"click",E);var A=T.dom.getParent(r);T.dragable(r,{handler:T.dom.one(".feedback-title",r),range:[0-A.getBoundingClientRect().top,A.offsetWidth-20,Math.max(document.documentElement.clientHeight,window.innerHeight||0),A.offsetWidth-Math.max(document.documentElement.clientWidth,window.innerWidth||0)-350]});function x(){var F=390;var G=r.style.left;if(G){G=+(G.substring(0,G.indexOf("px")))}else{G=0}if(T.dom.hasClass(g,"open")){r.style.top=0;r.style.left=(-F)+"px";G=-F;T.removeClass(g,"open");T.fx.collapse(r,{orientation:"horizontal",onbeforeupdate:function(H){if(H.target.percent>0.9){T.hide(r)}},render:function(I){var H=Math.floor(I*F);r.style.width=H+"px";r.style.left=(G+F-H)+"px"}})}else{r.style.top=0;T.addClass(g,"open");T.show(r);T.fx.expand(r,{orientation:"horizontal",render:function(I){var H=Math.floor(I*F);r.style.width=H+"px";r.style.left=(0-H)+"px"}})}}function E(G){var F=T.event.getTarget(G);switch(true){case F.id==="feedback-form-submit":p();break;case F.id==="add-feedback-img-button":w();break;case T.dom.hasClass(F,"feedback-img-delete-button"):T.event.stop(G);u(F);break;case F.id==="feedback-form-fold-button":x();default:break}}function k(){var H=T.g("feedback-form-image").value;if(H){if(/.+\.(png|bmp|jpeg|jpg|gif)$/i.test(H)){var G=new FormData(T.g("feedback-submit-form"));G.append("method","feedback/upload");B(G,i,z);var F='<p id="upload-failed-hint" class="invalid-input-hint" style="color: #1da653;">文件上传中，请稍候...</p>';T.g("feedback-image-hint").innerHTML=F;T.g("feedback-form-image").value=""}else{var F='<p id="upload-failed-hint" class="invalid-input-hint">文件格式错误!仅支持png、jpeg、jpg、gip、bmp格式的图片文件。</p>';T.g("feedback-image-hint").innerHTML=F}}}function B(I,F,G,J){var H=new XMLHttpRequest();H.open("post",T.config.systemConfig.ajaxUri,true);if(T.browser.ie||!(I instanceof FormData)){H.setRequestHeader("Content-type","application/x-www-form-urlencoded");I=baidu.param(I)}H.onreadystatechange=function(){if(H.readyState===4){var M=H.status;if((M>=200&&M<300)||M===304||M===1223){var K=null;try{K=baidu.json.decode(H.responseText);if(K.status===0||K.status>2){F(K.data,J)}else{if(K.status===1){if(G){G(K.msg,J)}}else{if(K.status===2){window.location=K.data}}}}catch(L){if(G){G("系统错误，请稍候再试…",J)}}}else{if(G){if(M===413){G("图片过大，请上传小于2M的图片…",J)}else{G("网络请求错误，请稍候再试…",J)}}}}};H.timeout=120*1000;H.ontimeout=function(){T.g("feedback-hint-wrapper").innerHTML='<span style="color: #f00">请求超时，请检查您的网络并重试！</span>'};H.send(I)}function i(F){T.g("feedback-image-hint").innerHTML="";t.imageIds.push(F.id);var G='<div class="feedback-img-wrapper"><img class="feedback-form-img-preview" src="'+T.config.systemConfig.feedbackImageBaseUrl+F.id+'"><a class="feedback-img-delete-button" href="javascript:void(0)" data="'+F.id+'"></a></div>';T.dom.insertHTML("image-preview-wrapper","beforeEnd",G)}function z(G){var F='<p id="upload-failed-hint" class="invalid-input-hint">'+G+"</p>";T.g("feedback-image-hint").innerHTML=F}function p(){T.g("feedback-hint-wrapper").innerHTML="";if(v()&&!t.submitButtonDisabled){y()}}function u(H){var F=T.dom.getAttr(H,"data");T.array.remove(t.imageIds,F);var G=T.dom.getParent(H);T.dom.remove(G)}function y(){B(D(),e,m);q()}function q(){t.submitButtonDisabled=true;T.g("feedback-hint-wrapper").innerHTML='<span style="color: #1da653">请求发送中，请稍候...</span>'}function D(){var F=T.g;return{method:"feedback/index",page:T.config.pageInfo.title,type:F("feedback-form-param-type").value,appKey:T.object.isEmpty(T.config.appInfo)?"":T.config.appInfo.appKey,content:F("feedback-form-param-content").value,contact:T.config.userInfo.name,email:F("feedback-form-param-email").value,images:t.imageIds.join()}}function e(){t.submitButtonDisabled=false;t.imageIds=[];var F=T.g;T.dom.children(F("feedback-form-param-type"))[0].selected=true;F("feedback-form-param-content").value="";F("image-preview-wrapper").innerHTML="";F("feedback-form-param-email").value="";if(T.browser.ie>10||(!T.browser.ie&&sessionStorage)){f();T.g("feedback-hint-wrapper").innerHTML='<p style="color: #1da653; line-height: 16px; margin-top: 10px">反馈成功，工作人员会在一个工作日内给您回复，请注意查收反馈回复邮件</p>'}else{T.g("feedback-hint-wrapper").innerHTML='<span style="color: #1da653">反馈成功，工作人员会在一个工作日内给您回复，请注意查收反馈回复邮件</span>'}}function m(F){t.submitButtonDisabled=false;T.g("feedback-hint-wrapper").innerHTML='<p style="color: #f00; line-height: 16px; margin-top: 10px">'+F+"</p>"}function w(){if(!T.browser.ie&&window.FormData){T.g("feedback-form-image").click()}else{n();t.iframeInput.click()}}function v(){var K=T.dom.hide;var I=T.dom.show;var H=T.g;var J;if(H("feedback-form-param-type").value!=="-1"){J=true;K("invalid-feedback-type")}else{J=false;I("invalid-feedback-type")}var G;if(H("feedback-form-param-content").value){G=true;K("invalid-feedback-content")}else{G=false;I("invalid-feedback-content")}var F;if(/^[a-z0-9._%-]+@([a-z0-9-]+\.)+[a-z]{2,4}$/.test(H("feedback-form-param-email").value)){F=true;K("invalid-feedback-email")}else{F=false;I("invalid-feedback-email")}return G&&F&&J}function n(){var G=document.createElement("iframe");G.style.display="none";G.src="about:blank";document.body.appendChild(G);var H=G.contentDocument||G.contentWindow.document;H.open();H.write('<body><form method="post" enctype="multipart/form-data"action="/web/feedback/upload" style="display: none"><input id="feedback-form-image" type="file" name="image" style="display: none"></form></body>');t.iframeInput=H.forms[0].children[0];t.iframeForm=H.forms[0];T.on(t.iframeInput,"onchange",d);if(t.imageUploadFrame){T.dom.remove(t.imageUploadFrame)}t.imageUploadFrame=G;var F="upFileCallback";window[F]=function(I){t.uploadError=false;if(I&&I.msg){z(I.msg)}else{if(I&&I.status===0){i(I.data)}else{z(I.msg)}}}}function d(){var G=t.iframeInput.value;if(G){if(/.+\.(png|bmp|jpeg|jpg|gif)$/i.test(G)){t.imageUploadFrame.onload=function(){setTimeout(function(){if(t.uploadError){z()}},30000)};t.iframeForm.submit();var F='<p id="upload-failed-hint" class="invalid-input-hint" style="color: #1da653;">文件上传中，请稍候...</p>';T.g("feedback-image-hint").innerHTML=F;t.iframeInput.value=""}else{var F='<p id="upload-failed-hint" class="invalid-input-hint">文件格式错误，仅支持png、jpeg、jpg、gip、bmp格式的图片文件</p>';T.g("feedback-image-hint").innerHTML=F}}}function l(){var J=T.g;var H=sessionStorage.getItem("type");if(H){J("feedback-form-param-type").value=H}var I=sessionStorage.getItem("content");if(I){J("feedback-form-param-content").value=I}var F=sessionStorage.getItem("email");if(F){J("feedback-form-param-email").value=F}var G=sessionStorage.getItem("imageIds");if(G){t.imageIds=G.split(",")}T.each(t.imageIds,function(K){var L='<div class="feedback-img-wrapper"><img class="feedback-form-img-preview" src="'+T.config.systemConfig.feedbackImageBaseUrl+K+'"><a class="feedback-img-delete-button" href="javascript:void(0)" data="'+K+'"></a></div>';T.dom.insertHTML("image-preview-wrapper","beforeEnd",L)})}function f(){var F=T.g;sessionStorage.setItem("type",F("feedback-form-param-type").value);sessionStorage.setItem("content",F("feedback-form-param-content").value);sessionStorage.setItem("email",F("feedback-form-param-email").value);sessionStorage.setItem("imageIds",t.imageIds.join())}}T.inlineTip("Help");T.inlineTip("ReportHelp");T.dom.one(".report-help")&&(T.dom.setStyle(T.dom.one(".tip-arrow"),"left",(T.dom.one(".report-help").offsetLeft+2)+"px"));var C=function(){var F={position:"absolute"};var G=(document.documentElement&&document.documentElement.scrollTop)||document.body.scrollTop;if(G>50){if(T.browser.ie&&T.browser.ie<7){T.extend(F,{top:G,height:document.documentElement.clientHeight})}else{T.extend(F,{position:"fixed",top:0,height:document.documentElement.clientHeight})}}else{T.extend(F,{top:50,height:Math.max(document.documentElement.clientHeight+G-50-5,0)})}return F};var j=function(){var G=C();T.dom.setStyles("minibar",G);T.dom.setStyles("aside-menu",G);var F=T.dom.one("#aside-menu .app-info");var H=10;if(F&&F.style.display!="none"){H=141}T.dom.setStyle(T.dom.one("#aside-menu .nav"),"height",Math.max(G.height-59-H,0))};var s=function(){var K=T.dom.one("#aside-menu .nav");var H=T.dom.one(".selected",K);if(H==null){return}var G=H.offsetHeight;var J=H.offsetTop;var I=K.clientHeight;var F=0;if((F=J+G-59-I)>0){K.scrollTop=F;if(T.browser.ie&&T.browser.ie<8){K.scrollTop+=59}}};if(T.g("menu-toggle")){var c=T.dom.setStyles;T.event.on("menu-toggle","click",function(){T.dom.hide("aside-menu");c("main-body",{"margin-left":65});T.dom.show("minibar");c("minibar",C());var F=T.g("ControlBar");if(F&&T.dom.getStyle(F,"position")==="fixed"){c(F,{width:T.q("main")[0].offsetWidth,left:"65px"})}T.event.fire(window,"resize")});T.event.on("menu-untoggle","click",function(){T.dom.show("aside-menu");c("main-body",{"margin-left":260});T.dom.hide("minibar");c("aside-menu",C());var F=T.g("ControlBar");if(F&&T.dom.getStyle(F,"position")==="fixed"){c(F,{width:T.q("main")[0].offsetWidth,left:"260px"})}T.event.fire(window,"resize")});T.event.on(window,"resize",function(){j()});T.on(window,"scroll",function(){j()});j();s()}setInterval(function(){T.ajax.get(T.config.systemConfig.baseUri+"/welcome/refresh")},25*60*1000)});T.ui.Download=T.createUI({_type:"download",options:{checkInterval:500,trigerId:null,reportTitle:null,reportId:null,appId:null,reportTypes:["csv"],downloadUrl:"download/get",checkUrl:"download/check",addUrl:"download/add",generatingHint:"文件生成中，需要等待30s到5min",onchange:function(a){},wrapperTemplate:'<div class="download-report-wrapper"><div class="download-report-title">#{title}</div><div class="download-report-items">文件类型：#{items}</div><div id="#{tipId}" class="download-report-tip">#{tip}</div><div class="download-report-buttons"><a class="button" id="#{downloadId}" href="javascript:void(0)"><span>下载</span></a><a id="#{cancelId}" href="javascript:void(0)">取消</a></div></div>',itemTemplate:'<label for="#{0}" title="#{2}"><input type="radio" title="#{2}" data="#{4}" id="#{0}"#{3} name="download__report"/>#{1}</label>',iframeTemplate:'<iframe id="#{0}" width="0" height="0"></iframe>',downloads:[{id:"pdf",label:"PDF",title:"本格式图文并茂，阅读时需pdf相应软件。"},{id:"csv",label:"CSV",title:"本格式不含图示，支持较大量数据，便于后期数据处理。"},{id:"html",label:"HTML",title:"本格式图文并茂，支持数据量较少，体积小便于下载阅读。"}]},_downloadType:null,_renderHTML:function(){var c=[];for(var b in this.options.downloads){var a=this.options.downloads[b];if(T.array.contains(this.options.reportTypes,a.id)){c.push(T.format(this.options.itemTemplate,this.getId(a.id),a.label,a.title,b==0?' checked="checked"':"",a.id))}}var d=this.options.downloads[0].title;return T.format(this.options.wrapperTemplate,{title:(this.options.reportTitle||"下载报告"),items:c.join(""),tipId:this.getId("Tip"),tip:d,downloadId:this.getId("Download"),cancelId:this.getId("Cancel")})},_bindEvents:function(){var e=this;var a=this.options.reportTypes;for(var d=0,c=a.length;d<c;d++){var b=a[d];T.on(this.getId(b),"click",function(){T.g(e.getId("Tip")).innerHTML=this.title;e._downloadType=T.dom.getAttr(this,"data")})}T.on(this.getId("Download"),"click",function(){e.dialog.close();e.options.onchange(e._downloadType)});T.on(this.getId("Cancel"),"click",function(){e.dialog.close()})},download:function(b){var a=this;this.options.originalHint=T.g(a.options.trigerId).innerHTML;if(b.reportId==null){b.reportId=this.options.reportId}if(b.appId==null){b.appId=this.options.appId}if(b.format==null){b.format=this._downloadType}b.method=this.options.addUrl;T.ajax.jsonPost(this.options.url,b,function(c){if(c.status===4){a.executeDownload(c)}else{a.showHint(a.options.trigerId);setTimeout(function(){a.checkStatus(c)},a.options.checkInterval)}},function(c){alert(c)})},_renderDialog:function(){this.dialog=new T.ui.Dialog({id:this.getId("Dialog"),titleText:"下载报告",content:this._renderHTML(),isModal:true,isSingle:true,width:360});this._bindEvents()},render:function(){var a=this;this._downloadType=this.options.reportTypes[0];if(this.options.reportTypes.length>1){T.on(this.options.trigerId,"click",function(){if(!a.dialog){a._renderDialog()}a.dialog.show()})}else{T.on(this.options.trigerId,"click",function(){a.options.onchange(a._downloadType)})}},checkStatus:function(b){var a=this;var c={id:b.id,reportId:this.options.reportId,appId:this.options.appId,method:this.options.checkUrl};T.ajax.jsonPost(this.options.url,c,function(d){switch(d.status){case 1:case 2:setTimeout(function(){a.checkStatus(d)},a.options.checkInterval);break;case 3:a.hideHint(a.options.trigerId);alert("文件生成失败，请稍后重试...");break;case 4:a.executeDownload(d);break;default:}},function(d){alert(d)})},executeDownload:function(b){var a=T.g("DownloadChannelForm");a.action=T.config.systemConfig.baseUri+"/"+this.options.downloadUrl+"?id="+b.id+"&appId="+this.appId+"&reportId="+T.config.pageInfo.id;a.submit();this.hideHint(this.options.trigerId)},showHint:function(a){if(this.options.showHint){this.options.showHint(a)}else{T.dom.addClass(a,"disabled");T.g(a).innerHTML=this.options.generatingHint}},hideHint:function(a){if(this.options.hideHint){this.options.hideHint(a)}else{T.dom.removeClass(a,"disabled");T.g(a).innerHTML=this.options.originalHint}}});T.ui.FilterGroup=T.createUI({options:{containerId:"FilterGroup",onchange:function(a,b){},limit:Number.MAX_VALUE,label:"",items:[],tip:false,single:true,searchText:"搜索内容",tool:false,filterable:false,selectedItems:[],template:'<a id="!{0}" class="selectable-item #{4} ellipsis" data="!{1}" title="!{3}" href="javascript:void(0)">#{6}</a>',groupTemplate:'<a href="javascript:void(0)" class="filter-more">更多</a><div class="group wrapped clearfix">#{1}#{0}</div>',separatorTemplate:'<div class="separator"></div>',tipTemplate:'<a class="help" data="#{0}" href="javascript:void(0)">&nbsp;</a>',groupWrapTemplate:'<div class="filter-expand filter-shrink"><div class="group-wrapper">#{0}</div></div>'},_type:"filterGroup",_items:null,_selectedItems:null,_init:function(){this._selectedItems=T.object.clone(this.options.selectedItems);this._bind();this.expand=false},_renderHtml:function(){var b='<div class="filter-tool-box">                <div class="filter-tool-bar">&nbsp;                    <div class="filter-combox"></div>                    <div class="filter-search">                        <span class="filter-search-icon"></span>                        <a href="javascript:void(0)" class="dialog-close" style="display:none;">×</a>                        <input class="filter-search-input" type="text" value="'+this.options.searchText+'"/></div>                &nbsp;</div></div>                <a href="javascript:void(0)" class="filter-more">更多</a>                <div class="group wrapped clearfix">#{1}#{0}</div>';if(!this.options.tool){b=this.options.groupTemplate}var a=[];T.array.each(this._items,function(f,d){var c=[],e;if(f.length!=0){if(d!=0){a.push(this.options.separatorTemplate)}T.array.each(f,function(j,h){if(this.options.tip){var g=T.encodeHTML(j.label)+T.format(this.options.tipTemplate,j.id)}else{g=T.encodeHTML(j.label)}c.push(T.format(this.options.template,this.getId(j.id),j.id,"checkbox",j.label==""?"&nbsp;":j.label,(T.array.contains(this._selectedItems,j.id)?" selected":""),this.getId(this.options.containerId),g))},this);e=this.options.groupWrapTemplate?T.format(this.options.groupWrapTemplate,c.join("")):c.join("");a.push(T.format(b,e,this.options.label?'<label class="label">'+this.options.label+'<b class="arrow-left"></b></label>':""))}},this);return a.join("")},_itemsHtml:function(){var a=[];T.array.each(this._items,function(e,c){var b=[],d;T.array.each(e,function(h,g){if(this.options.tip){var f=T.encodeHTML(h.label)+T.format(this.options.tipTemplate,h.id)}else{f=T.encodeHTML(h.label)}b.push(T.format(this.options.template,this.getId(h.id),h.id,this._type,h.label,(T.array.contains(this._selectedItems,h.id)?' checked="checked"':""),this.getId(this.options.containerId),f))},this);d=this.options.groupWrapTemplate?T.format(this.options.groupWrapTemplate,b.join("")):b.join("");a.push(d)},this);return a.join("")},_bindToolEvent:function(){var d=this,b=d.options;var a=T.g(b.containerId),c=T.dom.one(".filter-tool-box",a);searchTool=T.dom.one(".filter-search",a),input=T.dom.one(".filter-search-input",searchTool),closeBtn=T.dom.one(".dialog-close",searchTool);if(!this.options.filterable){T.dom.hide(c)}T.event.on(input,"keyup",function(g){var f=T.dom.one(".dialog-close",this.parentNode);if(this.value&&T.trim(this.value)!=""){T.show(f)}else{T.hide(f)}d.filterFn(this.value)});T.inlineTip(input);T.event.on(closeBtn,"click",function(g){var f=T.dom.one(".filter-search-input",this.parentNode);d.filterFn(f.value="");T.dom.hide(this)})},filterFn:function(c){var g=this,d=g.options,b=T.object.clone(g._items),f=g.selectable.get("all");var a=[];for(var e=0;e<b.length;e++){Array.prototype.push.apply(a,T.splat(b[e]))}T.array.each(a,function(i,h){if(i.label!=null&&~i.label.indexOf(c)||c==null||c==""){T.dom.show(f[h])}else{T.dom.hide(f[h])}})},_bindOtherEvent:function(){var d=this,b=d.options;var a=T.g(this.options.containerId);var c=T.dom.one(".filter-more",a);if(!this.options.tool||(this._items.length==1&&this._items[0].length<7)){c&&T.dom.hide(c)}c&&T.event.on(c,"click",function(f){if(d.expand){d.shrinkFilter()}else{d.expandFilter()}})},expandFilter:function(){var f=this,d=f.options;var b=T.g(this.options.containerId);var e=T.dom.one(".filter-more",b);var c=T.dom.one(".filter-tool-box",b);var a=T.dom.one(".filter-expand",b);T.dom.addClass(e,"filter-more-on");e.innerHTML="收起";if(d.tool){T.dom.show(c)}T.dom.removeClass(a,"filter-shrink");this.expand=true},shrinkFilter:function(){var f=this,d=f.options;var b=T.g(this.options.containerId);var e=T.dom.one(".filter-more",b);var c=T.dom.one(".filter-tool-box",b);var a=T.dom.one(".filter-expand",b);a.scrollTop=0;T.dom.removeClass(e,"filter-more-on");e.innerHTML="更多";if(d.tool&&!d.filterable){T.dom.hide(c)}T.dom.addClass(a,"filter-shrink");this.expand=false},_bind:function(){var b=0;var c=this,a=c.options;this.selectable=new T.ui.Selectable({single:a.single,limit:a.limit,containerId:a.containerId,elementClazz:"selectable-item",onselect:function(e,d){if(!a.single){return this.selected.length<=c.selectable.options.limit}},onchange:function(d){c._selectedItems=c.getElAttrs(d,"data");var e=c.getElAttrs(d,"title");c.options.onchange(c._selectedItems,e)}})},getElAttrs:function(c,b){var a=[];T.array.each(c,function(d){a.push(T.dom.getAttr(d,b))});return a},reset:function(){this.selectable.reset("first",false);var b=T.g(this.options.containerId),a=T.dom.one(".filter-search",b),c=T.dom.one(".filter-search-input",a),d=T.dom.one(".dialog-close",a);this.filterFn(c.value="");T.dom.hide(d);this._selectedItems=[this.options.items[0].id];this.options.onchange(this._selectedItems,[])},renderItems:function(d,c){this._selectedItems=T.object.clone(c)||[];if(!T.lang.isArray(d[0])){this._items=[d]}else{this._items=d}var b=T.g(this.options.containerId);var e=T.dom.one(".group",b);var a=T.dom.one(".filter-expand",e);a&&T.dom.remove(T.dom.one(".filter-expand",e));T.dom.insertHTML(e,"beforeEnd",this._itemsHtml());a=T.dom.one(".filter-expand",e);if(this.expand){this.expandFilter()}else{this.shrinkFilter()}this.selectable.select("first",true)},render:function(){if(!T.lang.isArray(this.options.items[0])){this._items=[this.options.items]}else{this._items=this.options.items}var a=T.g(this.options.containerId);if(a){T.dom.empty(a);T.insertHTML(a,"beforeEnd",this._renderHtml())}this.selectable.initSelected();if(this.options.tool){this._bindToolEvent()}this._bindOtherEvent()},click:function(b){var a=T.g(this.getId(b));if(a){a.click()}},getSelectedLabels:function(){return this.getElAttrs(this.selectable.selected,"title")},unselect:function(a){return this.selectable.unselect(a)}});T.FlashFormatConverter=T.createClass({options:{onchange:function(a){}},setFlash:function(h){var g=h.flashId,c=h.fields,d=h.units,e=h.items,f=h.type||"line";if((c&&c.length==0)||(e&&e.length==0)){return}var a;if(f=="linepie"){var i=h.line,b=h.pie;a={line:this._convertDataformat(i.fields,i.items),pie:this._convertDataformat(b.fields,b.items)}}else{a=this._convertDataformat(c,e)}this._setData(h,a);this._setStyle(h,a);h.highlightIndexs&&this._setHighLightItem(g,h.highlightIndexs)},_convertDataformat:function(a,b){var d=[],c=[];T.array.each(b,function(e){d.push(T.array.hash(a,e))});return d},_setData:function(c,f){if(!f||f.length==0){return}var d=c.flashId,b=c.fields,e=c.type;var a=T.swf.getMovie(d);a.clear&&a.clear();this.options.onchange(a,c,f);if(e=="line"){a.setData(f);c&&c.indicator&&a.setValueName(c.indicator)}else{if(e=="bar"){a.setData(f)}else{if(e=="pie"){a.setPieData(f,"value","label")}else{if(e=="area"){c&&c.indicator&&a.setValueName(c.indicator);a.setMapData(f)}else{if(e=="areapie"){c&&c.indicator&&a.setValueName(c.indicator);a.setMapData(f);a.setPieData(f,"value","label")}else{if(e=="linepie"){a.setLinebarData(f.line);a.setPieData(f.pie,"value","label");c.indicator&&a.setValueName&&a.setValueName(c.indicator)}else{if(e=="circle"){c&&c.indicator&&a.setValueName(c.indicator);a.setData(f)}else{a.setData(f)}}}}}}}},_setStyle:function(m,d){var k=m.flashId,f=m.fields,h=m.units,j=m.type;var b=T.swf.getMovie(k);if(j=="line"){this._setLineStyle(b,h,f)}else{if(j=="bar"){this._setBarStyle(b,h,f)}else{if(j=="pie"){b.setPieGradient(false);b.setPieColors([4767476,14898746,1682015,11060822,5328533,14833299,15312960,12369084,9721830,1360336]);b.setRadius(100);b.setHasTip(false);b.addEvent();b.setLineStyle(2913222,1,0.5);b.setShowLabel(false);b.setShowLabelLine(false);b.setlabelLineLength(0.1)}else{if(j=="areapie"){b.setPieData(d,"value","label");b.setPieGradient(false);b.setPieColors([4767476,14898746,1682015,11060822,5328533,14833299,15312960,12369084,9721830,1360336]);b.setRadius(100);b.setHasTip(false);b.addEvent();b.setLineStyle(2913222,1,0.5);b.setShowLabel(false);b.setShowLabelLine(false);b.setlabelLineLength(0.1);b.showTopNum(4)}else{if(j=="linepie"){T.array.each(m.line.fields,function(i){T.array.remove(m.line.fields,i+"SmallTip")});h[0]&&b.setTick(" / "+h[0],"left");b.setDataSuffix("I,III","left");b.setAxisLineStyle(4681895,2);if(m.bar){b.addBarGraph(m.line.fields[1],"label")}for(var e=2,c=m.line.fields.length;e<c;e++){b.addLineGraph(m.line.fields[e],"label");b.setLineDot("3",m.line.fields[e])}var a=[4767476,14898746,1682015,11060822,5328533,14833299,15312960,12369084,9721830,1360336];var g;if(m.bar){g=[7368816].concat(a)}else{g=a}b.setLinebarColors(g);b.setSplitLine(0);b.setLinebarGradient(false);b.setShowDataTips(true);b.setShowBigDataTips(false);b.setPieGradient(false);b.setPieColors(a);b.setRadius(90);b.setHasTip(false);b.addEvent();b.setLineStyle(2913222,1,0.5);b.setShowLabel(false);b.setShowLabelLine(false);b.setlabelLineLength(0.1);b.showTopNum(3)}else{if(j=="circle"){b.setColors([4767476,14898746,1682015,11060822,5328533,14833299,15312960,12369084,9721830,1360336,12949082,2913222,3705647,16162851,10208838])}else{if(j=="circlegraph"){b.setTick("时长","left");b.setColors([4767476,14898746,1682015,11060822,5328533,14833299,15312960,12369084,9721830,1360336,12949082,2913222,3705647,16162851,10208838])}}}}}}}},_setLineStyle:function(b,d,a){T.array.each(a,function(g){T.array.remove(a,g+"BigTip")});b.setSplitLine(0);d=T.array.unique(d);var e=a[0];for(var f=1,c=a.length;f<c;f++){if(f!=1&&d.length>1){b.addLineGraph(a[f],e||"label","bottom","right")}else{b.addLineGraph(a[f],e||"label")}this._setUnit(b,d[f-1],f==1?"left":"right");if(c>2){b.addLegend("0",a[f]);b.setLineDot("3",a[f])}}b.setAxisLineStyle(4681895,2);b.setColors([4767476,16370368,1682015,11060822,5328533,14833299,15312960,12369084,9721830,1360336,12949082,2913222,3705647,16162851,10208838]);b.setGradient(false);b.setShowDataTips(false);b.setShowBigDataTips(true)},_setBarStyle:function(b,c,a){b.setSplitLine(0);T.array.each(a,function(d){T.array.remove(a,d+"SmallTip")});c=T.array.unique(c);c[0]&&b.setTick(" / "+c[0],"left");this._setUnit(b,c[0],"left");b.addBarGraph(a[1],a[0]||"label");if(a.length>2){if(c.length>1){b.addBarGraph(a[2],a[0]||"label","bottom","right");c[1]&&b.setTick(" / "+c[1],"right");this._setUnit(b,c[1],"right")}else{b.addBarGraph(a[2],a[0]||"label")}b.setBarType("2",a[2]);b.addLegend("1",a[1],6710886);b.addLegend("2",a[2],6710886)}b.setAxisLineStyle(4681895,2);b.setColors([4767476,14898746,1682015,11060822,5328533,14833299,15312960,12369084,9721830,1360336,12949082,2913222,3705647,16162851,10208838]);b.setSplitLine(0);b.setGradient(false);b.setShowDataTips(true);b.setShowBigDataTips(false);b.setBarWidth(15)},_setUnit:function(a,b,c){if(!b){return}a.setTick(" / "+b,c);switch(b){case"百分比":a.setDataSuffix("I%",c);break;case"时长":break;case"元":case 0:a.setDataSuffix("I.DD",c);break;default:a.setDataSuffix("I,III",c);break}},_setHighLightItem:function(b,c){if(!T.lang.isArray(c)||(c.length==0)){return false}var a=T.swf.getMovie(b);var d=[];T.each(c,function(f,e){d.push({index:f,color:14982543})});a.setHighLightItem(d)}});T.ui.FlashIndicator=T.createUI({options:{containerId:"FlashIndicator",onchange:function(a){},limit:Number.MAX_VALUE,defaultText:"没有可选择的指标",regularText:null,label:'<span class="text">指标：</span>',defaultGroup:"0",className:"",items:null,selectedItems:null,defaultItems:null,wrapperTemplate:'<a href="javascript:void(0)" class="combobox trackable #{1}" memo="{id:\'flash_poin\'}" #{2}>#{0}</a>',indicatorContainerTempalte:'<div class="flash-indicator-container layer" style="display:none;"><div class="flash-indicator-groups">#{0}</div>#{1}</div>',indicatorTextTemplate:'#{0}<span class="flash-indicator-text text">正在加载中...</span><b class="arrow"></b>',setDefaultTemplate:'<div id="FlashTip" class="text">(可同时选择<span class="max-flash-indicator-num">#{0}</span>项)</div>',indicatorTemplate:'<label for="#{0}" title="!{2}"><input name="#{5}" id="#{0}" value="!{1}" type="#{3}" text="!{2}" #{4} />!{2, 10}</label>',indicatorWrapperTemplate:'<div class="group clearfix">#{0}</div>',separatorTemplate:'<div class="separator"></div>'},_flashIndicatorContainer:null,_flashIndicatorBtn:null,_flashIndicatorText:null,_maxFlashIndicatorNum:null,_defaultItems:null,_defaultLimit:Number.MAX_VALUE,_groupItems:null,selectedItems:[],_init:function(){this._groupItems=[];this.selectedItems=T.object.clone(this.options.selectedItems);var e=this;if(!T.lang.isArray(this.options.items)){return}var b=this.options.items;for(var c=0,a=b.length;c<a;c++){var d=this.options.items[c];d.group=d.group||this.options.defaultGroup;if(this._groupItems[d.group]==null){this._groupItems[d.group]=[]}this._groupItems[d.group].push(d)}this._defaultLimit=this.options.limit;this._defaultItems=this.selectedItems},_type:"flash-indicator",showIndicatorContainer:function(b){var a=T.g(this.options.containerId),c=T.dom.getPosition(a);T.setStyles(this._flashIndicatorContainer,{left:c.left+"px",top:c.top+a.offsetHeight+"px"})},showDefaultIndicatorContent:function(){this.options.limit=this._defaultLimit;this.showIndicatorContent(this._defaultItems)},showSingleIndicatorContent:function(){var a=this.selectedItems[0];this.options.limit=1;if(a){this.showIndicatorContent([a])}else{this.showIndicatorContent([])}},showIndicatorContent:function(k){var g=this._flashIndicatorText;if(g){var b=[],d=[],h=k||this._defaultItems;this._set(h);if(this.options.regularText){d.push(this.options.regularText)}else{for(var c=0,a=h.length;c<a;c++){var j=T.g(this.getId(h[c]));if(j){b.push(h[c]);d.push(T.getAttr(j,"text"))}}var e=this._maxFlashIndicatorNum;if(e){e.innerHTML=e.innerHTML.replace(/\d/g,this.options.limit)}}if(h.length==0){T.array.empty(d);d.push(this.options.defaultText)}var f=[];T.each(d,function(i){f.push(T.truncat(i,10))});g.innerHTML=T.encodeHTML(f.join("、"));T.setAttr(g,"title",d.join("、"))}},_set:function(c){if(!c){return}this._unCheckAll();for(var b=0,a=c.length;b<a;b++){var d=T.g(this.getId(c[b]));if(d){d.checked=true}}this.selectedItems=c},_unCheckAll:function(){var a=this;T.array.each(this.selectedItems,function(b){var c=T.g(a.getId(b));if(c){c.checked=false}});this.selectedItems=[]},_bind:function(){T.on(this._flashIndicatorText,"click",T.fn.bind(this.showIndicatorContainer,this));var a=this;T.array.each(T.dom.query(":input",T.g(this.options.containerId)),function(b,c){a.on(b,"click",function(f){var d=a.selectedItems;if(this.checked){d.push(this.value)}else{if(d.length==1){this.checked=true;return false}T.array.remove(d,this.value)}if(d.length>a.options.limit){var e=T.array.removeAt(d,0);T.g(a.getId(e)).checked=false}a.showIndicatorContent(a.selectedItems);a.options.onchange(a.selectedItems)})})},_renderIndicators:function(){var d=[],g=[],a,e=(this.options.limit==1?"radio":"checkbox"),f=this,c=this._groupItems.length!=0?'layer="#'+this.options.containerId+'  .flash-indicator-container"':"";d.push(T.format(this.options.indicatorTextTemplate,this.options.label));for(var b in this._groupItems){if(this._groupItems.hasOwnProperty(b)){var h=this._groupItems[b];a=[];T.array.each(h,function(i){a.push(T.format(this.options.indicatorTemplate,this.getId(i.id),i.id,i.label,e,(T.array.contains(this.selectedItems,i.id)?' checked="checked"':""),this.getId(this.options.containerId)))},this);g.push(T.format(this.options.indicatorWrapperTemplate,a.join("")));if(b!==this._groupItems.length-1){g.push(this.options.separatorTemplate)}}}d=[T.format(this.options.wrapperTemplate,d.join(""),this.options.className,c)];d.push(T.format(this.options.indicatorContainerTempalte,g.join(""),T.format(this.options.setDefaultTemplate,this.options.limit)));return d.join("")},render:function(){if(T.g(this.options.containerId)){T.insertHTML(this.options.containerId,"beforeEnd",this._renderIndicators());this._flashIndicatorContainer=T.dom.one(".flash-indicator-container",T.g(this.options.containerId));this._flashIndicatorText=T.dom.one(".flash-indicator-text",T.g(this.options.containerId));this._maxFlashIndicatorNum=T.dom.one(".max-flash-indicator-num",T.g(this.options.containerId));this.showIndicatorContent(this.selectedItems);this._bind()}}});T.Indicator=T.createClass({options:{indicators:null,groups:[1,2]},_init:function(){var a=this;T.array.map(this.options.indicators,function(b){b.format=a._format()})},_format:function(){var a=this;return function(b){if(b==null){return""}if(!T.lang.isNumber(b)){return b}if(T.lang.isString(this.type)){switch(this.type){case"number":return T.i18n.number.format(b,T.i18n.currentLocale);case"ratio":return T.i18n.number.format(b,T.i18n.currentLocale)+"%";case"time":return T.i18n.number.formatTime(b);case"time2":return T.i18n.number.formatTime(b,2)}}return b}},map:function(a){var b=this;return T.array.map(a,function(c){return T.array.find(b.options.indicators,function(d){return c==d.id})})},index:function(a){return T.array.find(this.options.indexes,function(b){return a==b.id})},group:function(b){var a=[];T.array.each(this.options.groups,function(c){a.push(T.array.filter(b,function(d){return d&&d.group==c}))});return a}});T.ui.Layer=T.createUI({_type:"layer",options:{containerId:null,handlerSelector:null,type:"mouseover",autoClose:true,relatedOther:false,relatedPosition:"br",closeButton:false,mouseoverTime:500,mouseoutTime:500,className:"",offset:{left:0,top:0},onchange:function(a){},containerTemplate:'<div id="#{0}" class="layer shared-layer #{2}" style="display:none;position:absolute;">#{1}<div id="#{0}Content" class="layer-content"></div></div>',closeTemplate:'<div class="layer-close">X</div>'},_containerId:null,_handlerSelector:null,_init:function(){this._containerId=this.options.containerId;this._handlerSelector=this.options.handlerSelector},_show:function(a){this.options.onchange(a);T.show(this._containerId);T.setRelatedPosition(this._containerId,a,this.options.relatedPosition,this.options.offset)},_bindClick:function(){var a=this;T.event.ons(T.dom.query(a._handlerSelector),"click",function(){a.options.onchange(this);if(!a.options.relatedOther){T.setRelatedPosition(a._containerId,this,a.options.relatedPosition,a.options.offset)}})},_bindMouseOver:function(){var a=null;var b=this;if(T.g(b._containerId)==null){b._render();T.on(b._containerId,"mouseover",function(){clearTimeout(a)});if(this.options.autoClose){T.on(b._containerId,"mouseout",function(){a=setTimeout(function(){b.close()},b.options.mouseoutTime)})}}T.event.ons(T.dom.query(b._handlerSelector),"mouseover",function(){var c=this;clearTimeout(a);if(b.options.mouseoverTime>0){a=setTimeout(function(){b._show(c)},b.options.mouseoverTime)}else{b._show(c)}});if(this.options.autoClose){T.event.ons(T.dom.query(b._handlerSelector),"mouseout",function(){clearTimeout(a);a=setTimeout(function(){b.close()},b.options.mouseoutTime)})}},_bindEvent:function(){var a=this.options.type;var b=this;if(a=="click"){if(T.g(b._containerId)==null){b._render()}this._bindClick()}else{if(a=="mouseover"){this._bindMouseOver()}else{if(a=="mouseover&click"||a=="click&mouseover"){this._bindMouseOver();this._bindClick()}}}if(this.options.closeButton){T.event.ons(T.q("layer-close",this._containerId),"click",function(){b.close()})}},_render:function(){T.dom.insertHTML(document.body,"beforeend",T.format(this.options.containerTemplate,this._containerId,this.options.closeButton?this.options.closeTemplate:"",this.options.className))},render:function(){this._bindEvent()},content:function(b,a){T.g(this._containerId+"Content").innerHTML=b;if(a){T.setRelatedPosition(this._containerId,a,this.options.relatedPosition,this.options.offset)}},setPosition:function(a){T.setRelatedPosition(this._containerId,a,this.options.relatedPosition,this.options.offset)},close:function(){T.hide(this._containerId)}});T.ui.Mask=T.createUI({options:{containerId:"GlobalModalLayer",zIndex:99998},_type:"mask",_init:function(){},render:function(){var a=T.g(this.options.containerId);if(!a){a=T.dom.create("div",{id:this.options.containerId,className:"mask-layer"});document.body.appendChild(a)}this._show();if(T.browser.ie&&T.browser.ie<7){T.dom.addClass(document.body,"body-masked")}this.bind()},bind:function(){var a=this;this.on(window,"resize",function(b){a._show()})},_show:function(a){var b=T.g(this.options.containerId),a=a||{};T.dom.setStyles(b,{left:0,top:0,position:"absolute",width:a.width||T.page.getWidth(),height:a.height||T.page.getHeight(),"z-index":this.options.zIndex})},show:function(){this.render()},_hide:function(){var a=T.g(this.options.containerId);T.setStyles(a,{left:-30,top:-30,position:"absolute",width:1,height:1,overflow:"hidden"})},hide:function(){var a=T.g(this.options.containerId);if(a){this._hide(a)}this.dispose();if(T.browser.ie&&T.browser.ie<7){T.dom.removeClass(document.body,"body-masked")}}});T.ui.Operations=T.createUI({options:{template:'<div id="Operations" class="operations-panel layer shared-layer" style="display:none"><div class="tip-arrow"></div><div class="tip-content"><ul id="OperationItems"></ul></div></div>',itemTemplate:'<li><a target="#{3}" data="#{2}" class="#{2}" href="#{0}" layer="##{2}Layer">#{1}</a></li>',loadingTemplate:'<div class="loading">正在加载，请稍候……</div>'},_allOperations:{history:{label:"查看历史趋势",target:"_blank",hrefTemplate:"#{baseUri}/trend/history?#{query}"},speed:{label:"对该URL进行速度诊断",target:"_blank",hrefTemplate:"#{baseUri}/opt/speed?#{query}"},area:{label:"查看按地域分布情况",target:"_blank",hrefTemplate:"#{baseUri}/pro/conn?viewType=area&flag=area&#{query}"},isp:{label:"查看按网络供应商分布情况",target:"_blank",hrefTemplate:"#{baseUri}/pro/conn?viewType=isp&flag=isp&#{query}"},word:{label:"查看相关热门搜索词",hrefTemplate:"javascript:void(0);",render:function(d,b){var a=["<tr><th class='order'>序号</th><th>搜索词</th><th>热门程度</th></tr>"];for(var c=0;c<b.length;c++){b[c].order=c+1;a.push(T.format("<tr><td class='order'>#{order}</td><td><div class='word'><a href='http://www.baidu.com/s?wd=#{gbkWord}' title='!{word}' target='_blank'>!{word}</a></div></td><td><div class='ratio' style='width:#{frequence}%'></div></td></tr>",b[c]))}if(b.length==0){a.push("<tr><td class='empty' colspan='3'>暂无数据</td></tr>")}return T.format("<div class='title'>查看与<span class='red'>&nbsp;&nbsp;!{0,30}&nbsp;&nbsp;</span>相关的热门搜索词</div><table>#{1}</table>",d,a.join(""))}},referer:{label:"查看入口页链接",hrefTemplate:"javascript:void(0);",render:function(d,b){var a=["<tr><th class='order'>排名</th><th>入口页链接<th></tr>"];for(var c=0;c<b.length;c++){a.push(T.format("<tr><td class='order'>#{0}</td><td><div class='link'><a href='!{1}' title='!{1}' target='_blank'>!{1}</a></div></td></tr>",c+1,b[c]))}if(b.length==0){a.push("<tr><td class='empty' colspan='2'>暂无数据</td></tr>")}return T.format("<div class='title'>查看以<span class='red'>&nbsp;&nbsp;!{0,30}&nbsp;&nbsp;</span>为来源的入口页面</div><table>#{1}</table>",d,a.join(""))}},record:{label:"查看站点索引情况",target:"_blank",hrefTemplate:"#{source_engine_url}!{site_domain}"},index:{label:"查看百度指数",target:"_blank",hrefTemplate:"http://index.baidu.com/main/word.php?word=#{word}"},engine:{label:"查看搜索来路URL",hrefTemplate:"javascript:void(0);",render:function(d,b){var a=["<tr><th class='order'>次数</th><th>搜索链接</th><th>第几页</th></tr>"];for(var c=0;c<b.length;c++){b[c].order=c+1;a.push(T.format("<tr><td class='order'>#{count}</td><td><div class='link'><a href='!{url}' title='!{url}' target='_blank'>!{url}</a></link></td><td>#{page}</td></tr>",b[c]))}if(b.length==0){a.push("<tr><td class='empty' colspan='3'>暂无数据</td></tr>")}return T.format("<div class='title'>查看<span class='red'>&nbsp;&nbsp;!{0,30}&nbsp;&nbsp;</span>的搜索来路URL</div><table>#{1}</table>",d,a.join(""))}}},_type:"operations",_data:null,_contentType:null,_element:null,_renderItems:function(c,f){var e=[];this._data=f;for(var d=0;d<c.length;d++){var b=c[d];b.siteId=T.config.siteInfo.id;var g={webRoot:T.config.systemConfig.webRoot,baseUri:T.config.systemConfig.baseUri,source_engine_url:b.source_engine_url,userId:T.config.userInfo.id,query:T.param(b)};if(b.id=="index"){g.word=b.word}if(b.id=="record"){if(g.source_engine_url=="www.baidu.com/s?wd="){g.site_domain="";g.source_engine_url=T.config.systemConfig.baseUri+"/opt/indexes?siteId="+T.config.siteInfo.id}else{g.site_domain="site:"+T.config.siteInfo.name;g.source_engine_url="http://"+g.source_engine_url}}var a=T.format(this._allOperations[b.id].hrefTemplate,g);e.push(T.format(this.options.itemTemplate,a,this._allOperations[b.id].label,b.id,this._allOperations[b.id].target||""))}return e.join("")},_bindEvents:function(b){var d=this;for(var c=0;c<b.length;c++){var a=b[c];if(!this[a.id]&&this._allOperations[a.id].target!="_blank"){(function(e){d[e]=new T.ui.Layer({containerId:e+"Layer",type:"click",closeButton:true,relatedOther:true,className:e+"-layer",handlerSelector:"#Operations ."+e,onchange:function(f){d._contentType=e;d[e].setPosition(d._element);d.loading();d.options.onchange(d._contentType,d._data)}})})(a.id)}if(this._allOperations[a.id].target!="_blank"){this[a.id].render()}}},show:function(b,a,c){this._element=b;if(!T.g("Operations")){T.insertHTML(document.body,"beforeEnd",this.options.template)}T.dom.empty("OperationItems");T.dom.insertHTML("OperationItems","beforeEnd",this._renderItems(a,c));T.dom.setPosition("Operations",T.getCornerPosition(b,"br"));this._bindEvents(a)},content:function(b,a){this[this._contentType].content(this._allOperations[this._contentType].render(b,a))},loading:function(){T.hide("Operations");this[this._contentType].content(this.options.loadingTemplate)}});T.ui.Paging=T.createUI({options:{containerId:null,onchange:function(a){},offset:0,pageSize:20,pageSizeRange:[20,50,100],pageSizeSelectText:"每页显示：",fuzzy:false,withoutGoto:false,round:2,previousTemplate:'<a href="javascript:void(0);" class="previous" data="#{0}">&lt;上一页</a>',pageNumberTemplate:'<a class="number#{0}" href="javascript:void(0);" data="#{1}">#{1}</a>',moreTemplate:"...",nextTemplate:'<a href="javascript:void(0);" class="next" data="#{0}">下一页&gt;</a>',pagingWrapperTemplate:'<div class="paging clearfix">#{0}</div>',pageNumberWrapperTemplate:'<div class="page-number">#{0}#{1}</div>',gotoTemplate:'第<input class="text" type="text"/>页 <a href="javascript:void(0)" class="button"><span>确定</span></a>',pageSizeWrapperTemplate:'<div class="page-size">#{0}#{1}</div>',pageSizeSelectTemplate:"<select>#{0}</select>",pageSizeOptionTemplate:'<option value="#{0}"#{1}>#{0}</option>'},_type:"paging",_total:0,_offset:0,_pageSize:0,_fuzzy:false,_pageCount:0,_currentPage:0,_init:function(){this._offset=this.options.offset;this._pageSize=this.options.pageSize;this._fuzzy=this.options.fuzzy},_computeParams:function(){this._pageCount=Math.ceil(this._total/this._pageSize);if(this._pageCount==0){this._pageCount=1}this._currentPage=this._offset/this._pageSize+1},_computePageRange:function(b,c,a){var e=c-a;var d=c+a;if(e<1){e=1;d=Math.min(2*a+1,b)}if(d>b){d=b;e=Math.max(b-2*a,1)}return{from:e,to:d}},_renderPageSize:function(){if(!T.lang.isArray(this.options.pageSizeRange)||this.options.pageSizeRange.length==0){return""}if(this._total<=this.options.pageSizeRange[0]){return""}var c="";for(var b in this.options.pageSizeRange){var a=this.options.pageSizeRange[b];c+=T.format(this.options.pageSizeOptionTemplate,a,a==this._pageSize?' selected="selected"':"")}return T.format(this.options.pageSizeWrapperTemplate,this.options.pageSizeSelectText,T.format(this.options.pageSizeSelectTemplate,c))},_renderPaging:function(){if(this._pageCount<=1){return""}var c="";if(this._currentPage>1){c+=T.format(this.options.previousTemplate,this._currentPage-1)}var b=this._computePageRange(this._pageCount,this._currentPage,this.options.round);if(!this._fuzzy){if(b.from>1){c+=T.format(this.options.pageNumberTemplate,"",1)+this.options.moreTemplate}for(var a=b.from;a<=b.to;a++){c+=T.format(this.options.pageNumberTemplate,this._currentPage==a?" selected":"",a)}if(b.to<this._pageCount){c+=this.options.moreTemplate+T.format(this.options.pageNumberTemplate,"",this._pageCount)}}if(this._currentPage<this._pageCount){c+=T.format(this.options.nextTemplate,this._currentPage+1)}return T.format(this.options.pageNumberWrapperTemplate,c,this._fuzzy||this.options.withoutGoto?"":this.options.gotoTemplate)},_changePage:function(c){var d=T.event.get(c).target;var b=T.getAttr(d,"data");if(b==null){return}var a=parseInt(b,10);var e=(a-1)*this._pageSize;this._offset=e;this._currentPage=a;this.options.onchange({offset:this._offset,currentPage:this._currentPage,pageSize:this._pageSize,paging:this})},_gotoPage:function(b){var c=T.q("text",this.options.containerId)[0];var a=parseInt(T.trim(c.value),10);if(isNaN(a)||a>this._pageCount||a==this._currentPage||a<1){return}var d=(a-1)*this._pageSize;this._offset=d;this._currentPage=a;this.options.onchange({offset:this._offset,currentPage:this._currentPage,pageSize:this._pageSize,paging:this})},_changePageSize:function(a){var b=T.event.get(a).target;this._pageSize=parseInt(b.value,10);this._offset=0;this._computeParams();this.options.onchange({offset:this._offset,currentPage:this._currentPage,pageSize:this._pageSize,paging:this})},_bindEvent:function(){T.event.ons(T.q("page-number",this.options.containerId),"click",T.fn.bind(this._changePage,this));T.event.ons(T.q("button",this.options.containerId),"click",T.fn.bind(this._gotoPage,this));T.event.ons(T.dom.query("#"+this.options.containerId+" div.page-size select"),"change",T.fn.bind(this._changePageSize,this))},clear:function(){T.dom.empty(this.options.containerId)},render:function(c,d,b){if(!T.g(this.options.containerId)){return}if(c!=null){this._total=c}if(d!=null){this._offset=d}if(b!=null){this._fuzzy=b}if(c!=null||d!=null){this._computeParams()}T.dom.empty(this.options.containerId);var a=this._renderPageSize()+this._renderPaging();if(a!=null&&a.length>0){T.insertHTML(this.options.containerId,"beforeend",T.format(this.options.pagingWrapperTemplate,a));this._bindEvent()}}});T.RecordTarget=T.createClass({_type:"record-target",options:{sign:"recordable",recordUri:null,memo:null,onchange:function(a){}},_memo:null,_init:function(){this.options.recordUri=this.options.recordUri||T.config.systemConfig.memoUri;this._memo=T.object.clone(this.options.memo||{});T.on(document.body,"mousedown",T.fn.bind(this.reordHandler,this))},reordHandler:function(f){var h=T.event.getTarget(f);if(!(h[this.options.sign]||T.dom.hasClass(h,this.options.sign))){return}var c=h.id||"",b=T.getAttr(h,"memo"),d,e;if(b){memoObj=T.json.parse(b);if(memoObj.hasOwnProperty("id")){c=memoObj.id}if(memoObj.hasOwnProperty("type")){d=memoObj.type}if(memoObj.hasOwnProperty("global")){e=memoObj.global}}var g={elementId:c,type:d||""};if(!e){T.extend(g,{appId:T.config.appInfo.id,pageId:T.config.pageInfo.id})}var a;if(this._memo.hasOwnProperty(c)){if(this._memo[c]){a=0}else{a=1}}else{if(T.dom.hasClass(h,"close")){a=1}else{if(T.dom.hasClass(h,"open")){a=0}}}this._memo[c]=a;g.status=a;this.options.onchange(g);this.postData(g)},postData:function(b){var a=(new Date()).getTime();var c=window["bd_holmes"+a]=new Image();c.src=this.options.recordUri+"?r="+a+"&"+T.url.jsonToQuery(b,function(e,d){return encodeURIComponent(e)});c.onload=c.onerror=function(){c=null}}});T.ui.SelectGroup=T.createUI({_type:"select_group",options:{containerId:null,label:"",items:[],selectedItems:[],separator:"",shortcuts:true,wrapperTemplate:'<span id="#{1}_container">#{0}<select id="#{1}" level="#{3}">#{2}</select></span>',optionTemplate:'<option value="!{0}"#{2}>!{1}</option>',onchange:function(a){}},_showLevel:1,_values:[],_getData:function(e,g,b,f){if(f>b){return null}for(var c in e){var d=e[c];if(b==f&&d.id==g){return d}else{var a=this._getData(d.children,g,b,f+1);if(a!=null){return a}}}return null},_select:function(e,d){var b=this._getData(this.items,e,d,1);if(b==null){return}var c=d+1;for(var a=c;a<=this._showLevel;a++){T.dom.remove(this.getId()+"_"+a+"_container")}this._values.splice(d-1,this._values.length-d+1);this._values[d-1]=e;if(b&&b.children&&b.children.length>0){this._showLevel=c;this._values[d]=b.children[0].id;this._render(b.children,d)}else{this._showLevel=d}},_getLabels:function(d){var e=[];var a=this.items;for(var c=0;c<d.length;c++){if(a==null||a.length==0){break}for(var b in a){if(d[c]==a[b].id){e.push(a[b].label);a=a[b].children;break}}}return e},_change:function(b,a){this._select(b,a);if(this._values.length==1&&this._values[0]==this.items[0].id){this.options.onchange(T.object.clone(this._values),[])}else{this.options.onchange(T.object.clone(this._values),this._getLabels(this._values))}},_render:function(a,g){if(a){var e="";for(var c in a){var f=a[c];e+=T.format(this.options.optionTemplate,f.id,f.label,f.id==this.options.selectedItems[g||0]?' selected="selected"':"")}var b=this.getId()+"_"+this._showLevel;if(T.g(this.getId("search_shotcuts_container"))){T.insertHTML(this.getId("search_shotcuts_container"),"beforeBegin",T.format(this.options.wrapperTemplate,(this._showLevel==1?'<label class="label">'+this.options.label+"</label>":this.options.separator),b,e,this._showLevel))}else{T.insertHTML(this.options.containerId,"beforeEnd",T.format(this.options.wrapperTemplate,(this._showLevel==1?'<label class="label">'+this.options.label+"</label>":this.options.separator),b,e,this._showLevel))}var d=this;T.on(b,"change",function(){d._change(this.value,parseInt(T.getAttr(this,"level")))})}},_getShortcuts:function(a,d){for(var b in a){var c=a[b];if(c.shortcut){if(d==null){c.allId=c.id}else{c.allId=""+d+","+c.id}this._shortcuts.push(c)}if(c.children&&c.children.length>0){if(d==null){this._getShortcuts(c.children,c.id)}else{this._getShortcuts(c.children,""+d+","+c.id)}}}},_rendShortcuts:function(){this._getShortcuts(this.items);if(this._shortcuts.length==0){return}var b="";for(var c in this._shortcuts){var a=this._shortcuts[c];b+=T.format('<a href="javascript:void(0)" id="#{0}" data="#{1}">#{2}</a>',this.getId("search_shotcuts_"+a.id),a.allId,a.label)}T.insertHTML(this.options.containerId,"beforeEnd",T.format('<span id="#{0}" class="search-shotcuts-container">#{1}</span>',this.getId("search_shotcuts_container"),b));var d=this;for(var c in this._shortcuts){var a=this._shortcuts[c];T.on(this.getId("search_shotcuts_"+a.id),"click",function(){d.options.onchange([T.getAttr(this,"data")],[this.innerHTML])})}},_renderStyles:function(b){var f,e,d=T.g(this.getId()+"_"+this._showLevel);for(var c=0,a=b.length;c<a;c++){f=b[c].style||false;if(f){e=T.dom.query("option[value="+b[c].id+"]",d);T.element(e).each(function(g){T.dom.setStyles(g,f)})}}},render:function(a){if(!T.g(this.options.containerId)){return}if(a){this.items=a;T.dom.empty(this.options.containerId)}this._render(this.items);if(this.options.shortcuts){this._shortcuts=[];this._rendShortcuts()}if(this.options.selectedItems){for(var b=0;b<this.options.selectedItems.length;b++){var c=this.options.selectedItems[b];this._select(c,b+1)}}this._renderStyles(this.items)},disable:function(){for(var a=1;a<=this._showLevel;a++){T.g(this.getId()+"_"+a).disabled=true}},enable:function(){for(var a=1;a<=this._showLevel;a++){T.g(this.getId()+"_"+a).disabled=false}},select:function(a){T.g(this.getId()+"_"+this._showLevel).value=a},getGroupId:function(a){return this.getId()+"_"+a},reset:function(){this._select(this.items[0].id,1);this.select(this.items[0].id);this.options.onchange([],[])},getSelectedLabels:function(){return this._getLabels(this._values)}});var SelectTimeGroup=function(k,j,i){var h=this;h.st=k;h.et=j;var i=i||6;var e=T.g("Hour");var b=T.g("Day");var d=T.g("FlashMonth");var c=T.g("FlashWeek");var a=T.g("FlashDay");var g=function(){if(b.checked){a.disabled=false;if((h.et-h.st)>(1000*3600*24*7)){c.disabled=false;if((h.et-h.st)>(1000*3600*24*31)){d.disabled=false}else{d.disabled=true}}else{c.disabled=true;d.disabled=true}}else{c.disabled=true;d.disabled=true;a.disabled=true}};h.onchange=function(){};h.setGran=function(l,n,m){h.st=l;h.et=n;switch(m){case 6:e.checked=true;break;case 5:b.checked=true;a.checked=true;break;case 4:b.checked=true;c.checked=true;break;case 3:b.checked=true;d.checked=true;break;default:e.checked=true}g();h.onchange(m)};var f=function(){h.setGran(h.st,h.et,i)};f();T.each(T.dom.query(".time-select input"),function(l){T.on(l,"click",function(o){g();var n=T.dom.query(".first-gran input:checked")[0];if(n==T.g("Hour")){h.onchange(6)}else{var m=T.dom.query(".second-gran input:checked")[0];if(m==T.g("FlashMonth")){h.onchange(3)}else{if(m==T.g("FlashWeek")){h.onchange(4)}else{if(m==T.g("FlashDay")){h.onchange(5)}}}}})})};T.ui.Selectable=T.createUI({_type:"selectable",options:{containerId:null,elementClazz:"select-element",selectedClazz:"selected",disableClazz:"disabled",single:true,limit:4,disable:false,onchange:function(a){},onselect:function(){}},selected:null,_trigger:true,_init:function(){var c=this;var b=c.options;var a=T.g(b.containerId);c.selected=[];T.event.on(a,"click",function(m){if(b.disable){return}var d,n=T.event.getTarget(m);if(T.dom.hasClass(n,b.elementClazz)){d=n}else{d=T.dom.getAncestorBy(n,function(e){return(e==a)||T.dom.hasClass(e,b.elementClazz)})}if(d==a||!d){return}var h=T.dom.query("."+b.elementClazz,a);var l=T.array.indexOf(h,d);if(b.onselect.call(c,d,l)===false){return}if(T.dom.hasClass(d,b.disableClazz)){return}if(T.dom.hasClass(d,b.selectedClazz)){return}if(b.single){T.array.each(h,function(e){T.dom.removeClass(e,b.selectedClazz)});T.dom.addClass(d,b.selectedClazz);c.selected=[d]}else{if(T.dom.hasClass(d,b.selectedClazz)){T.dom.removeClass(d,b.selectedClazz);c.selected=T.array.filter(c.selected,function(e){return e!=d})}else{T.dom.addClass(d,b.selectedClazz);if(T.dom.getAttr(d,"data")==="0"){var g=c.selected;for(var k=0,f=g.length;k<f;k++){c.unselect(T.dom.getAttr(g[0],"data"))}}else{if(c.selected.length<2){if(c.selected[0]&&T.dom.getAttr(c.selected[0],"data")==="0"){c.unselect(0)}}}c.selected.push(d);var j;while(c.selected.length>b.limit){j=c.selected.shift();T.dom.removeClass(j,b.selectedClazz)}}}c._trigger&&b.onchange.call(c,c.selected)});this.initSelected()},initSelected:function(){var a=T.g(this.options.containerId);this.selected=[];var c=T.dom.query("."+this.options.elementClazz,a);for(var b=0;b<c.length;b++){var d=c[b];if(T.dom.hasClass(d,this.options.selectedClazz)){this.selected.push(d)}}},select:function(e,d){var g=this,c=g.options;var a=T.g(c.containerId);var h=this.splat(e);var f=T.dom.query("."+c.elementClazz,a);var b=g._trigger;g._trigger=d||d==null;T.array.each(h,function(i){if(!c.single&&g.selected.length>=c.limit){return false}if(i=="first"){i=0}else{if(i=="last"){i=f.length-1}}if(i!=null&&!isNaN(i)){i=f[i]}if(!i){return}T.event.fire(i,"click");if(c.single){return false}});g._trigger=b},reset:function(c,b){var e=this,a=e.options;var d=e.selected||[];T.array.each(d,function(f){T.dom.removeClass(f,a.selectedClazz)});e.selected.length=0;this.select(c,b)},get:function(c){var e=this,b=e.options;var a=T.g(b.containerId);var d=T.dom.query("."+b.elementClazz,a);if(c=="all"){return d}else{if(c=="first"){c=0}else{if(c=="last"){c=d.length-1}}}return d[c]},disable:function(){this.options.disable=true},enable:function(){this.options.disable=false},splat:function(a){if(a==null){return[]}if(Object.prototype.toString.call(a)=="[object Array]"){return a}return[a]},unselect:function(a){if(!isNaN(a)){a=a.toString()}var c=T.array.find(this.selected,function(d){if(T.getAttr(d,"data")===a){return true}else{return false}});if(c){T.dom.removeClass(c,this.options.selectedClazz);T.array.remove(this.selected,c)}var b=[];T.array.forEach(this.selected,function(d){b.push(T.dom.getAttr(d,"data"))});return b}});T.ShortDate=T.createClass({options:{containerId:"DateSelectBar",onchange:function(){}},_init:function(){var a=T.g(this.options.containerId).getElementsByTagName("A");for(var b=0,c=a.length;b<c;b++){T.on(a[b],"click",this._selectHandler())}},_selectHandler:function(){var a=this;return function(d){T.event.preventDefault(d);var g=this.href.lastIndexOf("#")+1;var b=parseInt(this.href.substring(g),10);if(b!=0){var c=(b==-1)?-1:b;var f=(b==-1)?-1:0;var b=b-1;a.options.onchange([a._recentDate(c),a._recentDate(f)])}else{a.options.onchange([T.config.systemConfig.now,+T.config.systemConfig.now])}a.removeClass();this.className="cur"}},removeClass:function(){var a=T.g(this.options.containerId).getElementsByTagName("A");for(var b=0,c=a.length;b<c;b++){T.removeClass(a[b],"cur")}},_dateDiff:function(b,a){return parseInt(Math.abs(b-a)/1000/60/60/24)},_recentDate:function(a){return parseInt(T.config.systemConfig.now,10)+a*3600*24*1000},showDateTip:function(c,g){var b=baidu.G("Date");var f=baidu.date.format;var a=f(new Date(c),"yyyy/MM/dd");var e=f(new Date(g),"yyyy/MM/dd");var d=(a==e)?a:(a+"~"+e);if(b){b.innerHTML="("+d+")"}T.dom.one(".report-help")&&(T.dom.setStyle(T.dom.one(".tip-arrow"),"left",(T.dom.one(".report-help").offsetLeft+2)+"px"))}});T.ui.Slider=T.createUI({options:{sliderWrapper:"slider-wrapper",direction:"horizontal",pause:1500,duration:200,startIndex:0,auto:true,pager:true,pagerEvent:"click",controls:true,lazyLoad:false},_init:function(){this.sliderWrapper=T.g(this.options.sliderWrapper);this.slider=T.dom.one("ul",this.sliderWrapper);var c=T.dom.query("li",this.slider);var d=this.slidesLen=c.length;this.slides=c;if(d===0){return}this.timer=null;this.currentIndex=this.options.startIndex;this.options.width=this.options.width?this.options.width:c[0].offsetWidth;this.options.height=this.options.height?this.options.height:c[0].offsetHeight;if(this.options.direction==="horizontal"){this.changeOffset=this.options.width;this.directionProperty="left";this.sizeProperty="width"}else{this.changeOffset=this.options.height;this.directionProperty="top";this.sizeProperty="height"}this.options.tween=this.options.tween||function(g,f,i,h){return -i*((g=g/h-1)*g*g*g-1)+f};T.dom.setStyles(this.sliderWrapper,{overflow:"hidden",position:"relative",width:this.options.width+"px",height:this.options.height+"px"});var e={position:"relative",overflow:"hidden",top:0,left:0};if(this.options.direction==="horizontal"){e.width=(this.options.width*d)+"px";e.height=this.options.height+"px"}else{e.width=this.options.width+"px";e.height=(this.options.height*d)+"px"}T.dom.setStyles(this.slider,e);var a={height:this.options.height+"px",width:this.options.width+"px"};if(this.options.direction==="horizontal"){a["float"]="left"}for(var b=0;b<d;b++){T.dom.setStyles(c[b],a)}this.start()},start:function(){this.renderHtml();this.bindEvent();this.run(this.options.startIndex)},renderHtml:function(){if(this.sliderWrapper){var c=T.dom.one(".slider-controls",this.sliderWrapper);if((!this.options.pager&&!this.options.controls)||this.slidesLen<=1||c){return}var a=this.options;var d=[];c=document.createElement("div");T.dom.addClass(c,"slider-controls");if(a.pager){d.push('<ol class="slider-pager">');for(var b=0;b<this.slidesLen;b++){d.push("<li>"+(b+1)+"</li>")}d.push("</ol>")}if(a.controls){d.push('<div class="slider-control-direction">');d.push('<a href="#" class="slider-prev">prev</a>');d.push('<a href="#" class="slider-next">next</a>');d.push("</div>")}c.innerHTML=d.join("");if(a.pager||a.controls){this.sliderWrapper.appendChild(c)}}},bindEvent:function(){var a=this;if(this.options.pager){var b=T.dom.query(".slider-pager");T.event.ons(b,this.options.pagerEvent,function(f){var d=T.event.getTarget(f);if(d.nodeName.toLowerCase()==="li"){a.run(d.innerHTML-1)}})}if(this.options.controls){var c=T.dom.query(".slider-control-direction");T.event.ons(c,"click",function(f){var d=T.event.getTarget(f);if(d.className==="slider-prev"){a.prev()}else{a.next()}})}},run:function(b){if(b===undefined){b=this.currentIndex}else{if(b>=this.slidesLen){b=0}else{if(b<0){b=this.slidesLen-1}}}this.currentIndex=b;this.targetPosition=this.changeOffset*this.currentIndex*(-1);this.t=0;this.b=parseInt(this.slider.style[this.directionProperty],10);this.c=this.targetPosition-this.b;if(this.options.lazyLoad){var a=T.dom.one("img",this.slides[this.currentIndex]);if(T.dom.getAttr(a,"src")===""){T.dom.setAttr(a,"src",T.dom.getAttr(a,"data-src"))}}this.addControlStyle();this.move()},addControlStyle:function(){var a=T.dom.query(".slider-pager > li",this.sliderWrapper);if(a.length!==0){for(var b=0;b<this.slidesLen;b++){T.dom.removeClass(a[b],"selected")}T.dom.addClass(a[this.currentIndex],"selected")}},move:function(){window.clearTimeout(this.timer);if(this.c&&this.t<this.options.duration){this.moveTo(Math.round(this.options.tween(this.t++,this.b,this.c,this.options.duration)));this.timer=window.setTimeout(T.fn.bind(this.move,this),0)}else{if(this.options.auto){this.timer=window.setTimeout(T.fn.bind(this.next,this),this.options.pause)}}},moveTo:function(a){T.dom.setStyle(this.slider,this.directionProperty,a+"px")},next:function(){this.run(this.currentIndex+1)},prev:function(){this.run(this.currentIndex-1)},stop:function(){clearTimeout(this.timer)}});(function(){T.SlideTrans=T.createClass({initialize:function(d,h,g,e,f){this._slider=baidu.g(h);this._container=baidu.g(d);this._timer=null;this._count=Math.abs(g);this._target=0;this._t=this._b=this._c=0;this._size=f||8;this.Index=0;this.SetOptions(e);this.Auto=!!this.options.Auto;this.Duration=Math.abs(this.options.Duration);this.Time=Math.abs(this.options.Time);this.Pause=Math.abs(this.options.Pause);this.Tween=this.options.Tween;this.onStart=this.options.onStart;this.onFinish=this.options.onFinish;var c=!!this.options.Vertical;this._css=c?"top":"left";var i=a(this._container).position;i=="relative"||i=="absolute"||(this._container.style.position="relative");this._container.style.overflow="hidden";this._slider.style.position="absolute";this.Change=this.options.Change?this.options.Change:this._slider[c?"offsetHeight":"offsetWidth"]/this._count},SetOptions:function(c){this.options={Vertical:true,Auto:true,Change:0,Duration:50,Time:10,Pause:4000,onStart:function(){},onFinish:function(){},Tween:b.Quart.easeOut};T.extend(this.options,c||{})},Run:function(c){if(c==this._count){if(this._css=="left"){var g=baidu.g("SliderTable").rows[0];g.appendChild(g.children[0].cloneNode(true))}else{var f=baidu.g("users_logos");for(var e=0;e<this._size;e++){var d=f.children[e].cloneNode(true);f.appendChild(d)}}}c==undefined&&(c=this.Index);c<0&&(c=this._count-1)||c>this._count&&(c=0);this._target=-Math.abs(this.Change)*(this.Index=c);this._t=0;this._b=parseInt(a(this._slider)[this.options.Vertical?"top":"left"]);this._c=this._target-this._b;this.onStart();this.Move()},Move:function(){clearTimeout(this._timer);if(this._c&&this._t<this.Duration){this.MoveTo(Math.round(this.Tween(this._t++,this._b,this._c,this.Duration)));this._timer=setTimeout(baidu.fn.bind(this.Move,this),this.Time)}else{if(this.Index==this._count){this.MoveTo(0);if(this._css=="left"){var e=baidu.g("SliderTable").rows[0];e.removeChild(e.children[e.cells.length-1])}else{var d=baidu.g("users_logos");for(var c=0;c<this._size;c++){var f=d.children[d.children.length-1];d.removeChild(f)}}}else{this.MoveTo(this._target)}this.Auto&&(this._timer=setTimeout(baidu.fn.bind(this.Next,this),this.Pause))}},MoveTo:function(c){baidu.setStyle(this._slider,this._css,c+"px")},Next:function(){this.Run(++this.Index)},Previous:function(){this.Run(--this.Index)},Stop:function(){clearTimeout(this._timer);this.MoveTo(this._target)}});var b={Quart:{easeOut:function(f,e,h,g){return -h*((f=f/g-1)*f*f*f-1)+e}}};var a=function(c){return c.currentStyle||document.defaultView.getComputedStyle(c,null)}})();T.ui.Summary=T.createUI({_type:"summary",options:{containerId:null,tdTemplate:'<td#{last}><span class="text">#{text}#{tip}</span><br/><span class="value">#{value}</span>#{compare}</td>',tdTemplate2:'<td#{last}><span class="value flag#{flag}">#{value}</span>#{compare}</td>',compareDataTemplate:'<br/><span class="compare-value">#{0}</span>',tableTemplate:'<table class="summary"><tbody><tr>#{0}</tr></tbody></table>',lastClass:' class="last"',oncreate:function(f,p,d,l,t){var s=this;if(l[f].id=="brand_new_user_count"||l[f].id=="upgrade_user_count"){return false}else{if(l[f].id=="new_user_count"&&l[f+1]&&l[f+1].id=="upgrade_user_count"){var c=l[f];var e=l[f+1];var q=l[f+2];var i=(f==l.length-1?this.options.lastClass:"");var u=d[0][f];var n=d[0][f+1];var j=d[0][f+2];var h;var o=function(v){if(!v||v=="--"){return 0}return parseInt(v.split(",").join(""),10)};var b='<td#{last}><div class="new-user-div">                                    <div class="clearfix">                                    <span class="text">#{text}#{tip}</span>                                    <span class="new-user-value" title="#{value}">#{value}</span>                                    <span class="new-user-value compare-value">#{compare}</span></div>                                    <div class="new-user-bar upgrade"><div id="brand-new-div" class="new-user-brand brand" style="width:#{brandWidth}"></div></div>                                    <div class="clearfix">                                    <span class="text">#{upgradeText}<a href="javascript:void(0)" data="#{upgradeId}" class="help">&nbsp;</a></span>                                    <span class="new-user-value" title="#{upgradeValue}">#{upgradeValue}</span>                                    <span class="new-user-value compare-value">#{upgradeCompare}</span>                                    </div><div id="brand-new-count-div" style="display:none;">                                    <span class="text">#{brandText}</span>                                    <span class="new-user-value" title="#{brandValue}">#{brandValue}</span>                                    <span class="new-user-value compare-value">#{brandCompare}</span>                                    </div>                                    </div></td>';var m='<td#{last}><span class="value flag#{flag}">#{value}</span>#{compare}</td>';if(T.object.isPlain(u)){p.push(T.format(m,{id:c.id,text:c.label,value:T.i18n.number.formatNumber(u.val),flag:u.flag,compare:t?T.format(this.options.compareDataTemplate,d[1][f]):""}))}else{var a='<a href="javascript:void(0)" data="#{id}" class="help">&nbsp;</a>';var g=T.array.find(T.config.indexInfo.indicators,function(v){return v.id==c.id});var k="";if(g&&g.tip){k=T.format(a,{id:c.id})}if(o(u)==0){return true}h=o(j)*100/o(u);h=h<5?5:h;h=(h>95?95:h)+"%";p.push(T.format(b,{tip:k,text:c.label,value:u,last:i,upgradeId:e.id,upgradeText:e.label,upgradeValue:n,brandWidth:h,brandText:q.label,brandValue:j,compare:t?d[1][f]:"",upgradeCompare:t?d[1][f+1]:"",brandCompare:t?d[1][f+2]:""}))}var r=T.dom.getAttr(this.options.containerId,"bound");if(!r){T.event.on(T.g(this.options.containerId),"mouseover",function(x){var w=T.event.getTarget(x);if(T.dom.hasClass(w,"new-user-brand")){T.dom.removeClass(w,"brand");T.dom.addClass(w,"upgrade");T.dom.removeClass(w.parentNode,"upgrade");T.dom.addClass(w.parentNode,"brand");var v=T.g("brand-new-count-div");T.dom.show(v);T.dom.hide(T.dom.prev(v))}});T.event.on(T.g(this.options.containerId),"mouseout",function(x){var w=T.event.getTarget(x);if(T.dom.hasClass(w,"new-user-brand")){T.dom.removeClass(w,"upgrade");T.dom.addClass(w,"brand");T.dom.removeClass(w.parentNode,"brand");T.dom.addClass(w.parentNode,"upgrade");var v=T.g("brand-new-count-div");T.dom.show(T.dom.prev(v));T.dom.hide(v)}});T.dom.setAttr(this.options.containerId,"bound","true")}return false}}}},_render:function(e,d){var b=[];var f=(e[1]&&e[1].length>0);for(var c=0;c<d.length;c++){if(typeof this.options.oncreate=="function"){var g=this.options.oncreate.call(this,c,b,e,d,f);if(g===false){continue}}var h=d[c];var n=(c==d.length-1?this.options.lastClass:"");var a=e[0][c];var m='<a href="javascript:void(0)" data="#{id}" class="help">&nbsp;</a>';var l=T.array.find(T.config.indexInfo.indicators,function(i){return i.id==h.id});var k="";if(l&&l.tip){k=T.format(m,{id:h.id})}if(f){if(T.object.isPlain(a)){if(isNaN(a.val)){var j=a.val.charAt(a.val.length-1)==="%"?T.i18n.number.formatNumber(a.val)+"%":T.i18n.number.formatNumber(a.val)}else{var j=T.i18n.number.formatNumber(a.val)}b.push(T.format(this.options.tdTemplate2,{id:h.id,text:h.label,value:j,flag:a.flag,compare:T.format(this.options.compareDataTemplate,e[1][c]),last:n}))}else{b.push(T.format(this.options.tdTemplate,{tip:k,text:h.label,value:a,compare:T.format(this.options.compareDataTemplate,e[1][c]),last:n}))}}else{if(T.object.isPlain(a)){b.push(T.format(this.options.tdTemplate2,{id:h.id,text:h.label,value:T.i18n.number.formatNumber(a.val),flag:a.flag}))}else{b.push(T.format(this.options.tdTemplate,{tip:k,text:h.label,value:a,last:n}))}}}return T.format(this.options.tableTemplate,b.join(""))},render:function(b,a){if(!T.g(this.options.containerId)){return}T.dom.empty(this.options.containerId);T.insertHTML(this.options.containerId,"beforeend",this._render(b,a))}});T.ui.Table=T.createUI({_type:"table",options:{containerId:null,showNumber:true,multilevel:false,checkable:false,hasOperations:false,onchange:function(a){},onexpand:function(a){},onoperate:function(a){},oncheck:function(a){},loadingText:'<div class="loading">正在加载，请稍候……</div>',noDataText:'<div class="empty">暂无数据</div>',sumText:"当页汇总",className:"table",thStyleFn:null,thTextFn:null,thTemplate:'<td colspan="#{colspan}" data="#{id}" class="#{className}"><div class="td-content"><label>#{label}</label>#{tip}</div></td>',theadTemplate:"<thead>#{0}</thead>",tdStyleFn:null,tdTextFn:null,tdTemplate:'<td colspan="#{colspan}" rowspan="#{rowspan}" class="#{className}" data="#{data}" id="#{id}"><div class="td-content" title="#{title}">#{label}</div></td>',operationTdTemplate:'<td colspan="#{colspan}" class="#{className}" id="#{id}"><div class="td-content" data="#{data}" layer="#Operations">#{label}</div></td>',tbodyTemplate:"<tbody>#{0}</tbody>",tfootTemplate:"<tfoot>#{0}</tfoot>",trTemplate:'<tr class="#{1}" id="#{2}">#{0}</tr>',tableTemplate:'<table class="#{2}">#{0}#{1}#{3}</table>',tipTemplate:'<tbody><tr><td colspan="#{colspan}">#{tip}</td></tr></tbody>'},_thead:null,_tbody:null,_tfoot:null,_group:1,_sortField:null,_offset:null,_sortDir:null,_expandTrId:null,_continuous:false,_renderLoading:function(){return T.format(this.options.tableTemplate,this._renderThead(),this._renderTipBody(this.options.loadingText),this.options.className)},_renderTable:function(){if(this._tbody==null||this._tbody.length==0){return T.format(this.options.tableTemplate,this._renderThead(),this._renderTipBody(this.options.noDataText),this.options.className)}else{return T.format(this.options.tableTemplate,this._renderThead(),this._renderTbody(),this.options.className,this._renderTfoot())}},_renderThead:function(){var a=[];if(this._thead&&this._thead.length>0){this._prefixTds(a,-1,false,"&nbsp;");for(var b in this._thead){var c=this._thead[b];if(c.sortable){c.className+=" sortable"}if(c.id==this._sortField){c.className+=" "+this._sortDir}if(c.tip){c.tip=T.format('<a class="help" data="#{id}" href="javascript:void(0)">&nbsp;</a>',c)}var d=c.colspan||1;delete c.colspan;a.push(T.format(this.options.thTemplate,c));for(var b=d-1;b>0;b--){a.push("<td></td>")}if(b==0&&this.options.hasOperations){a.push(T.format(this.options.thTemplate,{className:"operateCol",label:"&nbsp;"}))}}}else{a.push(T.format(this.options.thTemplate,{label:"&nbsp;"}))}return T.format(this.options.theadTemplate,T.format(this.options.trTemplate,a.join("")))},_renderTipBody:function(b){var c=1;if(this._thead&&this._thead.length>0){c=0;for(var a=this._thead.length-1;a>=0;a--){c+=this._thead[a].colspan||1}if(this.options.checkable){c++}if(this.options.showNumber){c++}if(this.options.multilevel){c++}if(this.options.hasOperations){c++}}return T.format(this.options.tipTemplate,{colspan:c,tip:b})},_renderTbody:function(){var a=[];for(var f=0;f<this._tbody.length/this._group;f++){for(var e=0;e<this._group;e++){var h=this._tbody[f*this._group+e];var d=h[0].expandable==false?false:true;var b=h[0].hasOperation==false?false:true;var g=[];if(e==0){this._prefixTds(g,f,d,f+1+this._offset)}else{this._prefixTds(g,f,d)}for(var c in h){g.push(T.format(this.options.tdTemplate,h[c]));if(c==0&&this.options.hasOperations){if(this.options.hasOperations&&b&&e==0){g.push(T.format(this.options.operationTdTemplate,{className:"operateCol",label:"&nbsp;",data:f}))}else{g.push(T.format(this.options.tdTemplate,{className:"",label:"&nbsp;",data:f}))}}}if(this._group==e+1){a.push(T.format(this.options.trTemplate,g.join(""),"line",this._getRowId(f)))}else{a.push(T.format(this.options.trTemplate,g.join("")))}}}return T.format(this.options.tbodyTemplate,a.join(""))},_prefixTds:function(c,e,b,d,a){if(this.options.multilevel){c.push(T.format(this.options.tdTemplate,{id:"expand_"+(this._getRowId(e)||""),className:(b&&d!=null)?"expandCol":"noexpandCol",data:e!=null?e:"",label:"&nbsp;"}))}if(this.options.checkable){if(a===false){c.push(T.format(this.options.tdTemplate,{className:"numberCol",label:"&nbsp;",rowspan:e==-1?1:this._group}))}else{c.push(T.format('<td class="numberCol"><input class="checkableCol" type="checkbox" data="#{data}" id="#{id}"></td>',{id:"checkable_"+(this._getRowId(e)||""),data:e!=null?e:""}))}}if(this.options.showNumber&&d){c.push(T.format(this.options.tdTemplate,{className:"numberCol",label:d,rowspan:e==-1?1:this._group}))}},_renderTfoot:function(){var a=[];for(var d=0;d<this._tfoot.length;d=(++d)*this._group){for(var c=0;c<this._group;c++){var f=this._tfoot[d+c];var e=[];this._prefixTds(e,-1,true,"&nbsp;",false);for(var b in f){e.push(T.format(this.options.tdTemplate,f[b]));if(b==0&&this.options.hasOperations){e.push(T.format(this.options.tdTemplate,{className:"operateCol",label:"&nbsp;"}))}}a.push(T.format(this.options.trTemplate,e.join("")))}}return T.format(this.options.tfootTemplate,a.join(""))},_renderTdStyle:function(b){var a=b.type||"";if(T.lang.isFunction(this.options.tdStyleFn)){a=this.options.tdStyleFn(a,b)}return a},_renderThText:function(a){var b=a.label;if(T.lang.isFunction(this.options.thTextFn)){return this.options.thTextFn(b,a)}return b},_renderTdText:function(a,c){var b=c.format?c.format(a):a;if(T.lang.isFunction(this.options.tdTextFn)){return this.options.tdTextFn(b,field,a)}return b},_sort:function(b){var a="desc";var d=b.currentTarget.parentNode.parentNode;var c=T.getAttr(d,"data");if(c==this._sortField&&this._sortDir=="desc"){a="asc"}this._sortField=c;this._sortDir=a;this.loading();this.options.onchange(c+","+a)},_expand:function(a){var c=a.currentTarget;T.dom.toggleClass(c,"open");var d=parseInt(T.getAttr(c,"data"),10);var b=this._getRowId(d);if(T.dom.hasClass(c,"open")){if(T.dom.hasClass(c,"loaded")){T.each(T.dom.query("tr."+b),function(e){T.show(e)})}else{T.dom.addClass(c,"mini-loading");this.options.onexpand({target:c,expandTrId:b,rowIndex:d,data:T.object.clone(this._tbody[d*this._group][0].data)})}}else{T.each(T.dom.query("tr."+b),function(e){T.hide(e)})}},_operate:function(a){var b=a.currentTarget;var c=parseInt(T.getAttr(b,"data"),10);this.options.onoperate({target:b,rowIndex:c,data:T.object.clone(this._tbody[c*this._group][0].data)})},_check:function(d){var f=d.currentTarget;var h=parseInt(T.getAttr(f,"data"),10);var e,c=f.checked;var g=T.dom.one("#"+this.options.containerId+" thead .checkableCol");var a=T.dom.query("#"+this.options.containerId+" tbody .checkableCol");if(!this._checkedItems){this._checkedItems=this._checkedItems||[];for(var b=0;b<a.length;b++){this._checkedItems[b]=false}}if(h==-1){for(var b=0;b<a.length;b++){this._checkedItems[b]=(a[b].checked=c)&&T.object.clone(this._tbody[b*this._group][0].data)}}else{e=T.object.clone(this._tbody[h*this._group][0].data);this._checkedItems[h]=c&&e}this.checkedItems=[];for(var b=0;b<this._checkedItems.length;b++){this._checkedItems[b]&&this.checkedItems.push(this._checkedItems[b])}g.checked=this.checkedItems.length==a.length;this.options.oncheck({target:f,rowIndex:h,data:e,checkedItems:this.checkedItems})},_bindEvent:function(){T.event.ons(T.dom.query(T.format("##{0} thead .sortable .td-content label",this.options.containerId)),"click",T.fn.bind(this._sort,this));T.event.ons(T.dom.query(T.format("##{0} tbody .expandCol",this.options.containerId)),"click",T.fn.bind(this._expand,this));T.event.ons(T.dom.query(T.format("##{0} tbody .operateCol .td-content",this.options.containerId)),"click",T.fn.bind(this._operate,this));T.event.ons(T.dom.query(T.format("##{0} .checkableCol",this.options.containerId)),"click",T.fn.bind(this._check,this))},render:function(a){if(!T.g(this.options.containerId)){return}this._thead=a.thead;this._tbody=a.tbody;this._tfoot=a.tfoot;this._group=a.group;this._offset=a.offset||0;this._expandTrId=null;this._checkedItems=null;this.checkedItems=null;if(a.end==0){this._continuous=true}else{this._continuous=false}if(a.order){this._sortField=a.order.split(",")[0];this._sortDir=a.order.split(",")[1]}T.dom.empty(this.options.containerId);T.dom.insertHTML(this.options.containerId,"beforeend",this._renderTable());this._bindEvent()},_renderSubBody:function(f,j){var h=f;if(T.lang.isObject(f)){h=f.tbody;h.unshift(f.thead)}var e=[];for(var c=0;c<h.length;c++){var g=h[c];var b=[];this._prefixTds(b,-1,false,"&nbsp;",false);var d=g[0].hasOperation==false?false:true;for(var a in g){g[a].colspan=(f.colspans&&f.colspans[a])||1;if(T.lang.isArray(g[a].label)&&g[a].label.length>2){g[a].title=g[a].label;g[a].label=g[a].title[0]+","+g[a].title[1]+",..."}b.push(T.format(this.options.tdTemplate,g[a]));if(a==0&&this.options.hasOperations){if(this.options.hasOperations&&d){b.push(T.format(this.options.operationTdTemplate,{className:"operateCol",label:"&nbsp;",data:c}))}else{b.push(T.format(this.options.tdTemplate,{className:"",label:"&nbsp;",data:c}))}}}e.push(T.format(this.options.trTemplate,b.join(""),"sub-line "+j))}return e.join("")},_getRowId:function(a){return this.getId("tr_"+a)},renderSub:function(c,d){var b=d.expandTrId;if(T.dom.hasClass("expand_"+b,"loaded")){return}T.dom.addClass("expand_"+b,"loaded");T.dom.removeClass("expand_"+b,"mini-loading");T.each(T.dom.query("#"+this.options.containerId+" ."+b),function(e){T.dom.remove(e)});T.dom.insertHTML(b,"afterend",this._renderSubBody(c,b));var a=this;T.event.ons(T.dom.query("#"+this.options.containerId+" ."+b+" .operateCol .td-content"),"click",function(){var e=parseInt(T.getAttr(this,"data"),10);a.options.onoperate({target:this,rowIndex:e,data:T.object.clone(c[e][0].data)})})},loading:function(){if(!this._continuous){T.dom.empty(this.options.containerId);T.dom.insertHTML(this.options.containerId,"beforeend",this._renderLoading())}},showMultilevel:function(a){this.options.multilevel=a}});T.ui.TableIndicator=T.createUI({options:{containerId:null,items:null,selected:null,limit:6,defaultSelected:null,onchange:function(a){},shortcutsTemplate:'<div class="shortcuts"><em class="gray r">提示：可同时选择<em class="red"> #{1} </em>项</em><a href="javascript:void(0)" id="#{0}">系统默认指标</a></div>',buttonsTemplate:'<div class="buttons"><a id="#{0}" class="button" href="javascript:void(0)"><span>确定</span></a></div>',indicatorTemplate:'<label for="#{0}"><input type="checkbox" title="#{2}" value="#{1}" id="#{0}">#{2}</label>',indicatorWrapperTemplate:'<div class="group clearfix">#{0}</div>',separatorTemplate:'<div class="separator"></div>'},_init:function(){this._groupItems=[];this._allIds=[];this._selected=[];this._tempSelected=[];if(!T.lang.isArray(this.options.items)){return}var b=this.options.items;for(var c=0,a=b.length;c<a;c++){var d=b[c];this._allIds.push(d.id);if(this._groupItems[d.group]==null){this._groupItems[d.group]=[]}this._groupItems[d.group].push(d)}},_type:"table-indicator",_groupItems:null,_allIds:null,_selected:null,_tempSelected:null,_change:function(){this._selected=T.object.clone(this._tempSelected);this.options.onchange(this._selected)},_cancel:function(){this._tempSelected=T.object.clone(this._selected);for(var a in this._allIds){var c=this._allIds[a];var b=T.g(this.getId(c));if(T.array.contains(this._selected,c)){b.checked=true}else{b.checked=false}}this._highlightShortcut()},_highlightShortcut:function(){T.removeClass(this.getId("Default"),"selected");if(this._tempSelected.length==this.options.defaultSelected.length){var a=true;for(var b in this._tempSelected){if(!T.array.contains(this.options.defaultSelected,this._tempSelected[b])){a=false;break}}if(a){T.addClass(this.getId("Default"),"selected")}}},_selectItems:function(c){var f=this._allIds;for(var b=0,a=f.length;b<a;b++){var e=f[b];var d=T.g(this.getId(e));if(T.array.contains(c,e)){d.checked=true}else{d.checked=false}}},_clickOne:function(b){var c=T.event.get(b).target;if(c.value!=null){var d=c.value;if(c.checked==true){this._tempSelected.push(d);if(this._tempSelected.length>this.options.limit){var d=this._tempSelected.shift();var a=T.g(this.getId(d));if(a){a.checked=false}}}else{if(this._tempSelected.length==1){c.checked=true;return}T.array.remove(this._tempSelected,d)}this._highlightShortcut()}},_selectDefault:function(){this._tempSelected=T.object.clone(this.options.defaultSelected);this._selectItems(this._tempSelected);this._highlightShortcut()},_initSelected:function(){this._selected=T.object.clone(this.options.selected);this._tempSelected=T.object.clone(this.options.selected);this._selectItems(this._tempSelected);this._highlightShortcut()},_renderIndicators:function(){var d=[];d.push(T.format(this.options.shortcutsTemplate,this.getId("Default"),this.options.limit));for(var c in this._groupItems){if(this._groupItems.hasOwnProperty(c)){var f=[];var a=this._groupItems[c];for(var b in a){if(a.hasOwnProperty(b)){var e=a[b];f.push(T.format(this.options.indicatorTemplate,this.getId(e.id),e.id,e.label))}}d.push(T.format(this.options.indicatorWrapperTemplate,f.join("")));if(c!==this._groupItems.length-1){d.push(this.options.separatorTemplate)}}}d.push(T.format(this.options.buttonsTemplate,this.getId("Ok")));return d.join("")},_bindEvents:function(){T.on(this.getId("Default"),"click",T.fn.bind(this._selectDefault,this));T.on(this.getId("Ok"),"click",T.fn.bind(this._change,this));T.on(this.options.containerId,"click",T.fn.bind(this._clickOne,this))},render:function(){if(!T.g(this.options.containerId)){return}T.insertHTML(this.options.containerId,"beforeend",this._renderIndicators());T.dom.addClass(this.options.containerId,"table-indicator");this._bindEvents();this._initSelected()}});T.ui.Tabs=T.createUI({_type:"tabs",options:{containerId:null,tabsSelector:">.tabs>ul>li:not(.separator)",toggleSelector:">.tabs>.toggle",contentsSelector:">.tab-contents>ul>li",contentContainerSelector:">.tab-contents",tabContainerSelector:">.tabs>ul",eventType:"click",selectedClass:"selected",selectedIndex:null,onchange:function(a,b){},isToggle:true},_currentIndex:null,_tabs:null,_toggle:null,_isOpen:false,_contents:null,_tabContainer:null,_contentContainer:null,_init:function(){if(!T.g(this.options.containerId)){return}var c=this;this._tabs=T.dom.query("#"+this.options.containerId+this.options.tabsSelector);this._contents=T.dom.query("#"+this.options.containerId+this.options.contentsSelector);var b=T.dom.query("#"+this.options.containerId+this.options.toggleSelector);if(b&&b.length>0){this._toggle=b[0]}var d=T.dom.query("#"+this.options.containerId+this.options.contentContainerSelector);if(d&&d.length>0){this._contentContainer=d[0]}var a=T.dom.query("#"+this.options.containerId+this.options.tabContainerSelector);if(a&&a.length>0){this._tabContainer=a[0]}T.each(this._tabs,function(f,e){T.on(T.dom.one("a",f),c.options.eventType,function(g){c._change(e,this.parentNode)})});if(this._toggle){T.on(this._toggle,"click",T.fn.bind(this._toggleFn,this))}if(this.options.selectedIndex!=null){this._change(this.options.selectedIndex,this._tabs[this.options.selectedIndex]);this._currentIndex=this.options.selectedIndex}},_change:function(a,b,c){if(c!==false){c=true}if(a==this._currentIndex&&this.isToggle){this._toggleFn()}else{this._unselect(this._currentIndex);this._currentIndex=a;this.open();this.options.onchange(a,b,c)}},_unselect:function(a){if(a==null){return}var c=this._tabs[a];T.removeClass(c,this.options.selectedClass);var b=T.dom.next(c);if(b&&T.dom.hasClass(b,"separator")){T.dom.show(b)}var d=T.dom.prev(c);if(d&&T.dom.hasClass(d,"separator")){T.dom.show(d)}if(this._contents&&this._contents.length>0){T.hide(this._contents[this._currentIndex])}},_select:function(a){var c=this._tabs[a];T.addClass(this._tabContainer,this.options.selectedClass);T.addClass(c,this.options.selectedClass);var b=T.dom.next(c);if(b&&T.dom.hasClass(b,"separator")){T.dom.hide(b)}var d=T.dom.prev(c);if(d&&T.dom.hasClass(d,"separator")){T.dom.hide(d)}if(this._contents&&this._contents.length>0){T.show(this._contents[a])}},open:function(){if(this._contentContainer){if(this._toggle){this._toggle.innerHTML="收起";T.dom.removeClass(this._toggle,"close");T.dom.addClass(this._toggle,"open")}this._isOpen=true;T.show(this._contentContainer)}if(this._currentIndex==null){this._currentIndex=0}this._select(this._currentIndex)},close:function(){if(this._contentContainer){if(this._toggle){T.dom.removeClass(this._toggle,"open");this._toggle.innerHTML="展开";T.dom.addClass(this._toggle,"close")}this._isOpen=false;T.hide(this._contentContainer)}T.removeClass(this._tabContainer,this.options.selectedClass);this._unselect(this._currentIndex)},_toggleFn:function(){if(this._isOpen){this.close()}else{this.open()}},select:function(a){this._change(a,this._tabs[a],false)},reset:function(){T.removeClass(this._currentIndex,this.options.selectedClass);this._currentIndex=null},hide:function(a){var d=this._tabs[a];T.dom.hide(d);if(a==0){var c=T.dom.next(d);if(c&&T.dom.hasClass(c,"separator")){T.addClass(c,"invisible-separator")}}else{var e=T.dom.prev(d);if(e&&T.dom.hasClass(e,"separator")){T.addClass(e,"invisible-separator")}}if(a==this._currentIndex||this._currentIndex==null){this.close();for(var b in this._tabs){if(b!=a&&this._tabs[b].style.display!="none"){this._currentIndex=b;break}}}},show:function(a){var c=this._tabs[a];T.dom.show(c);if(a==0){var b=T.dom.next(c);if(b&&T.dom.hasClass(b,"separator")){T.removeClass(b,"invisible-separator")}}else{var d=T.dom.prev(c);if(d&&T.dom.hasClass(d,"separator")){T.removeClass(d,"invisible-separator")}}}});T.ui.TimePicker=T.createUI({_type:"timepicker",options:{containerId:null,triggerId:null,oninit:T.fn.blank,ontabselect:T.fn.blank,ontabchange:T.fn.blank,ondateselect:T.fn.blank,onchange:T.fn.blank,oncancel:T.fn.blank,onshortdatechange:T.fn.blank,dateOptions:[],shortDate:null,byWhat:null},_datePickers:null,_selected:null,_init:function(){var f=this,d=f.options;var a=T.g(d.containerId);this.initDatePickers();if(f.shortDate){this.shortcutFn=this.shortcutHandle();var c=T.dom.query("a",T.dom.one(".date-select-bar",a));T.event.ons(c,"click",this.shortcutFn)}if(f.byWhat){this.byWhatFn=this.byWhatHandle();var b=T.dom.query("a",T.dom.one(".date-select-bar",a));T.event.ons(b,"click",this.byWhatFn)}this.submitDateFn=this.submitDateHandle();this.hideDateBoxFn=this.hideDateBoxHandle();var h=T.dom.one(".button-bar",a);var e=T.dom.one(".button",h);var g=T.dom.next(e);T.event.on(e,"click",this.submitDateFn);T.event.on(g,"click",this.hideDateBoxFn);T.event.on(d.triggerId,"click",function(i){T.event.stopPropagation(i);T.dom.addClass(this,"selected");f.initInputDate();if(f.shortDate){f.initShortcutDate()}if(f.byWhat){f.initByWhat()}T.dom.show(a)});T.event.on(a,"click",function(i){T.event.stopPropagation(i)});T.event.on(document.body,"click",function(i){T.dom.hide(a);T.dom.removeClass(d.triggerId,"selected")});T.event.on(window,"resize",function(i){T.dom.hide(a);T.dom.removeClass(d.triggerId,"selected")});T.event.on(window,"scroll",function(i){T.dom.hide(a);T.dom.removeClass(d.triggerId,"selected")});this.initSelected();this.initInputDate();if(f.shortDate){this.initShortcutDate()}if(f.byWhat){this.initByWhat()}},initDatePickers:function(){var e=this,b=e.options;var a=T.g(b.containerId);this._datePickers=[];this._selected=[];var d=T.dom.one(".date-input",a);var c=T.dom.query(".date-input-tab",a);this.selectable=new T.ui.Selectable({containerId:d,elementClazz:"date-input-tab",selectedClazz:"cur",onchange:function(f){if(!f[0]){return}T.array.each(c,function(g,h){var i=e._datePickers[h];if(g!=f[0]){i.hideDateBoxFn&&i.hideDateBoxFn()}});b.ontabchange.call(e)},onselect:function(g,f){b.ontabselect.call(e,f)}});T.array.each(c,function(f,h){var j=e._datePickers[h]=new T.ui.DatePicker(T.extend({containerId:f,calendarContainerId:a,btnBarClass:"no-btnbar-here",defaultText:"",setDateText:function(l,k){var i=T.g(this.options.containerId);T.dom.one(".date-from",i).value=l;T.dom.one(".date-to",i).value=k},onselect:function(i){this.options.startDate=i.from;this.options.endDate=i.to;this.options.onchange("submitDateSelect")},onchange:function(){b.ondateselect.call(e,h)}},b.dateOptions[h]||{}));var g=T.dom.query(".date-input-short",f);j.inputs=g;T.event.ons(g,"keyup",function(n){var m=T.event.getKeyCode(n);if(m==8||m==9||m==17||m==16||m==229||m==35||m==36||m==37||m==38||m==39||m==40){return}this.value=this.value.replace(/[^0-9|[^\/]/g,"");var o=T.string.trim(g[0].value),k=T.string.trim(g[1].value),i=new Date(o),l=new Date(k);if(this.value.length==10){e.validateDateInputs(j);j.dateSelector.setSelected(j.selected)}});T.event.ons(g,"blur",function(i){e.validateDateInputs(j)})})},submitDateHandle:function(){var b=this,a=b.options;return function(){b.initSelected();b.initInputDate();if(b.shortDate){b.initShortcutDate()}a.onchange.call(b,b._selected)}},initSelected:function(){var a=this;this._selected=[];T.array.each(a._datePickers,function(b){a._selected.push({from:b.options.startDate,to:b.options.endDate})});a.options.oninit.call(a,a._selected)},hideDateBoxHandle:function(){var b=this,a=b.options;return function(){b.initInputDate();a.oncancel.call(b)}},initInputDate:function(){var a=this;T.array.each(a._datePickers,function(d,b){var c=a._selected[b];d.setDate(c.from,c.to)});a.selectable.select("first");T.event.fire(document.body,"click")},shortcutHandle:function(){var b=this,a=b.options;return function(i){T.event.preventDefault(i);var h=T.dom.getAttr(this,"roleIndex")||0;var f=b._datePickers[h];if(!f){return}var j=this.href.lastIndexOf("#")+1;var d=this.href.substring(j).split(",");var c=new Date(f.recentDate(d[0]|0)),g=new Date(f.recentDate(d[1]|0));f.setDate(c,g);b.removeShortcutClass(h);T.dom.addClass(this,"cur");b.options.onshortdatechange.call(b,{from:c,to:g},h);b.selectable.select(h)}},initShortcutDate:function(){if(!this.shortDate){return}var a=T.g(this.options.containerId);var j=T.dom.one(".date-select-bar",a);var l=j.getElementsByTagName("A");var k=[],c,h=this.dateDiff;for(var e=0,c=l.length;e<c;e++){var r=l[e];var g=T.dom.getAttr(r,"roleIndex")||0;var q=k[g];if(!q){this.removeShortcutClass(g);q=k[g]={};var p=this._datePickers[g];var b=p.options.startDate;var d=p.options.endDate;if(!b||b.constructor!=Date){continue}var m=p.options.todayDate;q.et=h(d,m);q.st=h(b,m)}var o=r.href.indexOf("#");var f=r.href.substr(o+1).split(",");if((f[0]|0)==q.st&&(f[1]|0)==q.et){T.dom.addClass(r,"cur")}}},initByWhat:function(){if(!this.byWhat){return}var b=T.g(this.options.containerId);var d=T.dom.one(".date-select-bar",b);var c=d.getElementsByTagName("a");var e=this._datePickers[0];var g=e.options.startDate;var a=e.options.endDate;var f=(a-g)/(24*60*60*1000);this.removeShortcutClass();if(f===0){e.setDateFormat(5);T.dom.addClass(T.dom.query(".byday",d)[0],"cur")}else{if(f===6){e.setDateFormat(4);T.dom.addClass(T.dom.query(".byweek",d)[0],"cur")}else{e.setDateFormat(3);T.dom.addClass(T.dom.query(".bymonth",d)[0],"cur")}}},removeShortcutClass:function(f){var a=T.g(this.options.containerId);var e=T.dom.one(".date-select-bar",a);var d=e.getElementsByTagName("A");f=f||0;for(var c=0,g=d.length;c<g;c++){var b=T.dom.getAttr(d[c],"roleIndex")||0;if(f==b){T.dom.removeClass(d[c],"cur")}}},_destroy:function(){},setDate:function(a,f,e,b){var d=this,c=this._selected[e||0];c.from=a;c.to=f;this.initInputDate();if(d.shortDate){this.initShortcutDate()}if(d.byWhat){this.initByWhat()}this.options.onchange.call(this,this._selected,b)},validateDateInputs:function(h){var g=h.inputs,e=/^[\d]{4,4}[/]([0][1-9]|[1][0-2])[/]([0][1-9]|[1-2][\d]|[3][0-1])$/;var a=T.string.trim(g[0].value),c=T.string.trim(g[1].value),b=new Date(a),f=new Date(c),d;if(!e.test(a)){T.dom.addClass(g[0],"date-invalid");h.showMessage("开始日期输入有误，日期格式yyyy/MM/dd。")}else{if(!e.test(c)){T.dom.addClass(g[1],"date-invalid");h.showMessage("结束日期输入有误，日期格式yyyy/MM/dd。")}else{if(a!=""&&c!=""&&f<b){T.dom.addClass(g[1],"date-invalid");h.showMessage("结束日期不能小于开始日期！")}else{T.dom.removeClass(g[0],"date-invalid");T.dom.removeClass(g[1],"date-invalid");d={from:b,to:f};var i=h.dateSelector.onselect(d);if(i===false){return}h.selected=d}}}},dateDiff:function(b,a){b.setHours(0);b.setMinutes(0);b.setSeconds(0);b.setMilliseconds(0);a.setHours(0);a.setMinutes(0);a.setSeconds(0);a.setMilliseconds(0);return parseInt((b-a)/1000/60/60/24,10)},showInput:function(d){var b=this.selectable.get(d||0);var c=T.dom.one(".date-input-picker",b);var a=T.dom.one(".date-picker-check",b);c&&T.dom.setStyle(c,"visibility","visible");a&&(a.checked=true)},hideInput:function(d){var b=this.selectable.get(d||0);var c=T.dom.one(".date-input-picker",b);var a=T.dom.one(".date-picker-check",b);a&&(a.checked=false);c&&T.dom.setStyle(c,"visibility","hidden")},disableInput:function(c){var b=this.selectable.get(c||0);var a=T.dom.one(".date-picker-check",b);a&&(a.checked=false);if(b){T.dom.setStyle(b,"visibility","hidden");T.dom.addClass(b,"disabled")}},enableInput:function(b){var a=this.selectable.get(b||0);if(a){T.dom.setStyle(a,"visibility","visible");T.dom.removeClass(a,"disabled")}},hideCompareDate:function(){this.setDate(null,null,1,false)},disableCompareDate:function(){this.disableInput(1);this._datePickers[1].setDate(null,null)},enableCompareDate:function(){this.enableInput(1)},setCompareDate:function(a,b){this.setDate(new Date(a),new Date(b),1,false)},byWhatHandle:function(){var a=this;return function(c){T.event.preventDefault(c);var b=T.getAttr(this,"data");a.removeShortcutClass();T.dom.addClass(this,"cur");T.array.each(a._datePickers,function(e,d){e.setDateFormat(b)})}}});T.TimeSpan=T.createClass({options:{byHourId:"ByHour",byDayId:"ByDay",ByWeekId:"ByWeek",ByMonthId:"ByMonth",containerId:"TimeSpan",gran:6,day:1000*3600*24,onchange:function(a){}},_granLinks:null,_init:function(){var c={"3":this.options.ByMonthId,"4":this.options.ByWeekId,"5":this.options.byDayId,"6":this.options.byHourId},b=c[this.options.gran];var a=T.g(this.options.containerId);this._granLinks=T.dom.query("a",a);this._addActiveClass(b!==undefined?b:this.options.byHourId);this.reset(T.config.pageInfo.st,T.config.pageInfo.et);this.bind()},reset:function(a,e){var c=T.g(this.options.ByMonthId),f=T.g(this.options.ByWeekId),d=T.g(this.options.byDayId),b=T.g(this.options.byHourId);f&&T.dom.addClass(f,"disable");c&&T.dom.addClass(c,"disable");if((e-a)>(this.options.day*7)){f&&T.dom.removeClass(f,"disable");if((e-a)>(this.options.day*31)){c&&T.dom.removeClass(c,"disable")}}},_addActiveClass:function(a){T.element(this._granLinks).each(function(b){T.removeClass(b,"selected")});T.addClass(a,"selected")},bind:function(){var a=this;T.event.on(this.options.containerId,"click",function(b){var c=T.event.getTarget(b);a.select(c)})},select:function(a){a=T.g(a);if(!T.dom.hasClass(a,"disable")){this._addActiveClass(a);this.options.onchange(T.dom.getAttr(a,"data"))}}});T.ui.Tip=T.createUI({options:{target:document.body,tip:null,position:null},_type:"tip",_init:function(){this.position=this.options.position||T.dom.getPosition(this.target);if(T.lang.isElement(this.target)){var c=T.ui.Tip.targetsTips.length;if(c===0){T.ui.Tip.targetsTips.push(this)}else{var b=false;for(var a=0;a<T.ui.Tip.targetsTips.length;a++){if(T.ui.Tip.targetsTips[a].target===this.target){T.ui.Tip.targetsTips[a]=this;b=true;break}else{b=false}}if(!b){T.ui.Tip.targetsTips.push(this)}}}},getTargetPosition:function(){return T.dom.getPosition(this.target)},render:function(){if(this.getTargetPosition().left+275>=T.page.getViewWidth()){T.dom.setPosition(this.tip,{left:T.page.getViewWidth()-275,top:this.getTargetPosition().top+this.target.offsetHeight+2});var b=T.q("tip-arrow",this.tip)[0];var a=this.getTargetPosition().left+275-T.page.getViewWidth();T.dom.setStyle(b,"left",12+a)}else{var b=T.q("tip-arrow",this.tip)[0];T.dom.setPosition(this.tip,{left:this.getTargetPosition().left,top:this.getTargetPosition().top+this.target.offsetHeight+2});T.dom.setStyle(b,"left",12)}document.body.appendChild(this.tip)}});T.ui.Tip.targetsTips=[];T.ui.Tip.close=function(){T.element(".tip-container").each(function(a){T.dom.remove(a)})};T.ui.Tip.bindEvent=function(){T.event.on(document,"click",function(h){var h=h||window.event;var g=T.event.getTarget(h);var d=false;var f=T.ui.Tip.targetsTips;for(var c=0;c<f.length;c++){if(f[c].target===g){T.ui.Tip.close();f[c].render();d=true||d}else{d=false||d}}if(!d&&!hasParent(g,".help")&&!hasParent(g,".tip-container")){T.ui.Tip.close()}});var a,b;T.event.on(document,"mouseover",function(d){var d=d||window.event;var c=T.event.getTarget(d);var f=c;if(T.q("tip-container").length>0){if(hasParent(f,".help")||hasParent(f,".tip-container")){clearTimeout(a)}else{clearTimeout(a);a=setTimeout(function(){T.ui.Tip.close()},500)}}if(hasParent(f,".help")){clearTimeout(b);b=setTimeout(function(){var g=false;var h=T.ui.Tip.targetsTips;for(var e=0;e<h.length;e++){if(h[e].target===f){T.ui.Tip.close();h[e].render();g=true||g}else{g=false||g}}if(!g){T.ui.Tip.close()}},500)}else{clearTimeout(b)}})};T.ui.Tip.loadTips=function(){T.ui.Tip.targetsTips=[];var g=T.q("help");for(var c=0;c<g.length;c++){var a=T.dom.getAttr(g[c],"tip");if(a){var e=T.dom.create("div",{style:"position: absolute;"});e.className="tip-container";e.innerHTML='<div style="zoom: 1;position: relative; left:-12px;" class="tip-div tip-theme indicator-theme"><div class="tip-arrow"></div><div class="tip-wrap">'+a+"</div></div>";new T.ui.Tip({target:g[c],tip:e})}else{var d=T.dom.hasAttr(g[c],"data");if(!d){if(T.config.pageInfo.tip){var e=T.dom.create("div",{style:"position: absolute;"});e.className="tip-container";e.innerHTML='<div style="zoom: 1;position: relative; left:-13px;" class="tip-div tip-theme report-theme"><div class="tip-arrow"></div><div class="tip-wrap"><div class="tip-head"><div class="tip-head-text">'+T.config.pageInfo.title+'</div><div class="tip-close" onclick="T.ui.Tip.close()">×</div></div><div class="tip-body"><table class="tip-table"><tbody class="tip-table-body"><tr class="tip-row"><th class="tip-title">含义：</th><th class="tip-content">'+T.config.pageInfo.tip.title+'</th></tr><tr class="tip-row"><th class="tip-title">作用：</th><th class="tip-content">'+T.config.pageInfo.tip.content+"</th></tr></tbody></table></div></div></div>";new T.ui.Tip({target:g[c],tip:e})}}else{if(T.config.indexInfo.indicators){var h=T.dom.getAttr(g[c],"data");var f=T.config.indexInfo.indicators.concat(T.config.indexInfo.indexes);for(var b=0;b<f.length;b++){if(f[b]&&f[b].tip){if(f[b].id===h){var e=T.dom.create("div",{style:"position: absolute;"});e.className="tip-container";e.innerHTML='<div style="zoom: 1;position: relative; left:-12px;" class="tip-div tip-theme indicator-theme"><div class="tip-arrow"></div><div class="tip-wrap">'+f[b].tip+"</div></div>";new T.ui.Tip({target:g[c],tip:e})}}}}}}}};T.ToggleTarget=T.createClass({_type:"toggle-target",options:{sign:"toggleable",onchange:function(a){},smoothExpandableElements:[".report-tip"],memo:null},_memo:null,_init:function(){this._memo=T.object.clone(this.options.memo||{});this._initStatus();T.on(document.body,"click",T.fn.bind(this.toggleHandler,this))},_initStatus:function(){T.each(T.dom.q("recordable"),function(e){var c=e.id||"",b=T.getAttr(e,"memo");if(b){memoObj=T.json.parse(b);if(memoObj.hasOwnProperty("id")){c=memoObj.id}}if(!this._memo.hasOwnProperty(c)){return}var a;T.removeClass(e,"open");T.removeClass(e,"close");if(this._memo[c]){a=true;T.addClass(e,"open")}else{a=false;T.addClass(e,"close")}var d=T.getAttr(e,"targets");if(d){T.each(T.dom.query(d),function(f){if(a){T.removeClass(f,"toggleable-hidden")}else{T.addClass(f,"toggleable-hidden")}});if(d.indexOf("#FlashFoldedTip")!=-1){if(a){T.addClass(T.dom.one("#FlashFoldedTip"),"toggleable-hidden")}else{T.removeClass(T.dom.one("#FlashFoldedTip"),"toggleable-hidden")}}}},this)},toggleHandler:function(d,b){var e=T.event.getTarget(d);if(T.dom.hasClass(e,"noLayer")){return}if(!(e[this.options.sign]||T.dom.hasClass(e,this.options.sign))){return}var a=T.getAttr(e,"targets");var c=this;T.each(T.dom.query(a),function(g,f){T.dom.toggleClass(g,"toggleable-hidden")});T.dom.toggleClass(e,"open");T.dom.toggleClass(e,"close");this.options.onchange(e.id)}});T.TrackTarget=T.createClass({options:{sign:"trackable",onchange:function(a){},trackUri:null},_type:"track-target",_init:function(){this.options.trackUrl=this.options.trackUri||T.config.systemConfig.trackUri;T.on(document.body,"mousedown",T.fn.bind(this.trackHandler,this))},trackHandler:function(d){var f=T.event.getTarget(d);if(!(f[this.options.sign]||T.dom.hasClass(f,this.options.sign))){return}var c=f.id||"",b=T.getAttr(f,"memo");if(b){memoObj=T.json.parse(b);if(memoObj.hasOwnProperty("id")){c=memoObj.id}}var e={appId:T.config.appInfo.id,pageId:T.config.pageInfo.id,elementId:c};var a=T.getAttr(f,"href");if(a&&!(/^javascript|#/.test(a))){e.url=encodeURIComponent(a)}if(f.innerHTML&&!(/^\s*</i.test(f.innerHTML))&&!(/>\s*$/i.test(f.innerHTML))){e.value=T.i18n.string.trim(f.innerHTML)}this.options.onchange(e);this.postData(e)},postData:function(b){var a=(new Date()).getTime();var c=window["bd_holmes"+a]=new Image();c.src=this.options.trackUrl+"?r="+a+"&"+T.url.jsonToQuery(b,function(e,d){return encodeURIComponent(e)});c.onload=c.onerror=function(){c=null}}});T.ui.Upload=T.createUI({_type:"upload",options:{triggerId:"upload",title:"批量上传",data:{method:"home/event/upload",MAX_FILE_SIZE:2097152},width:370,url:null,tip:"事件ID不能为空，自定义事件最多支持20个，请按照上传模板的要求酌情添加",uploadDialogTpl:'<div class="content up-content"><span class="content-tip">#{tip}</span><input type="text" id="#{id}-upFileText" disabled /><a id="#{id}-upFileBtn" class="button" href="javascript:void(0)"><span>浏览</span></a></div><div class="button-bar"><span class="error" id="#{id}-upFileError"></span><a href="javascript:void(0);" id="#{id}-confirm" class="button disabled"><span>上传</span></a><a href="javascript:void(0);" id="#{id}-cancel">取消</a></div>',upLoadFormTemplate:'<body><form id="upFileForm" action="#{url}" method="post" enctype="multipart/form-data">            <input type="file" id="upFile" name="upFile" style="display:none;" />            #{hidden}        </form></body>',filter:function(a){if(!/\.csv$/i.test(a)){return"请上传CSV格式的文件"}},success:function(a){},error:function(){}},_upDialog:null,_uploadFrame:null,_uploadFileInput:null,_uploadForm:null,_error:true,_init:function(){var b=this;var c=this.getId();if(!this.options.url){this.options.url=T.config.systemConfig.baseUri+"/ajax/post"}this._upDialog=new T.ui.Dialog({titleText:this.options.title,content:T.format(this.options.uploadDialogTpl,{id:c,tip:this.options.tip}),width:this.options.width,isSingle:true,isModal:true});T.event.on(this.getId("upFileBtn"),"click",function(){T.g(b.getId("upFileError")).innerHTML="";b.generateUploadFrame();b._uploadFileInput.click()});T.event.on(this.getId("confirm"),"click",function(){if(!b._uploadFileInput||!b._uploadFileInput.value){return}T.dom.addClass(this,"disabled");b._error=true;b._uploadForm.submit()});T.event.on(this.getId("cancel"),"click",function(){b._upDialog.close()});T.event.on(this.options.triggerId,"click",function(){b._upDialog.show()});var a=b.options.callbackFnName||"callback_"+new Date().getTime();this.options.data.callback="parent."+a;window[a]=function(d){b._error=false;if(d&&d.msg){b.showMessage(d.msg)}else{if(d&&d.status==0){b.showMessage("上传成功");b.options.success(d)}else{b.showMessage("系统错误")}}}},generateUploadFrame:function(){var d=this;var e=document.createElement("iframe");e.style.display="none";e.src="about:blank";document.body.appendChild(e);var c=[];T.object.each(this.options.data||{},function(g,f){c.push(T.format('<input type="hidden" name="#{0}" value="#{1}">',f,g))});var b=e.contentDocument||e.contentWindow.document;b.open();b.write(T.format(this.options.upLoadFormTemplate,{url:this.options.url,hidden:c.join("")}));var a=b.forms[0].children[0];if(this._uploadFrame){T.dom.remove(this._uploadFrame)}this._uploadFrame=e;this._uploadFileInput=a;this._uploadForm=b.forms[0];T.event.on(a,"change",function(g){var h=d.getFileName(this.value);var f=typeof d.options.filter=="function"&&d.options.filter(h);if(f){T.g(d.getId("upFileError")).innerHTML=f;this.value="";T.g(d.getId("upFileText")).value="";T.dom.addClass(d.getId("confirm"),"disabled")}else{T.g(d.getId("upFileText")).value=h;T.dom.removeClass(d.getId("confirm"),"disabled")}});e.onload=function(f){setTimeout(function(){if(d._error){d.showMessage("上传失败，请重新尝试.");if(typeof d.options.error=="function"){d.options.error()}}},d.options.timeout||200)}},getFileName:function(d){var b=d.lastIndexOf("/");var a=d.lastIndexOf("\\");var c=Math.max(b,a);if(c<0){return d}else{return d.substring(c+1)}},showMessage:function(a){T.g(this.getId("upFileError")).innerHTML=a}});T.Webpage=function(a){T.extend(this,{components:[],on:function(c,b){EventRouter.register(c,b)},fire:function(b){EventRouter.dispatch.apply(EventRouter,arguments)},_init:function(){T.extend(this,this.options);EventRouter.setOwner(this);T.extend(this,T.config);this.fire("onbeforeInit");this.initComponents(this.components);this._initDataAdapter({id:"DataAdapter"});this._initScroll();this.fire("oninit")},_initFilter:function(){var b=T.g("FilterBtn");b&&T.event.on(b,"click",function(c){var d=T.event.getTarget(c);if(T.dom.hasClass(d,"selected")){T.dom.setAttr(d,"title","点击展开高级筛选")}else{T.dom.setAttr(d,"title","点击收起高级筛选")}})},initComponents:function(f){for(var d in f){var c=f[d];var e=null;var b=null;var h=null;if(T.lang.isString(c)){e=c;h=e}else{e=c.type;b=c.options;if(c.id){h=c.id}else{h=e}}var g="_init"+e;if(g!=="_init"&&T.lang.isFunction(this[g])){this[g]({id:h,type:e,options:b})}}},_getEventName:function(c,b){return b?b+c:"onchange"+c},_initTimeSpan:function(c){var b=this;this[c.id]=new T.TimeSpan(T.extend({onchange:function(d){b.fire(b._getEventName(c.id),d)}},c.options))},_initGuide:function(c){var b=this;this[c.id]=new T.Guide(T.extend({onsuccess:function(d){b.fire(b._getEventName(c.id,"onsuccess"),d)},onclose:function(){b.fire(b._getEventName(c.id,"onclose"))}},c.options))},_initFlashFormatConverter:function(c){var b=this;this[c.id]=new T.FlashFormatConverter({onchange:function(e,d,f){b.fire("beforeSetFlashData",e,d,f)}})},_initToggleTarget:function(c){var b=this;this[c.id]=T.ui.create(T.ToggleTarget,T.extend({data:b.memo,onchange:function(d){b.fire(b._getEventName(c.id),d)}},c.options))},_initTrackTarget:function(c){var b=this;this[c.id]=T.ui.create(T.TrackTarget,T.extend({onchange:function(d){b.fire(b._getEventName(c.id),d)}},c.options))},_initRecordTarget:function(c){var b=this;this[c.id]=T.ui.create(T.RecordTarget,T.extend({onchange:function(d){b.fire(b._getEventName(c.id),d)}},c.options))},_initFlash:function(e){var b=this.systemConfig.webRoot+"/flash/"+e.options.type+".swf";var c="transparent";if(T.browser.chrome&&e.options.type=="line"&&navigator&&navigator.plugins){var d=navigator.plugins["Shockwave Flash"]||navigator.plugins.Flash;if(d&&(d.filename==="pepflashplayer.dll"||d.filename==="PepperFlashPlayer.plugin"||d.filename==="libpepflashplayer.so")){c="opaque"}}T.swf.create({id:e.id,url:b,width:e.options.width||"100%",height:e.options.height||"270",bgColor:"#FFFFFF",wmode:c,errorMessage:"载入FLASH出错",ver:"9.0.0",allowscriptaccess:"always",vars:{flashId:e.id,baseUrl:this.systemConfig.webRoot+"/flash/fla"}},e.options.flashContainerId||"FlashContainer");this[e.id]=T.swf.getMovie(e.id)},getFlash:function(b){return T.swf.getMovie(b)},_initDownload:function(c){var b=this;this[c.id]=new T.ui.Download(T.extend({trigerId:"DownloadReport",reportId:this.pageInfo.id,appId:this.appInfo.id,url:this.systemConfig.ajaxUri,reportTitle:this.pageInfo.title+" - 百度统计",onchange:function(d){b.fire(b._getEventName(c.id),d)}},c.options));this[c.id].render()},_initChannelDownload:function(c){var b=this;this[c.id]=new T.ui.Dialog({titleText:"分渠道导出",content:'<div class="content download-content"><p>说明：分渠道导出数据是按照单一渠道维度进行用户去重，趋势分析的总计数据是整体用户进行去重，因此分渠道数据相加会大于趋势分析的总计数据；</p></div><div class="button-bar"><a href="javascript:void(0);" id="downloadChannelConfirm" class="button"><span>下载</span></a><a href="javascript:void(0);" id="downloadChannelCancel">取消</a></div>',width:370,position:{top:200,left:360},isSingle:true,isModal:true});this[c.id].download=function(e){var d=new T.ui.Download(T.extend({trigerId:"DownloadReport",reportId:b.pageInfo.id,appId:b.appInfo.id,url:b.systemConfig.ajaxUri,reportTitle:b.pageInfo.title+" - 百度统计"},c.options));d.render();d.download(e)};T.event.on("channelDownload","click",function(){b[c.id].show()});T.event.on("downloadChannelConfirm","click",function(){b.fire(b._getEventName(c.id))});T.event.on("downloadChannelCancel","click",function(){b[c.id].close()})},_initSendReport:function(c){var b=this;this[c.id]=new T.ui.SendReport(T.extend({trigerId:"SendReport",url:this.systemConfig.ajaxUri,method:"home/reportsend/add",reportId:this.pageInfo.id,siteId:this.siteInfo.id,reportTitle:this.pageInfo.title+" - 百度统计",onchange:function(d){b.fire(b._getEventName(c.id),d)}},c.options));this[c.id].render()},_initAdvancedFilter:function(c,b){return function(i,j){var h=this;var d=c.charAt(0).toUpperCase()+c.substr(1);var g=this[c+"List"];var e;if(!j||!(j instanceof Array)){e=T.config.pageInfo[c]||0;var f=T.array.find(g,function(k){if(k.id===e){e=k.id;return true}});if(!f){e=0}this.context[c]=e;e=[e]}else{e=j}this[i.id]=new T.ui.FilterGroup(T.extend({containerId:d,label:b,limit:1,tool:true,selectedItems:e,items:g,onchange:function(k,l){h._bindFilterResult(i.id,d,l,k);h.fire(h._getEventName(i.id),k)}},i.options));this[i.id].render();h._bindFilterResult(i.id,d,this[i.id].getSelectedLabels(),e)}},_initVersion:function(b){if(b.options&&b.options.single===false){return this._initAdvancedFilter("version","版本过滤").call(this,b,this.pageInfo.versions)}else{return this._initAdvancedFilter("version","版本过滤").call(this,b)}},_initPromotionStyleType:function(b){return this._initAdvancedFilter("typeDefine","样式类型").call(this,b)},_initUserType:function(b){return this._initAdvancedFilter("userType","用户类型").call(this,b)},_initDistrict:function(b){return this._initAdvancedFilter("district","区服过滤").call(this,b)},_initChannel:function(g){var f=this;var d=T.config.pageInfo.channel||0;var e=T.array.find(this.channelList[0].children,function(h){if(h.id==d){d=h.id;return true}});if(!e){d=0}this.context.channel=d;this[g.id]=new T.ui.FilterGroup(T.extend({containerId:"Channel",label:"渠道过滤",searchText:"搜索渠道",limit:1,selectedItems:[d],tool:true,filterable:true,items:f.channelList[0].children,onchange:function(h,i){f._bindFilterResult(g.id,"Channel",i);f.fire(f._getEventName(g.id),h)}},g.options));this[g.id].render();var b=T.g("Channel");var c=T.dom.one(".filter-tool-bar",b);T.dom.insertHTML(c,"afterBegin",'<div id="Channel-Group-Combox" class="filter-combox"></div>');f._bindFilterResult(g.id,"Channel",this[g.id].getSelectedLabels());this.channelList[0].label="全部分组";this[g.id+"Group"]=new T.ui.Combobox(T.extend({containerId:"Channel-Group-Combox",defaultText:"未选择",items:this.channelList,width:156,searchable:true,searchTip:"查询渠道组",onchange:function(h,k){var i=h;var j=T.array.find(f.channelList,function(l){return l.id==i});f[g.id].renderItems(j.children||[]);f.fire(f._getEventName(g.id+"Group"),[h])}},g.options))},_filterFlag:{},_bindFilterResult:function(c,j,h,m){var k=this;if(T.g(j+"Result")){this._filterFlag[j]={};if(h==null||h.length===0||(h.length===1&&h[0]==="全部")){T.g(j+"Result").innerHTML="";this._filterFlag[j].hasValue=false}else{var l=h[h.length-1];if(l==="全部"){l=h[h.length-2]}if(k[c].options.single===true){T.g(j+"Result").innerHTML=T.format('<em title="!{0}" class="result">!{0, 16}</em><em class="reset"></em>',l)}else{for(var f=0,d=h.length,b=[];f<d;f++){var e={label:h[f],value:m[f]};b.push(e)}b.sort(function(n,i){return n.value-i.value});var g="";for(var f=0,d=b.length;f<d;f++){g+=T.format('<em title="!{0}" class="result">!{0, 16}</em><em class="reset" data="!{1}"></em>',b[f].label,b[f].value)}T.g(j+"Result").innerHTML=g}T.un(T.g(j+"Result"),"click");T.on(T.g(j+"Result"),"click",function(o){T.event.stopPropagation(o);var v=T.event.getTarget(o);if(T.dom.hasClass(v,"reset")){if(k[c].options.single||k[c].selectable.selected.length<=1){k[c].reset();if(k[c+"Group"]){k[c+"Group"].reset()}}else{var p=k[c].selectable.selected;var t=T.getAttr(T.event.getTarget(o),"data");var r=k[c].unselect(t);T.array.remove(p,t);var u=null;var q=T.dom.children(j+"Result");for(var s=0,n=q.length;s<n;s++){if(T.getAttr(q[s],"data")===t){u=s-1;break}}T.dom.remove(q[u]);T.dom.remove(q[u+1]);k.fire(k._getEventName(c),r)}}});this._filterFlag[j].hasValue=true}}this._renderFilterResult()},_renderFilterResult:function(){if(T.g("FilterResults")){var c=false;for(var b in this._filterFlag){if(this._filterFlag[b].hasValue&&this._filterFlag[b].show!==false){c=true;break}}if(c){T.show("FilterResults")}else{T.hide("FilterResults")}}},showFilter:function(b){T.show(b);T.show(b+"Result");if(!this._filterFlag[b]){this._filterFlag[b]={}}this._filterFlag[b].show=true;this._renderFilterResult()},hideFilter:function(b){T.hide(b);T.hide(b+"Result");if(!this._filterFlag[b]){this._filterFlag[b]={}}this._filterFlag[b].show=false;this._renderFilterResult()},hideFilters:function(){var b=T.g("FilterResults");var d=T.g("FilterBox");var c=T.g("FilterBtn");c&&T.dom.setStyle(c,"visibility","hidden");d&&T.dom.hide(d);b&&T.dom.hide(b)},showFilters:function(){var b=T.g("FilterResults");var d=T.g("FilterBox");var c=T.g("FilterBtn");c&&T.dom.setStyle(c,"visibility","visible");if(T.dom.hasClass(T.dom.one("a",c),"selected")){d&&T.dom.show(d)}if(this.context.channel||this.context.userType||this.context.version){b&&T.dom.show(b)}},_initShortDate:function(c){var b=this;this[c.id]=new T.ShortDate(T.extend({onchange:function(d){b.fire(b._getEventName(c.id),d)}},c.options))},_initDate:function(e){var i=this;var l=e.options&&e.options.singleSelection;var j=e.options&&e.options.alwaysCompare;var f=e.options&&e.options.maxSelectDays;var d=e.options&&e.options.defaultSelectDays;var n=e.options&&e.options.shortDate||true;var k=e.options&&e.options.byWhat;var h=e.options&&e.options.prefix||"";var c=l?new Date(+T.config.pageInfo.st):((d!=null)?new Date(+T.config.pageInfo.ed-(d-1)*24*3600*1000):new Date(+T.config.pageInfo.st));var g=l?new Date(+T.config.pageInfo.et):((d!=null)?new Date(+T.config.pageInfo.ed):new Date(+T.config.pageInfo.et));var b=(l||(j===false))?"":(T.config.pageInfo.st2?new Date(+T.config.pageInfo.st2):"");var m=(l||(j===false))?"":(T.config.pageInfo.et2?new Date(+T.config.pageInfo.et2):"");this[e.id]=new T.ui.TimePicker(T.extend({triggerId:h+"timePicker",containerId:h+"timePickerBox",shortDate:n,byWhat:k,oninit:function(p){if(!p||p.length<2){return}var q=this;var o=T.dom.one(".date-picker-check",this.selectable.get(1));if(j){o&&T.dom.hide(o);q.showInput(1)}else{o&&T.event.on(o,"click",function(t){T.event.stopPropagation(t);if(this.checked){q.showInput(1);q.selectable.select(1);T.event.stop(t)}else{q.hideInput(1);q._datePickers[1].setDate(null,null);q.msg="";q.selectable.select(0)}})}if(p[1].from==null){return}if(p[1].from.constructor!=Date){return}var s=Math.abs(this.dateDiff(p[0].from,p[0].to));var r=Math.abs(this.dateDiff(p[1].from,p[1].to));if(r!=s){p[1].to=new Date(p[1].from.getTime()+s*3600*24*1000)}},onshortdatechange:function(o,q){var p=this._datePickers[1];if(!j&&p){p.setDate(null,null)}},ondateselect:function(q){var p=this._datePickers[1];if(p){var o=p.options.startDate;if(o&&o.constructor==Date){this.showInput(1)}else{if(q!=1){this.hideInput(1)}}}this.initShortcutDate()},ontabselect:function(q){var p=this._datePickers[1];if(p){var o=p.options.startDate;if(o&&o.constructor==Date){this.showInput(1)}else{if(q!=1){this.hideInput(1)}}}},onchange:function(p,o){i.showDateTip(p,e,o)},dateOptions:[{singleSelection:l,maxSelectDays:f,todayDate:T.config.pageInfo.ed?new Date(+T.config.pageInfo.ed):"",firstDate:T.config.pageInfo.sd?new Date(+T.config.pageInfo.sd):"",startDate:c,endDate:g,lastDate:T.config.pageInfo.ed?new Date(+T.config.pageInfo.ed):new Date()},{singleSelection:l,maxSelectDays:f,todayDate:T.config.pageInfo.ed?new Date(+T.config.pageInfo.ed):"",firstDate:T.config.pageInfo.sd?new Date(+T.config.pageInfo.sd):"",startDate:b,endDate:m,lastDate:T.config.pageInfo.ed?new Date(+T.config.pageInfo.ed):new Date()}]},e.options));this.showDateTip([{from:c,to:g},{from:b,to:m}],e,false)},isDate:function(b){return b&&b.constructor==Date?true:false},getDateStr:function(f,e){var d=baidu.date.format;var b=d(f,"yyyy/MM/dd");var c=d(e,"yyyy/MM/dd");return(b==c)?b:(b+"~"+c)},showDateTip:function(h,g,d){var l=h[0].from;var m=h[0].to;var i=h[1]&&h[1].from;var j=h[1]&&h[1].to;var k=g.options&&g.options.prefix||"";var f=T.g(k+"Date");var b=T.g(k+"timePickerText");var c=this.isDate(i);var e=this.getDateStr(l,m);if(c){var n=this.getDateStr(i,j);f&&(f.innerHTML="("+e+"与"+n+")");b.innerHTML=e+"<br>"+n;T.dom.addClass(b.parentNode.parentNode,"multi-time")}else{f&&(f.innerHTML="("+e+")");b.innerHTML=e;T.dom.removeClass(b.parentNode.parentNode,"multi-time")}T.dom.one(".report-help")&&(T.dom.setStyle(T.dom.one(".tip-arrow"),"left",(T.dom.one(".report-help").offsetLeft+2)+"px"));(d!==false)&&this.fire(this._getEventName(g.id),{id:"submitDateSelect",st:l&&l.getTime(),et:m&&m.getTime(),st2:i&&i.getTime(),et2:j&&j.getTime()})},_initScroll:function(){if(T.g("Scroll")&&T.dom.hasClass("Scroll","filter-scroll")){var b=function(){var d=T.dom.getPosition("ControlBarWrapper");var c=T.g("Scroll");if(c&&!T.dom.hasClass(c,"open")){return}var f=document.documentElement.scrollTop||document.body.scrollTop;var g=document.documentElement.scrollLeft+document.body.scrollLeft;var e=T.g("ControlBar");if(f>d.top){if(T.dom.getStyle("ControlBarWrapper","height")==="auto"){T.setStyles("ControlBarWrapper",{height:e.offsetHeight+2})}T.addClass(e,"date-controll-bar-scroll");T.addClass(e,"filterable-scroll");if(T.browser.ie<7){T.setStyles(e,{top:f-d.top,width:T.q("main")[0].offsetWidth})}else{if(T.dom.getStyle("aside-menu","display")==="none"){T.setStyles(e,{width:T.q("main")[0].offsetWidth,left:"65px"})}else{T.setStyles(e,{width:T.q("main")[0].offsetWidth,left:"260px"})}}}else{T.removeClass(e,"date-controll-bar-scroll");T.removeClass(e,"filterable-scroll");T.setStyle(e,"width","auto");T.setStyles("ControlBarWrapper",{height:"auto"})}T.event.fire(document.body,"click")};T.on("Scroll","click",function(c){T.dom.toggleClass(this,"open");T.dom.toggleClass(this,"close");if(!T.dom.hasClass(this,"open")){T.removeClass("ControlBar","date-controll-bar-scroll");T.removeClass("ControlBar","filterable-scroll");T.setStyle("ControlBar","width","auto");T.setStyles("ControlBarWrapper",{height:"auto"})}});T.on(window,"scroll",b);T.on(window,"resize",b);this._initFilter()}},_initTable:function(c){var b=this;this[c.id]=new T.ui.Table(T.extend({containerId:"Table",index:T.config.indexInfo.indexes[0],onchange:function(d){b.fire(b._getEventName(c.id),d)},onexpand:function(d){b.fire("onexpand"+c.id,d)},onoperate:function(d){b.fire("onoperate"+c.id,d)},oncheck:function(d){b.fire("oncheck"+c.id,d)}},c.options))},_initOperations:function(c){var b=this;this[c.id]=new T.ui.Operations(T.extend({onchange:function(d,e){b.fire(b._getEventName(c.id),d,e)}},c.options))},_initSummary:function(b){this[b.id]=new T.ui.Summary(T.extend({containerId:"Summary"},b.options))},_initPaging:function(c){var b=this;this[c.id]=new T.ui.Paging(T.extend({containerId:"Paging",onchange:function(d){b.fire(b._getEventName(c.id),d)}},c.options))},_initFilterTabs:function(b){this[b.id]=new T.ui.Tabs(T.extend({containerId:"FilterTabs"},b.options))},_initIndicator:function(b){this[b.id]=new T.Indicator(T.extend({indicators:this.indexInfo.indicators,indexes:this.indexInfo.indexes},b.options))},_initDateCompare:function(c){var b=this;this[c.id]=new T.DateCompare(T.extend({containerId:"FlashTimeCompare",onchange:function(e,d){b.fire(b._getEventName(c.id),e,d)}},c.options))},_initSimpleFlashIndicator:function(c){var b=this;this[c.id]=new T.ui.CheckGroup(T.extend({containerId:"FlashIndicatorContainer",items:this.indexInfo.flashIndicators,selectedItems:this.indexInfo.flashSelected,limit:this.indexInfo.maxFlashSelectedNumber,autoRender:true,onchange:function(d,e){b.fire(b._getEventName(c.id),d,e)}},c.options))},_initCharacters:function(c){var b=this;this[c.id]=new T.ui.CheckGroup(T.extend({containerId:"CharacterIndicatorContainer",limit:1,tip:true,label:"访问特征:&nbsp;&nbsp;",selectedItems:[this.characterList[0].id],items:this.characterList,onchange:function(d,e){b.fire(b._getEventName(c.id),d,e)}},c.options));this[c.id].render()},_initClients:function(c){var b=this;this[c.id]=new T.ui.CheckGroup(T.extend({containerId:"ClientIndicatorContainer",limit:1,tip:true,selectedItems:[this.clientList[0].id],items:this.clientList,onchange:function(d,e){b.fire(b._getEventName(c.id),d,e)}},c.options));this[c.id].render()},_initFlashIndicator:function(c){var b=this;this[c.id]=new T.ui.FlashIndicator(T.extend({containerId:"FlashIndicator",items:this.indexInfo.flashIndicators,selectedItems:this.indexInfo.flashSelected,defaultItems:this.indexInfo.defaultFlashSelected,limit:this.indexInfo.maxFlashSelectedNumber,autoRender:true,onchange:function(d){b.fire(b._getEventName(c.id),d)}},c.options))},_initFlashIndicatorChannel:function(c){var b=this;this[c.id]=new T.ui.FlashIndicator(T.extend({containerId:"FlashIndicator",items:this.channelList[0].children,selectedItems:this.defaultChannelSelected,defaultItems:this.defaultChannelSelected,limit:5,autoRender:true,onchange:function(d){b.fire(b._getEventName(c.id),d)}},c.options))},_initFlashIndicatorVersion:function(c){var b=this;this[c.id]=new T.ui.FlashIndicator(T.extend({containerId:"FlashIndicator",items:this.versionList,selectedItems:this.defaultVersionSelected,defaultItems:this.defaultVersionSelected,limit:5,autoRender:true,onchange:function(d){b.fire(b._getEventName(c.id),d)}},c.options))},_initFlashIndicatorStyle:function(c){var b=this;this[c.id]=new T.ui.FlashIndicator(T.extend({containerId:"FlashStyle",items:this.pageInfo.styleDefineList,selectedItems:this.pageInfo.defaultSelectedStyleList,defaultItems:this.pageInfo.defaultSelectedStyleList,limit:2,autoRender:true,onchange:function(d){b.fire(b._getEventName(c.id),d)}},c.options))},_initTableIndicator:function(d){var b=this;var c=T.array.filter(this.indexInfo.indicators,function(e){return e.id!=="brand_new_user_count"&&e.id!=="upgrade_user_count"});this.indexInfo.selected=T.array.filter(this.indexInfo.selected,function(e){return e!=="brand_new_user_count"&&e!=="upgrade_user_count"});this[d.id]=new T.ui.TableIndicator(T.extend({containerId:"TableIndicator",items:c,selected:this.indexInfo.selected,limit:this.indexInfo.maxSelectedNumber,defaultSelected:this.indexInfo.defaultSelected,autoRender:true,onchange:function(e){b.fire(b._getEventName(d.id),e)},oncancelChange:function(e){b.fire(b._getEventName(d.id,"oncancelChange"),e)}},d.options))},_initTip:function(b){T.ui.Tip.bindEvent();T.ui.Tip.loadTips()},_initDataAdapter:function(c){var b=this;this.DataAdapter=new T.DataAdapter(T.extend({onflashError:function(e,d){b.fire("onflashError",e,d)}},c.options))},_initCombobox:function(){var b=new T.ui.Combobox(T.extend({trigerId:"ComboboxContainer",autoRender:true,items:[]},param.options))},auth:function(b){return this.userInfo.auths[b]},role:function(b){return this.userInfo.roles[b]},ajaxTimestamps:{},ajax:function(f,b,e){var c=this;b=b||{};b.reportId=this.pageInfo.id;T.extend(b,{method:f.uri});c.fire("on"+f.name,e);var d=new Date().getTime();c.ajaxTimestamps[f.name]=d;T.ajax.jsonPost(this.systemConfig.ajaxUri,b,function(h,g){if(f.drop===true&&d<c.ajaxTimestamps[f.name]){return}if(T.lang.isString(f.adapter)&&T.lang.isFunction(c.DataAdapter[f.adapter])){if(c.fire("on"+f.adapter,h)===false){return}h=c.DataAdapter[f.adapter](h);c.fire("after"+f.adapter,h)}c.fire("on"+f.name+"Success",h,{status:g,postData:b,extData:e})},function(g){c.fire("on"+f.name+"Failed",g,{extData:e})})},download:function(b){T.g("DownloadChannel").src=b},setIndexItem:function(c,b){var e=T.object.clone(c);for(var d in c){delete c[d]}if(T.lang.isObject(b)){T.extend(c,b)}else{c.label=b}c.data=e},sendFlashImage:function(b){b.createImage(document.location.protocol+"//"+window.location.host+this.systemConfig.imageSaveUri,this.systemConfig.imageSaveMethod)},isSpecialWord:function(b){return T.array.contains(["其他","未知","--"],b)},_initLineChart:function(c){var b={containerId:"FlashContainer",color:["#3291fc","#896af7","#2cb865","#f6a90a","#f6716f"],grid:{border:[1,0,1,0],fill:"#fff"},itemStyle:{normal:{dotStyle:{borderWidth:2,radius:2,hasHollow:true}},emphasis:{dotStyle:{borderWidth:2,radius:2,color:"#f6716f",hasHollow:true}}},animate:{enabled:true},canvasLayout:{margin:[70,110,70,110]},customHighlight:function(g){var f=this.lines;var e;var d;for(var h=0;h<f.length;h++){e=f[h];if(!e.isHidden){d=(e.points&&e.points[g])||(e.bars&&e.bars[g]);if(!e.isHoliday[g]){d.attr({fill:e.color,stroke:e.color})}else{d.attr({fill:"#f6716f",stroke:"#f6716f"})}}}},customUnhighlight:function(g){var f=this.lines;var e;var d;for(var h=0;h<f.length;h++){e=f[h];if(!e.isHidden){d=(e.points&&e.points[g])||(e.bars&&e.bars[g]);if(!e.isHoliday[g]){d.attr({stroke:e.color,fill:"#fff"})}else{d.attr({stroke:"#f6716f",fill:"#fff"})}}}}};this[c.id]=hmcharts.create(hmcharts.bar,null,T.extend(b,c.options))}});T.extend(this,a);this._init()};